{"version":3,"sources":["webpack:///./src/PresentationalComponents/Inventory/Inventory.js","webpack:///./src/cveToRuleid.js","webpack:///./src/SmartComponents/Recs/Details.js"],"names":["Inventory","tableProps","rule","afterDisableFn","selectedTags","workloads","SID","intl","useIntl","dispatch","useDispatch","useState","selected","setSelected","limit","offset","sort","filters","entities","useSelector","onSelectRows","id","type","payload","addNotification","data","notification","disableRuleModalOpen","setDisableRuleModalOpen","bulkSelect","setBulkSelect","handleModalToggle","bulkSelectfn","calculateSelectedItems","rows","filter","entity","map","handleRefresh","options","name","refreshedFilters","urlBuilder","useEffect","length","DisableRule","isModalOpen","afterFn","hosts","InventoryTable","hasCheckbox","initialLoading","autoRefresh","hideFilters","all","columns","defaultColumns","lastSeenColumn","key","displayName","systemProfile","transforms","sortable","wrappable","props","isStatic","width","createColumns","variant","TableVariant","customFilters","getEntities","_items","config","showTags","defaultGetEntities","per_page","page","orderBy","orderDirection","hostnameOrId","tags","workloadQueryBuilder","API","RULES_FETCH_URL","encodeURI","rule_id","fetchedSystems","system","system_uuid","hasItems","fields","system_profile","results","Promise","resolve","mergeArraysByDiffKeys","total","meta","count","dedicatedAction","RemediationButton","isDisabled","playbook_count","dataProvider","issues","description","systems","onRemediationCreated","result","remediation","getNotification","error","dismissable","title","formatMessage","messages","size","className","actionsConfig","actions","label","onClick","items","host_ids","allSystems","checked","onSelect","fallback","Loading","onLoad","mergeWithEntities","INVENTORY_ACTION_TYPES","mergeWithDetail","getRegistry","register","systemReducer","Number","perPage","propTypes","PropTypes","cveToRuleid","cves","OverviewDetails","match","permsDisableRec","usePermissions","PERMS","hasAccess","actionsDropdownOpen","setActionsDropdownOpen","undefined","host","setHost","viewSystemsModalOpen","setViewSystemsModalOpen","isRuleUpdated","setIsRuleUpdated","AdvisorStore","ruleFetchStatus","topics","ruleAck","fetchRulefn","useCallback","newFilter","fetchRule","search","AppActions","fetchSystem","tag","encodeURIComponent","params","encodeOptionsToURL","enableRule","BASE_URL","timeout","bulkHostActions","hosts_acked_count","hostAckResponse","item","isCVE","find","mapping","window","location","href","UI_BASE","includes","tagRef","useRef","workloadRef","sidRef","JSON","stringify","current","rule_status","subnav","document","ViewHostAcks","toggleModal","PageHeader","Breadcrumbs","ouiaId","Main","RuleDetails","resolutionRisk","resolution","resolution_set","system_type","SYSTEM_TYPES","resolution_risk","risk","ruleResolutionRisk","isDetailsPage","header","PageHeaderTitle","RuleLabels","date","DateFormat","Date","publish_date","Label","color","category","Flex","FlexItem","align","default","Tooltip","trigger","content","Dropdown","position","toggle","DropdownToggle","onToggle","toggleIndicator","CaretDownIcon","isOpen","dropdownItems","DropdownItem","Card","CardHeader","Title","headingLevel","CardBody","Button","isInline","justification","updated_at","CardFooter","canSelectAll","actionResolver","event","rowIndex","isStickyHeader","MessageState","icon","BellSlashIcon","text","Failed","message","routerParams"],"mappings":"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QACE,wEACF9C,KAAM,oDACNkE,YACE,6EACFoC,KAAM,CAAC,kBAET,CACExD,QACE,oEACF9C,KAAM,oDACNkE,YACE,wFACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,+DACT9C,KAAM,oDACNkE,YACE,0EACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,kEACT9C,KAAM,oDACNkE,YACE,2EACFoC,KAAM,CAAC,kBAET,CACExD,QACE,yEACF9C,KAAM,oDACNkE,YACE,oGACFoC,KAAM,CAAC,kBAET,CACExD,QACE,yEACF9C,KAAM,oDACNkE,YACE,+GACFoC,KAAM,CAAC,kBAET,CACExD,QACE,uEACF9C,KAAM,oDACNkE,YACE,iGACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,4CACT9C,KAAM,wEACNkE,YACE,wEACFoC,KAAM,CAAC,gBAAiB,kBAE1B,CACExD,QAAS,mDACT9C,KAAM,wEACNkE,YACE,sFACFoC,KAAM,CAAC,gBAAiB,kBAE1B,CACExD,QAAS,wCACT9C,KAAM,gEACNkE,YACE,gEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,sDACT9C,KAAM,4CACNkE,YAAa,4CACboC,KAAM,CAAC,kBAET,CACExD,QAAS,8CACT9C,KAAM,mEACNkE,YACE,mEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,mDACT9C,KAAM,gEACNkE,YACE,gEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,mDACT9C,KAAM,gEACNkE,YACE,2FACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,0DACT9C,KAAM,wDACNkE,YAAa,wDACboC,KAAM,CAAC,kBAET,CACExD,QAAS,0DACT9C,KAAM,wDACNkE,YACE,wFACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,gDACT9C,KAAM,iDACNkE,YAAa,iDACboC,KAAM,CAAC,qBAET,CACExD,QACE,uEACF9C,KAAM,sDACNkE,YACE,6EACFoC,KAAM,CAAC,qBAET,CACExD,QACE,uEACF9C,KAAM,sDACNkE,YACE,0EACFoC,KAAM,CAAC,qBAET,CACExD,QACE,yEACF9C,KAAM,sDACNkE,YAAa,yDACboC,KAAM,CAAC,qBAET,CACExD,QACE,yEACF9C,KAAM,sDACNkE,YAAa,sDACboC,KAAM,CAAC,qBAET,CACExD,QACE,yEACF9C,KAAM,sEACNkE,YACE,iGACFoC,KAAM,CAAC,qBAET,CACExD,QAAS,8DACT9C,KAAM,sEACNkE,YACE,sEACFoC,KAAM,CAAC,qBAET,CACExD,QACE,oFACF9C,KAAM,yEACNkE,YACE,yEACFoC,KAAM,CAAC,mBAAoB,qBAE7B,CACExD,QAAS,gDACT9C,KAAM,uEACNkE,YACE,uEACFoC,KAAM,CAAC,qBAET,CACExD,QAAS,6DACT9C,KAAM,6CACNkE,YAAa,6CACboC,KAAM,CAAC,qBAET,CACExD,QAAS,gDACT9C,KAAM,gDACNkE,YAAa,gDACboC,KAAM,CAAC,mBAET,CACExD,QAAS,qDACT9C,KAAM,gDACNkE,YACE,qEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,qDACT9C,KAAM,mDACNkE,YACE,oEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,oDACT9C,KAAM,mDACNkE,YAAa,mDACboC,KAAM,CAAC,mBAET,CACExD,QAAS,8CACT9C,KAAM,yCACNkE,YACE,kEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,6CACT9C,KAAM,yCACNkE,YAAa,yCACboC,KAAM,CAAC,mBAET,CACExD,QAAS,4CACT9C,KAAM,6CACNkE,YAAa,6CACboC,KAAM,CAAC,kBAET,CACExD,QAAS,wCACT9C,KAAM,oCACNkE,YAAa,oCACboC,KAAM,CAAC,kBAET,CACExD,QAAS,+DACT9C,KAAM,uDACNkE,YACE,4EACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,6DACT9C,KAAM,uDACNkE,YACE,iEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,2DACT9C,KAAM,uDACNkE,YAAa,uDACboC,KAAM,CAAC,kBAET,CACExD,QAAS,6DACT9C,KAAM,uDACNkE,YACE,kEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,gEACT9C,KAAM,oEACNkE,YACE,oEACFoC,KAAM,CAAC,gBAAiB,kBAE1B,CACExD,QAAS,4CACT9C,KAAM,6DACNkE,YAAa,6DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,0DACT9C,KAAM,0EACNkE,YACE,0EACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,4CACT9C,KAAM,0DACNkE,YAAa,0DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,sCACT9C,KAAM,qDACNkE,YAAa,+DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,6CACT9C,KAAM,qDACNkE,YAAa,qDACboC,KAAM,CAAC,kBAET,CACExD,QAAS,uCACT9C,KAAM,qDACNkE,YAAa,+CACboC,KAAM,CAAC,kBAET,CACExD,QAAS,8CACT9C,KAAM,4DACNkE,YAAa,4DACboC,KAAM,CAAC,qBAET,CACExD,QAAS,0DACT9C,KAAM,oDACNkE,YAAa,oDACboC,KAAM,CAAC,qBAET,CACExD,QAAS,kEACT9C,KAAM,oDACNkE,YACE,yEACFoC,KAAM,CAAC,qBAET,CACExD,QAAS,kEACT9C,KAAM,oDACNkE,YACE,wFACFoC,KAAM,CAAC,qBAET,CACExD,QACE,0EACF9C,KAAM,oDACNkE,YACE,6GACFoC,KAAM,CAAC,qBAET,CACExD,QAAS,8DACT9C,KAAM,+DACNkE,YAAa,+DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,gDACT9C,KAAM,+CACNkE,YACE,iEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,+CACT9C,KAAM,+CACNkE,YAAa,+CACboC,KAAM,CAAC,kBAET,CACExD,QAAS,kDACT9C,KAAM,+CACNkE,YAAa,+CACboC,KAAM,CAAC,kBAET,CACExD,QAAS,kEACT9C,KAAM,yFACNkE,YACE,6GACFoC,KAAM,CACJ,iBACA,iBACA,iBACA,mBAGJ,CACExD,QAAS,kEACT9C,KAAM,yFACNkE,YACE,yFACFoC,KAAM,CACJ,iBACA,iBACA,iBACA,mBAGJ,CACExD,QAAS,mEACT9C,KAAM,yFACNkE,YACE,4GACFoC,KAAM,CACJ,iBACA,iBACA,iBACA,mBAGJ,CACExD,QAAS,8DACT9C,KAAM,mDACNkE,YACE,uEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,+DACT9C,KAAM,mDACNkE,YAAa,mDACboC,KAAM,CAAC,mBAET,CACExD,QACE,wEACF9C,KAAM,mDACNkE,YACE,2EACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,yCACT9C,KAAM,oFACNkE,YACE,oFACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,sDACT9C,KAAM,kDACNkE,YACE,oEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,gEACT9C,KAAM,yCACNkE,YAAa,6DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,gEACT9C,KAAM,yCACNkE,YAAa,yCACboC,KAAM,CAAC,kBAET,CACExD,QAAS,iEACT9C,KAAM,yCACNkE,YAAa,4DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,2DACT9C,KAAM,yCACNkE,YACE,6EACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,0DACT9C,KAAM,yCACNkE,YAAa,yCACboC,KAAM,CAAC,kBAET,CACExD,QAAS,6DACT9C,KAAM,yCACNkE,YACE,iEACFoC,KAAM,CAAC,kBAET,CACExD,QAAS,+DACT9C,KAAM,oEACNkE,YACE,oEACFoC,KAAM,CAAC,gBAAiB,kBAE1B,CACExD,QAAS,oDACT9C,KAAM,8DACNkE,YAAa,8DACboC,KAAM,CAAC,gBAAiB,kBAE1B,CACExD,QAAS,uDACT9C,KAAM,4CACNkE,YACE,gEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,uDACT9C,KAAM,4CACNkE,YAAa,4CACboC,KAAM,CAAC,mBAET,CACExD,QAAS,sDACT9C,KAAM,4CACNkE,YACE,kEACFoC,KAAM,CAAC,mBAET,CACExD,QAAS,8CACT9C,KAAM,2CACNkE,YAAa,2CACboC,KAAM,CAAC,kBAET,CACExD,QAAS,0DACT9C,KAAM,2CACNkE,YAAa,+DACboC,KAAM,CAAC,kBAET,CACExD,QAAS,8CACT9C,KAAM,wFACNkE,YACE,wFACFoC,KAAM,CAAC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","file":"js/Details.981a93eec84a6549249a.js","sourcesContent":["import './_Inventory.scss';\n\nimport React, { useEffect, useState } from 'react';\nimport { TableVariant, sortable, wrappable } from '@patternfly/react-table';\nimport { urlBuilder, workloadQueryBuilder } from '../Common/Tables';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport API from '../../Utilities/Api';\nimport AnsibeTowerIcon from '@patternfly/react-icons/dist/js/icons/ansibeTower-icon';\nimport DisableRule from '../../PresentationalComponents/Modals/DisableRule';\nimport { InventoryTable } from '@redhat-cloud-services/frontend-components/Inventory';\nimport Loading from '../Loading/Loading';\nimport PropTypes from 'prop-types';\nimport { RULES_FETCH_URL } from '../../AppConstants';\nimport RemediationButton from '@redhat-cloud-services/frontend-components-remediations/RemediationButton';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport { mergeArraysByDiffKeys } from '../Common/Tables';\nimport messages from '../../Messages';\nimport { addNotification as notification } from '@redhat-cloud-services/frontend-components-notifications/';\nimport { systemReducer } from '../../AppReducer';\nimport { useIntl } from 'react-intl';\n\nconst Inventory = ({\n  tableProps,\n  rule,\n  afterDisableFn,\n  selectedTags,\n  workloads,\n  SID,\n}) => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n  const [selected, setSelected] = useState([]);\n  // eslint-disable-next-line no-unused-vars\n  const [filters, setFilters] = useState({\n    limit: 20,\n    offset: 0,\n    sort: '-last_seen',\n  });\n  const entities = useSelector(({ entities }) => entities || {});\n  const onSelectRows = (id, selected) =>\n    dispatch({ type: 'SELECT_ENTITY', payload: { id, selected } });\n  const addNotification = (data) => dispatch(notification(data));\n  const [disableRuleModalOpen, setDisableRuleModalOpen] = useState(false);\n  const [bulkSelect, setBulkSelect] = useState();\n\n  const remediationDataProvider = () => ({\n    issues: [\n      {\n        id: `advisor:${rule.rule_id}`,\n        description: rule.description,\n      },\n    ],\n    systems: selected,\n  });\n\n  const onRemediationCreated = (result) => {\n    onSelectRows(-1, false);\n    try {\n      result.remediation && addNotification(result.getNotification());\n    } catch (error) {\n      addNotification({\n        variant: 'danger',\n        dismissable: true,\n        title: intl.formatMessage(messages.error),\n        description: `${error}`,\n      });\n    }\n  };\n\n  const handleModalToggle = (disableRuleModalOpen) => {\n    setDisableRuleModalOpen(disableRuleModalOpen);\n  };\n\n  const bulkSelectfn = () => {\n    setBulkSelect(true);\n    onSelectRows(0, true);\n  };\n\n  const calculateSelectedItems = () =>\n    bulkSelect\n      ? setBulkSelect(false)\n      : setSelected(\n          entities?.rows\n            ?.filter((entity) => entity.selected === true)\n            .map((entity) => entity.id)\n        );\n\n  const createColumns = (defaultColumns) => {\n    let lastSeenColumn = defaultColumns.filter(({ key }) => key === 'updated');\n    let displayName = defaultColumns.filter(\n      ({ key }) => key === 'display_name'\n    );\n    let systemProfile = defaultColumns.filter(\n      ({ key }) => key === 'system_profile'\n    );\n\n    displayName = {\n      ...displayName[0],\n      transforms: [sortable, wrappable],\n      props: { isStatic: true },\n    };\n\n    lastSeenColumn = {\n      ...lastSeenColumn[0],\n      transforms: [sortable, wrappable],\n      props: { width: 20 },\n    };\n\n    systemProfile = {\n      ...systemProfile[0],\n      transforms: [wrappable],\n    };\n\n    return [displayName, systemProfile, lastSeenColumn];\n  };\n\n  const handleRefresh = (options) => {\n    const { limit, offset, sort, name } = options;\n    const refreshedFilters = {\n      limit,\n      offset,\n      sort,\n      ...(name && {\n        name,\n      }),\n    };\n    urlBuilder(refreshedFilters, selectedTags);\n  };\n\n  useEffect(() => {\n    entities?.rows?.length && calculateSelectedItems(entities.rows);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [entities?.rows]);\n\n  return (\n    <React.Fragment>\n      {disableRuleModalOpen && (\n        <DisableRule\n          handleModalToggle={handleModalToggle}\n          isModalOpen={disableRuleModalOpen}\n          rule={rule}\n          afterFn={afterDisableFn}\n          hosts={selected}\n        />\n      )}\n      <InventoryTable\n        hasCheckbox\n        initialLoading\n        autoRefresh\n        hideFilters={{ all: true, name: false }}\n        columns={(defaultColumns) => createColumns(defaultColumns)}\n        tableProps={{\n          variant: TableVariant.compact,\n          ...tableProps,\n        }}\n        customFilters={{\n          selectedTags,\n          workloads,\n          SID,\n        }}\n        getEntities={async (_items, config, showTags, defaultGetEntities) => {\n          const {\n            per_page,\n            page,\n            orderBy,\n            orderDirection,\n            selectedTags,\n            workloads,\n            SID,\n          } = config;\n          const sort = `${orderDirection === 'ASC' ? '' : '-'}${\n            orderBy === 'updated' ? 'last_seen' : orderBy\n          }`;\n          let options = {\n            ...filters,\n            limit: per_page,\n            offset: page * per_page - per_page,\n            sort,\n            ...(config.filters.hostnameOrId && {\n              name: config?.filters?.hostnameOrId,\n            }),\n            ...(selectedTags.length && { tags: selectedTags }),\n          };\n\n          workloads &&\n            (options = { ...options, ...workloadQueryBuilder(workloads, SID) });\n\n          handleRefresh(options);\n\n          const fetchedSystems = (\n            await API.get(\n              `${RULES_FETCH_URL}${encodeURI(rule.rule_id)}/systems_detail/`,\n              {},\n              options\n            )\n          )?.data;\n\n          const results = await defaultGetEntities(\n            fetchedSystems.data.map((system) => system.system_uuid),\n            {\n              page,\n              per_page,\n              hasItems: true,\n              fields: { system_profile: ['operating_system'] },\n            },\n            showTags\n          );\n\n          return Promise.resolve({\n            results: mergeArraysByDiffKeys(\n              fetchedSystems.data,\n              results.results\n            ),\n            total: fetchedSystems.meta.count,\n          });\n        }}\n        dedicatedAction={\n          <RemediationButton\n            key=\"remediation-button\"\n            isDisabled={selected.length === 0 || rule.playbook_count === 0}\n            dataProvider={remediationDataProvider}\n            onRemediationCreated={(result) => onRemediationCreated(result)}\n          >\n            <AnsibeTowerIcon size=\"sm\" className=\"ins-c-background__default\" />\n            &nbsp;{intl.formatMessage(messages.remediate)}\n          </RemediationButton>\n        }\n        actionsConfig={{\n          actions: [\n            '',\n            {\n              label: intl.formatMessage(messages.disableRuleForSystems),\n              props: { isDisabled: selected.length === 0 },\n              onClick: () => handleModalToggle(true),\n            },\n          ],\n        }}\n        bulkSelect={{\n          count: selected.length,\n          items: [\n            {\n              title: intl.formatMessage(messages.selectNone),\n              onClick: () => {\n                onSelectRows(-1, false);\n              },\n            },\n            {\n              ...(entities?.rows?.length > filters.limit\n                ? {\n                    title: intl.formatMessage(messages.selectPage, {\n                      items: filters.limit,\n                    }),\n                    onClick: () => {\n                      onSelectRows(0, true);\n                    },\n                  }\n                : {}),\n            },\n            {\n              ...(entities?.rows?.length > 0\n                ? {\n                    title: intl.formatMessage(messages.selectAll, {\n                      items: entities?.total || 0,\n                    }),\n                    onClick: async () => {\n                      const allSystems = (\n                        await API.get(\n                          `${RULES_FETCH_URL}${encodeURI(\n                            rule.rule_id\n                          )}/systems/`,\n                          {},\n                          {}\n                        )\n                      )?.data?.host_ids;\n                      setSelected(allSystems);\n                      bulkSelectfn();\n                    },\n                  }\n                : {}),\n            },\n          ],\n          checked:\n            (selected.length === entities?.rows?.length ||\n              selected.length === entities?.total) &&\n            entities?.total > 0\n              ? 1\n              : selected.length === filters.limit\n              ? null\n              : 0,\n          onSelect: () => {\n            selected.length > 0 ? onSelectRows(-1, false) : bulkSelectfn();\n            calculateSelectedItems();\n          },\n        }}\n        fallback={Loading}\n        onLoad={({\n          mergeWithEntities,\n          INVENTORY_ACTION_TYPES,\n          mergeWithDetail,\n        }) => {\n          getRegistry().register({\n            ...mergeWithEntities(systemReducer([], INVENTORY_ACTION_TYPES), {\n              page: Number(filters.offset / filters.limit + 1 || 1),\n              perPage: Number(filters.limit || 20),\n            }),\n            ...mergeWithDetail(),\n          });\n        }}\n      />\n    </React.Fragment>\n  );\n};\n\nInventory.propTypes = {\n  tableProps: PropTypes.any,\n  rule: PropTypes.object,\n  afterDisableFn: PropTypes.func,\n  selectedTags: PropTypes.any,\n  workloads: PropTypes.any,\n  SID: PropTypes.any,\n};\n\nexport default Inventory;\n","export const cveToRuleid = [\n  {\n    rule_id: 'CVE_2015_3456|VENOM_CVE_2015_3456',\n    name: 'CVE-2015-3456: \"VENOM\" QEMU privilege escalation',\n    description: 'CVE-2015-3456: \"VENOM\" QEMU privilege escalation',\n    cves: ['CVE-2015-3456'],\n  },\n  {\n    rule_id: 'CVE_2015_5600|OPENSSH_CVE_2015_5600',\n    name: 'CVE-2015-5600: OpenSSH vulnerable to password guessing attack',\n    description:\n      'CVE-2015-5600: OpenSSH vulnerable to password guessing attack',\n    cves: ['CVE-2015-5600'],\n  },\n  {\n    rule_id: 'CVE_2015_7181_2_3_nss_nspr|NSS_NSPR_CVE_2015_7181_2_3',\n    name: 'CVE-2015-7181, CVE-2015-7182, CVE-2015-7183: NSS/NSPR privilege escalation',\n    description:\n      'CVE-2015-7181, CVE-2015-7182, CVE-2015-7183: NSS/NSPR privilege escalation',\n    cves: ['CVE-2015-7181', 'CVE-2015-7182', 'CVE-2015-7183'],\n  },\n  {\n    rule_id:\n      'CVE_2015_7501_commons_collections|COMMONS_COLLECTIONS_CVE_2015_7501_IN_USE',\n    name: 'CVE-2015-7501: Java application server code execution',\n    description: 'CVE-2015-7501: Java application server code execution',\n    cves: ['CVE-2015-7501'],\n  },\n  {\n    rule_id: 'CVE_2015_7547_glibc|GLIBC_CVE_2015_7547',\n    name: 'CVE-2015-7547: libresolv code execution',\n    description: 'CVE-2015-7547: libresolv code execution',\n    cves: ['CVE-2015-7547'],\n  },\n  {\n    rule_id: 'CVE_2016_0728_kernel|KERNEL_CVE-2016-0728',\n    name: 'CVE-2016-0728: kernel privilege escalation in key management subsystem',\n    description:\n      'CVE-2016-0728: kernel privilege escalation in key management subsystem',\n    cves: ['CVE-2016-0728'],\n  },\n  {\n    rule_id: 'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_DROWN',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id:\n      'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_DROWN_INT_LISTENING',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"DROWN\" OpenSSL session decryption with listening processes',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id:\n      'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_DROWN_LISTENING',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"DROWN\" OpenSSL session decryption with externally available processes',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id: 'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_DROWN_USED',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"DROWN\" OpenSSL session decryption with running services',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id: 'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_SPECIAL_DROWN',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"Special DROWN\" OpenSSL very efficient session decryption',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id:\n      'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_SPECIAL_DROWN_LISTEN',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"Special DROWN\" OpenSSL very efficient session decryption with listening processes',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id:\n      'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_SPECIAL_DROWN_URGENT',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"Special DROWN\" OpenSSL very efficient session decryption with externally available processes',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id:\n      'CVE_2016_0800_openssl_drown|OPENSSL_CVE_2016_0800_SPECIAL_DROWN_USED',\n    name: 'CVE-2016-0800: \"DROWN\" OpenSSL session decryption',\n    description:\n      'CVE-2016-0800: \"Special DROWN\" OpenSSL very efficient session decryption with running services',\n    cves: ['CVE-2016-0800'],\n  },\n  {\n    rule_id: 'CVE_2016_2315_24_git|GIT_CVE_2016_2315_24',\n    name: 'CVE-2016-2315, CVE-2016-2324: Git code execution via crafted packfile',\n    description:\n      'CVE-2016-2315, CVE-2016-2324: Git code execution via crafted packfile',\n    cves: ['CVE-2016-2315', 'CVE-2016-2324'],\n  },\n  {\n    rule_id: 'CVE_2016_2315_24_git|GIT_DAEMON_CVE_2016_2315_24',\n    name: 'CVE-2016-2315, CVE-2016-2324: Git code execution via crafted packfile',\n    description:\n      'CVE-2016-2315, CVE-2016-2324: Git daemon remote code execution via crafted packfile',\n    cves: ['CVE-2016-2315', 'CVE-2016-2324'],\n  },\n  {\n    rule_id: 'CVE_2016_2776_bind|BIND_CVE_2016_2776',\n    name: 'CVE-2016-2776: BIND denial of service via crafted DNS request',\n    description:\n      'CVE-2016-2776: BIND denial of service via crafted DNS request',\n    cves: ['CVE-2016-2776'],\n  },\n  {\n    rule_id: 'CVE_2016_3714_imagemagick|IMAGEMAGICK_CVE_2016_3714',\n    name: 'CVE-2016-3714: ImageMagick code execution',\n    description: 'CVE-2016-3714: ImageMagick code execution',\n    cves: ['CVE-2016-3714'],\n  },\n  {\n    rule_id: 'CVE_2016_5195_kernel|KERNEL_CVE_2016_5195_2',\n    name: 'CVE-2016-5195: kernel privilege escalation via permission bypass',\n    description:\n      'CVE-2016-5195: kernel privilege escalation via permission bypass',\n    cves: ['CVE-2016-5195'],\n  },\n  {\n    rule_id: 'CVE_2016_5696_kernel|KERNEL_CVE_2016_5696_URGENT',\n    name: 'CVE-2016-5696: kernel man-in-the-middle via payload injection',\n    description:\n      'CVE-2016-5696: kernel man-in-the-middle via payload injection',\n    cves: ['CVE-2016-5696'],\n  },\n  {\n    rule_id: 'CVE_2016_5696_kernel|KERNEL_CVE_2016_5696_WARN_2',\n    name: 'CVE-2016-5696: kernel man-in-the-middle via payload injection',\n    description:\n      'CVE-2016-5696: kernel man-in-the-middle via payload injection with incomplete mitigation',\n    cves: ['CVE-2016-5696'],\n  },\n  {\n    rule_id: 'CVE_2016_9962_docker|CVE_2015_9962_DOCKER_LESS_SEVERE_2',\n    name: 'CVE-2016-9962: Docker privilege escalation via ptrace',\n    description: 'CVE-2016-9962: Docker privilege escalation via ptrace',\n    cves: ['CVE-2016-9962'],\n  },\n  {\n    rule_id: 'CVE_2016_9962_docker|CVE_2015_9962_DOCKER_MORE_SEVERE_2',\n    name: 'CVE-2016-9962: Docker privilege escalation via ptrace',\n    description:\n      'CVE-2016-9962: Docker efficient privilege escalation via ptrace with outdated package',\n    cves: ['CVE-2016-9962'],\n  },\n  {\n    rule_id: 'CVE_2017_1000250_bluez|BLUEZ_CVE_2017_1000250',\n    name: 'CVE-2017-1000250: bluez information disclosure',\n    description: 'CVE-2017-1000250: bluez information disclosure',\n    cves: ['CVE-2017-1000250'],\n  },\n  {\n    rule_id:\n      'CVE_2017_1000251_kernel_blueborne|KERNEL_CVE_2017_1000251_LOADED_DOS',\n    name: 'CVE-2017-1000251: \"Blueborne\" kernel code execution',\n    description:\n      'CVE-2017-1000251: \"Blueborne\" kernel denial of service with loaded modules',\n    cves: ['CVE-2017-1000251'],\n  },\n  {\n    rule_id:\n      'CVE_2017_1000251_kernel_blueborne|KERNEL_CVE_2017_1000251_LOADED_RCE',\n    name: 'CVE-2017-1000251: \"Blueborne\" kernel code execution',\n    description:\n      'CVE-2017-1000251: \"Blueborne\" kernel code execution with loaded modules',\n    cves: ['CVE-2017-1000251'],\n  },\n  {\n    rule_id:\n      'CVE_2017_1000251_kernel_blueborne|KERNEL_CVE_2017_1000251_POSSIBLE_DOS',\n    name: 'CVE-2017-1000251: \"Blueborne\" kernel code execution',\n    description: 'CVE-2017-1000251: \"Blueborne\" kernel denial of service',\n    cves: ['CVE-2017-1000251'],\n  },\n  {\n    rule_id:\n      'CVE_2017_1000251_kernel_blueborne|KERNEL_CVE_2017_1000251_POSSIBLE_RCE',\n    name: 'CVE-2017-1000251: \"Blueborne\" kernel code execution',\n    description: 'CVE-2017-1000251: \"Blueborne\" kernel code execution',\n    cves: ['CVE-2017-1000251'],\n  },\n  {\n    rule_id:\n      'CVE_2017_1000253_loadelf|KERNEL_CVE_2017_1000253_MITIGATION_INCOMPLETE',\n    name: 'CVE-2017-1000253: kernel privilege escalation via SUID PIE binaries',\n    description:\n      'CVE-2017-1000253: kernel privilege escalation via SUID PIE binaries with incomplete mitigation',\n    cves: ['CVE-2017-1000253'],\n  },\n  {\n    rule_id: 'CVE_2017_1000253_loadelf|KERNEL_CVE_2017_1000253_VULNERABLE',\n    name: 'CVE-2017-1000253: kernel privilege escalation via SUID PIE binaries',\n    description:\n      'CVE-2017-1000253: kernel privilege escalation via SUID PIE binaries',\n    cves: ['CVE-2017-1000253'],\n  },\n  {\n    rule_id:\n      'CVE_2017_1000366_glibc|CVE_2017_1000364_KERNEL_CVE_2017_1000366_GLIBC_EXPLOITABLE',\n    name: 'CVE-2017-1000364, CVE-2017-1000366: kernel, glibc privilege escalation',\n    description:\n      'CVE-2017-1000364, CVE-2017-1000366: kernel, glibc privilege escalation',\n    cves: ['CVE-2017-1000364', 'CVE-2017-1000366'],\n  },\n  {\n    rule_id: 'CVE_2017_1000368_sudo|CVE_2017_1000368_SUDO_2',\n    name: 'CVE-2017-1000368: sudo privilege escalation due to incomplete bugfix',\n    description:\n      'CVE-2017-1000368: sudo privilege escalation due to incomplete bugfix',\n    cves: ['CVE-2017-1000368'],\n  },\n  {\n    rule_id: 'CVE_2017_1000405_kernel|KERNEL_CVE_2017_1000405_VULNERABLE',\n    name: 'CVE-2017-1000405: kernel memory corruption',\n    description: 'CVE-2017-1000405: kernel memory corruption',\n    cves: ['CVE-2017-1000405'],\n  },\n  {\n    rule_id: 'CVE_2017_12616_tomcat|TOMCAT_CVE_2017_12616_2',\n    name: 'CVE-2017-12616: Tomcat information disclosure',\n    description: 'CVE-2017-12616: Tomcat information disclosure',\n    cves: ['CVE-2017-12616'],\n  },\n  {\n    rule_id: 'CVE_2017_12616_tomcat|TOMCAT_CVE_2017_12616_USED_2',\n    name: 'CVE-2017-12616: Tomcat information disclosure',\n    description:\n      'CVE-2017-12616: Tomcat information disclosure with running process',\n    cves: ['CVE-2017-12616'],\n  },\n  {\n    rule_id: 'CVE_2017_13077_wpa_supplicant|CVE_2017_13077_ERROR',\n    name: 'CVE-2017-13077: wpa_supplicant man-in-the-middle',\n    description:\n      'CVE-2017-13077: wpa_supplicant man-in-the-middle with active wifi',\n    cves: ['CVE-2017-13077'],\n  },\n  {\n    rule_id: 'CVE_2017_13077_wpa_supplicant|CVE_2017_13077_WARN',\n    name: 'CVE-2017-13077: wpa_supplicant man-in-the-middle',\n    description: 'CVE-2017-13077: wpa_supplicant man-in-the-middle',\n    cves: ['CVE-2017-13077'],\n  },\n  {\n    rule_id: 'CVE_2017_14491_dnsmasq|CVE_2017_14491_ERROR',\n    name: 'CVE-2017-14491: dnsmasq code execution',\n    description:\n      'CVE-2017-14491: dnsmasq code execution with listening processes',\n    cves: ['CVE-2017-14491'],\n  },\n  {\n    rule_id: 'CVE_2017_14491_dnsmasq|CVE_2017_14491_WARN',\n    name: 'CVE-2017-14491: dnsmasq code execution',\n    description: 'CVE-2017-14491: dnsmasq code execution',\n    cves: ['CVE-2017-14491'],\n  },\n  {\n    rule_id: 'CVE_2017_2636_kernel|KERNEL_CVE_2017_2636',\n    name: 'CVE-2017-2636: kernel privilege escalation',\n    description: 'CVE-2017-2636: kernel privilege escalation',\n    cves: ['CVE-2017-2636'],\n  },\n  {\n    rule_id: 'CVE_2017_5461_nss|CVE_2017_5461_NSS_2',\n    name: 'CVE-2017-5461: NSS code execution',\n    description: 'CVE-2017-5461: NSS code execution',\n    cves: ['CVE-2017-5461'],\n  },\n  {\n    rule_id: 'CVE_2017_5715_cpu_virt|VIRT_CVE_2017_5715_CPU_3_DRACUTKERNEL',\n    name: 'CVE-2017-5715: \"Spectre\" Virtualization side-channel',\n    description:\n      'CVE-2017-5715: \"Spectre\" Virtualization side-channel in dracut and kernel',\n    cves: ['CVE-2017-5715'],\n  },\n  {\n    rule_id: 'CVE_2017_5715_cpu_virt|VIRT_CVE_2017_5715_CPU_3_ONLYDRACUT',\n    name: 'CVE-2017-5715: \"Spectre\" Virtualization side-channel',\n    description:\n      'CVE-2017-5715: \"Spectre\" Virtualization side-channel in dracut',\n    cves: ['CVE-2017-5715'],\n  },\n  {\n    rule_id: 'CVE_2017_5715_cpu_virt|VIRT_CVE_2017_5715_CPU_3_ONLYVIRT',\n    name: 'CVE-2017-5715: \"Spectre\" Virtualization side-channel',\n    description: 'CVE-2017-5715: \"Spectre\" Virtualization side-channel',\n    cves: ['CVE-2017-5715'],\n  },\n  {\n    rule_id: 'CVE_2017_5715_cpu_virt|VIRT_CVE_2017_5715_CPU_3_VIRTKERNEL',\n    name: 'CVE-2017-5715: \"Spectre\" Virtualization side-channel',\n    description:\n      'CVE-2017-5715: \"Spectre\" Virtualization and kernel side-channel',\n    cves: ['CVE-2017-5715'],\n  },\n  {\n    rule_id: 'CVE_2017_5753_4_cpu_kernel|KERNEL_CVE_2017_5753_4_CPU_ERROR_3',\n    name: 'CVE-2017-5753, CVE-2017-5754: \"Spectre/Meltdown\" CPU side-channel',\n    description:\n      'CVE-2017-5753, CVE-2017-5754: \"Spectre/Meltdown\" CPU side-channel',\n    cves: ['CVE-2017-5753', 'CVE-2017-5754'],\n  },\n  {\n    rule_id: 'CVE_2017_6074_kernel|KERNEL_CVE_2017_6074',\n    name: 'CVE-2017-6074: kernel privilege escalation via DCCP module',\n    description: 'CVE-2017-6074: kernel privilege escalation via DCCP module',\n    cves: ['CVE-2017-6074'],\n  },\n  {\n    rule_id: 'CVE_2017_7184_kernel|KERNEL_CVE_2017_7184_EXPLOITABLE_2',\n    name: 'CVE-2017-7184: kernel privilege escalation via CAP_NET_ADMIN capability',\n    description:\n      'CVE-2017-7184: kernel privilege escalation via CAP_NET_ADMIN capability',\n    cves: ['CVE-2017-7184'],\n  },\n  {\n    rule_id: 'CVE_2017_7494_samba|SAMBA_CVE_2017_7494_2',\n    name: 'CVE-2017-7494: Samba code execution via writeable share',\n    description: 'CVE-2017-7494: Samba code execution via writeable share',\n    cves: ['CVE-2017-7494'],\n  },\n  {\n    rule_id: 'CVE_2017_8779_rpc|CVE_2017_8779_BUG',\n    name: 'CVE-2017-8779: \"rpcbomb\" rpcbind denial of service',\n    description: 'CVE-2017-8779: \"rpcbomb\" rpcbind crash with certain versions',\n    cves: ['CVE-2017-8779'],\n  },\n  {\n    rule_id: 'CVE_2017_8779_rpc|CVE_2017_8779_VULNERABLE',\n    name: 'CVE-2017-8779: \"rpcbomb\" rpcbind denial of service',\n    description: 'CVE-2017-8779: \"rpcbomb\" rpcbind denial of service',\n    cves: ['CVE-2017-8779'],\n  },\n  {\n    rule_id: 'CVE_2017_8779_rpc|CVE_2017_8779_WARN',\n    name: 'CVE-2017-8779: \"rpcbomb\" rpcbind denial of service',\n    description: 'CVE-2017-8779: \"rpcbomb\" rpcbind memory leak',\n    cves: ['CVE-2017-8779'],\n  },\n  {\n    rule_id: 'CVE_2018_1000115_memcached|CVE_2018_1000115',\n    name: 'CVE-2018-1000115: memcached spoofed traffic amplification',\n    description: 'CVE-2018-1000115: memcached spoofed traffic amplification',\n    cves: ['CVE-2018-1000115'],\n  },\n  {\n    rule_id: 'CVE_2018_1002105_kubernetes|CVE_2018_1002105_KUBERNETES',\n    name: 'CVE-2018-1002105: kubernetes privilege escalation',\n    description: 'CVE-2018-1002105: kubernetes privilege escalation',\n    cves: ['CVE-2018-1002105'],\n  },\n  {\n    rule_id: 'CVE_2018_1002105_kubernetes|CVE_2018_1002105_KUBERNETES_RUNNING',\n    name: 'CVE-2018-1002105: kubernetes privilege escalation',\n    description:\n      'CVE-2018-1002105: kubernetes privilege escalation with running service',\n    cves: ['CVE-2018-1002105'],\n  },\n  {\n    rule_id: 'CVE_2018_1002105_kubernetes|CVE_2018_1002105_KUBERNETES_WONTFIX',\n    name: 'CVE-2018-1002105: kubernetes privilege escalation',\n    description:\n      'CVE-2018-1002105: kubernetes privilege escalation (no fix available for this version)',\n    cves: ['CVE-2018-1002105'],\n  },\n  {\n    rule_id:\n      'CVE_2018_1002105_kubernetes|CVE_2018_1002105_KUBERNETES_WONTFIX_RUNNING',\n    name: 'CVE-2018-1002105: kubernetes privilege escalation',\n    description:\n      'CVE-2018-1002105: kubernetes privilege escalation with running service (no fix available for this version)',\n    cves: ['CVE-2018-1002105'],\n  },\n  {\n    rule_id: 'CVE_2018_1102_ose_sti_builder|OSE_STI_BUILDER_CVE_2018_1102',\n    name: 'CVE-2018-1102: OpenShift remote code execution via S2I build',\n    description: 'CVE-2018-1102: OpenShift remote code execution via S2I build',\n    cves: ['CVE-2018-1102'],\n  },\n  {\n    rule_id: 'CVE_2018_1111_dhcp|ERROR_CVE_2018_1111_DHCP_2',\n    name: 'CVE-2018-1111: NetworkManager code execution',\n    description:\n      'CVE-2018-1111: NetworkManager code execution with DHCP enabled',\n    cves: ['CVE-2018-1111'],\n  },\n  {\n    rule_id: 'CVE_2018_1111_dhcp|WARN_CVE_2018_1111_DHCP_2',\n    name: 'CVE-2018-1111: NetworkManager code execution',\n    description: 'CVE-2018-1111: NetworkManager code execution',\n    cves: ['CVE-2018-1111'],\n  },\n  {\n    rule_id: 'CVE_2018_1112_glusterfs|GLUSTERFS_CVE_2018_1112',\n    name: 'CVE-2018-1112: glusterfs unrestricted access',\n    description: 'CVE-2018-1112: glusterfs unrestricted access',\n    cves: ['CVE-2018-1112'],\n  },\n  {\n    rule_id: 'CVE_2018_12130_cpu_kernel|CVE_2018_12130_CPU_KERNEL_BAD_CMDLINE',\n    name: 'CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091: \"MDS\" CPU side-channel',\n    description:\n      'CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091: \"MDS\" CPU side-channel mitigation disabled',\n    cves: [\n      'CVE-2018-12126',\n      'CVE-2018-12127',\n      'CVE-2018-12130',\n      'CVE-2019-11091',\n    ],\n  },\n  {\n    rule_id: 'CVE_2018_12130_cpu_kernel|CVE_2018_12130_CPU_KERNEL_NEED_UPDATE',\n    name: 'CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091: \"MDS\" CPU side-channel',\n    description:\n      'CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091: \"MDS\" CPU side-channel',\n    cves: [\n      'CVE-2018-12126',\n      'CVE-2018-12127',\n      'CVE-2018-12130',\n      'CVE-2019-11091',\n    ],\n  },\n  {\n    rule_id: 'CVE_2018_12130_cpu_kernel|CVE_2018_12130_CPU_KERNEL_VULNERABLE_2',\n    name: 'CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091: \"MDS\" CPU side-channel',\n    description:\n      'CVE-2018-12126, CVE-2018-12127, CVE-2018-12130, CVE-2019-11091: \"MDS\" CPU side-channel reported by kernel',\n    cves: [\n      'CVE-2018-12126',\n      'CVE-2018-12127',\n      'CVE-2018-12130',\n      'CVE-2019-11091',\n    ],\n  },\n  {\n    rule_id: 'CVE_2018_12207_cpu_kernel|CVE_2018_12207_CPU_KERNEL_CMDLINE',\n    name: 'CVE-2018-12207: CPU systemwide denial of service',\n    description:\n      'CVE-2018-12207: CPU systemwide denial of service mitigation disabled',\n    cves: ['CVE-2018-12207'],\n  },\n  {\n    rule_id: 'CVE_2018_12207_cpu_kernel|CVE_2018_12207_CPU_KERNEL_FOR_SURE',\n    name: 'CVE-2018-12207: CPU systemwide denial of service',\n    description: 'CVE-2018-12207: CPU systemwide denial of service',\n    cves: ['CVE-2018-12207'],\n  },\n  {\n    rule_id:\n      'CVE_2018_12207_cpu_kernel|CVE_2018_12207_CPU_KERNEL_FOR_SURE_CRITICAL',\n    name: 'CVE-2018-12207: CPU systemwide denial of service',\n    description:\n      'CVE-2018-12207: CPU systemwide denial of service with running hypervisor',\n    cves: ['CVE-2018-12207'],\n  },\n  {\n    rule_id: 'CVE_2018_14634_kernel|CVE_2018_14634_2',\n    name: 'CVE-2018-14634: kernel privilege escalation via SUID-root binary integer overflow',\n    description:\n      'CVE-2018-14634: kernel privilege escalation via SUID-root binary integer overflow',\n    cves: ['CVE-2018-14634'],\n  },\n  {\n    rule_id: 'CVE_2018_19788_polkit|CVE_2018_19788_POLKIT_UID_BAD',\n    name: 'CVE-2018-19788: PolicyKit authentication bypass',\n    description:\n      'CVE-2018-19788: PolicyKit authentication bypass with affected UID',\n    cves: ['CVE-2018-19788'],\n  },\n  {\n    rule_id: 'CVE_2018_3620_cpu_kernel|CVE_2018_3620_CPU_KERNEL_BAD_CMDLINE',\n    name: 'CVE-2018-3620: \"L1TF\" CPU side-channel',\n    description: 'CVE-2018-3620: \"L1TF\" CPU side-channel mitigation disabled',\n    cves: ['CVE-2018-3620'],\n  },\n  {\n    rule_id: 'CVE_2018_3620_cpu_kernel|CVE_2018_3620_CPU_KERNEL_NEED_UPDATE',\n    name: 'CVE-2018-3620: \"L1TF\" CPU side-channel',\n    description: 'CVE-2018-3620: \"L1TF\" CPU side-channel',\n    cves: ['CVE-2018-3620'],\n  },\n  {\n    rule_id: 'CVE_2018_3620_cpu_kernel|CVE_2018_3620_CPU_KERNEL_VULNERABLE_4',\n    name: 'CVE-2018-3620: \"L1TF\" CPU side-channel',\n    description: 'CVE-2018-3620: \"L1TF\" CPU side-channel reported by kernel',\n    cves: ['CVE-2018-3620'],\n  },\n  {\n    rule_id: 'CVE_2018_3639_cpu_kernel|CVE_2018_3639_CPU_BAD_CMDLINE_2',\n    name: 'CVE-2018-3639: \"SSBD\" CPU side-channel',\n    description:\n      'CVE-2018-3639: \"SSBD\" CPU side-channel mitigation disabled by command line',\n    cves: ['CVE-2018-3639'],\n  },\n  {\n    rule_id: 'CVE_2018_3639_cpu_kernel|CVE_2018_3639_CPU_BAD_KERNEL_2',\n    name: 'CVE-2018-3639: \"SSBD\" CPU side-channel',\n    description: 'CVE-2018-3639: \"SSBD\" CPU side-channel',\n    cves: ['CVE-2018-3639'],\n  },\n  {\n    rule_id: 'CVE_2018_3639_cpu_kernel|CVE_2018_3639_CPU_BAD_MICROCODE_2',\n    name: 'CVE-2018-3639: \"SSBD\" CPU side-channel',\n    description:\n      'CVE-2018-3639: \"SSBD\" CPU side-channel with outdated microcode',\n    cves: ['CVE-2018-3639'],\n  },\n  {\n    rule_id: 'CVE_2018_8897_kernel_popss|KERNEL_CVE_2018_8897_VULNERABLE_2',\n    name: 'CVE-2018-1087, CVE-2018-8897: \"POPSS\" kernel privilege escalation',\n    description:\n      'CVE-2018-1087, CVE-2018-8897: \"POPSS\" kernel privilege escalation',\n    cves: ['CVE-2018-1087', 'CVE-2018-8897'],\n  },\n  {\n    rule_id: 'CVE_2019_0155_gpu_kernel|CVE_2019_0155_GPU_KERNEL',\n    name: 'CVE-2019-0154, CVE-2019-0155: i915 GPU privilege escalation',\n    description: 'CVE-2019-0154, CVE-2019-0155: i915 GPU privilege escalation',\n    cves: ['CVE-2019-0154', 'CVE-2019-0155'],\n  },\n  {\n    rule_id: 'CVE_2019_11135_cpu_taa|CVE_2019_11135_CPU_TAA_BADCMD',\n    name: 'CVE-2019-11135: \"TAA\" kernel side-channel',\n    description:\n      'CVE-2019-11135: \"TAA\" kernel side-channel mitigation disabled',\n    cves: ['CVE-2019-11135'],\n  },\n  {\n    rule_id: 'CVE_2019_11135_cpu_taa|CVE_2019_11135_CPU_TAA_KERNEL',\n    name: 'CVE-2019-11135: \"TAA\" kernel side-channel',\n    description: 'CVE-2019-11135: \"TAA\" kernel side-channel',\n    cves: ['CVE-2019-11135'],\n  },\n  {\n    rule_id: 'CVE_2019_11135_cpu_taa|CVE_2019_11135_CPU_TAA_UCODE',\n    name: 'CVE-2019-11135: \"TAA\" kernel side-channel',\n    description:\n      'CVE-2019-11135: \"TAA\" kernel side-channel mitigation incomplete',\n    cves: ['CVE-2019-11135'],\n  },\n  {\n    rule_id: 'CVE_2019_1125_kernel|CVE_2019_1125_KERNEL_2',\n    name: 'CVE-2019-1125: \"SWAPGS\" CPU side-channel',\n    description: 'CVE-2019-1125: \"SWAPGS\" CPU side-channel',\n    cves: ['CVE-2019-1125'],\n  },\n  {\n    rule_id: 'CVE_2019_1125_kernel|CVE_2019_1125_KERNEL_BAD_CMDLINE_2',\n    name: 'CVE-2019-1125: \"SWAPGS\" CPU side-channel',\n    description: 'CVE-2019-1125: \"SWAPGS\" CPU side-channel mitigation disabled',\n    cves: ['CVE-2019-1125'],\n  },\n  {\n    rule_id: 'CVE_2019_11477_kernel|CVE_2019_11477_KERNEL',\n    name: 'CVE-2019-11477, CVE-2019-11478, CVE-2019-11479: \"Sack Panic\" kernel denial of service',\n    description:\n      'CVE-2019-11477, CVE-2019-11478, CVE-2019-11479: \"Sack Panic\" kernel denial of service',\n    cves: ['CVE-2019-11477', 'CVE-2019-11478', 'CVE-2019-11479'],\n  },\n  {\n    rule_id: 'CVE_2019_14835_kernel|CVE_2019_14835_KERNEL_VULN_BAD',\n    name: 'CVE-2019-14835: kernel privilege escalation during guest live migration',\n    description:\n      'CVE-2019-14835: kernel privilege escalation during guest live migration with virtualization',\n    cves: ['CVE-2019-14835'],\n  },\n  {\n    rule_id: 'CVE_2019_14835_kernel|CVE_2019_14835_KERNEL_VULN_NORMAL',\n    name: 'CVE-2019-14835: kernel privilege escalation during guest live migration',\n    description:\n      'CVE-2019-14835: kernel privilege escalation during guest live migration',\n    cves: ['CVE-2019-14835'],\n  },\n  {\n    rule_id: 'CVE_2019_5736_runc|CVE_2019_5736_RUNC',\n    name: 'CVE-2019-5736: runc privilege escalation',\n    description: 'CVE-2019-5736: runc privilege escalation',\n    cves: ['CVE-2019-5736'],\n  },\n  {\n    rule_id: 'CVEs_Top10_2015_flash_plugin|FLASH_CVES_TOP_10_2015',\n    name: 'Top 10 exploited vulnerabilities in 2015',\n    description: 'Top 10 exploited vulnerabilities in 2015',\n    cves: ['Top 10 exploited vulnerabilities in 2015'],\n  },\n  {\n    rule_id: 'CVEs_Top10_2016_flash_plugin|FLASH_CVES_TOP_10_2016',\n    name: 'Top 10 exploited vulnerabilities in 2016',\n    description: 'Top 10 exploited vulnerabilities in 2016',\n    cves: ['Top 10 exploited vulnerabilities in 2016'],\n  },\n  {\n    rule_id: 'CVEs_cgi_httpoxy|HTTPD_CVE_2016_5387_3',\n    name: 'CVE-2016-5387: \"HTTPoxy\" httpd man-in-the-middle',\n    description: 'CVE-2016-5387: \"HTTPoxy\" httpd man-in-the-middle',\n    cves: ['CVE-2016-5387'],\n  },\n  {\n    rule_id: 'CVEs_cgi_httpoxy|HTTPD_CVE_2016_5387_URGENT_3',\n    name: 'CVE-2016-5387: \"HTTPoxy\" httpd man-in-the-middle',\n    description:\n      'CVE-2016-5387: \"HTTPoxy\" httpd man-in-the-middle with listening processes',\n    cves: ['CVE-2016-5387'],\n  },\n  {\n    rule_id: 'CVEs_samba_badlock|SAMBA_CVE_2016_2118_CLIENT',\n    name: 'CVE-2016-2118: \"Badlock\" Samba man-in-the-middle',\n    description: 'CVE-2016-2118: \"Badlock\" Samba client man-in-the-middle',\n    cves: ['CVE-2016-2118'],\n  },\n  {\n    rule_id: 'CVEs_samba_badlock|SAMBA_CVE_2016_2118_SERVER',\n    name: 'CVE-2016-2118: \"Badlock\" Samba man-in-the-middle',\n    description: 'CVE-2016-2118: \"Badlock\" Samba server man-in-the-middle',\n    cves: ['CVE-2016-2118'],\n  },\n  {\n    rule_id: 'bash_injection|VULNERABLE_BASH_DETECTED',\n    name: 'CVE-2014-6271, CVE-2014-7169: \"Shellshock\" Bash privilege escalation',\n    description:\n      'CVE-2014-6271, CVE-2014-7169: \"Shellshock\" Bash privilege escalation',\n    cves: ['CVE-2014-6271', 'CVE-2014-7169'],\n  },\n  {\n    rule_id: 'hardening_httpd_ssl_pci_dss_poodle|HTTPD_POODLE_4',\n    name: 'Decreased security: httpd using deprecated TLS protocol',\n    description: 'CVE-2014-3566: \"POODLE\" SSLv3 man-in-the-middle',\n    cves: ['CVE-2014-3566'],\n  },\n  {\n    rule_id: 'heartbleed|HAS_HEARTBLEED',\n    name: 'CVE-2014-0160: \"Heartbleed\" OpenSSL information disclosure',\n    description: 'CVE-2014-0160: \"Heartbleed\" OpenSSL information disclosure',\n    cves: ['CVE-2014-0160'],\n  },\n  {\n    rule_id: 'heartbleed|HEARTBLEED_ACCESSIBLE',\n    name: 'CVE-2014-0160: \"Heartbleed\" OpenSSL information disclosure',\n    description:\n      'CVE-2014-0160: \"Heartbleed\" OpenSSL with listening processes information disclosure',\n    cves: ['CVE-2014-0160'],\n  },\n  {\n    rule_id: 'heartbleed|USING_HEARTBLEED_SO',\n    name: 'CVE-2014-0160: \"Heartbleed\" OpenSSL information disclosure',\n    description:\n      'CVE-2014-0160: \"Heartbleed\" OpenSSL with active processes information disclosure',\n    cves: ['CVE-2014-0160'],\n  },\n  {\n    rule_id: 'vsftpd_poodle|VSFTPD_POODLE',\n    name: 'CVE-2014-3566: \"POODLE\" vsftpd man-in-the-middle',\n    description: 'CVE-2014-3566: \"POODLE\" vsftpd man-in-the-middle',\n    cves: ['CVE-2014-3566'],\n  },\n];\n","import './Details.scss';\n\nimport * as AppActions from '../../AppActions';\n\nimport { BASE_URL, PERMS, SYSTEM_TYPES, UI_BASE } from '../../AppConstants';\nimport {\n  Card,\n  CardBody,\n  CardFooter,\n  CardHeader,\n} from '@patternfly/react-core/dist/js/components/Card';\nimport {\n  PageHeader,\n  PageHeaderTitle,\n} from '@redhat-cloud-services/frontend-components/PageHeader';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport {\n  encodeOptionsToURL,\n  workloadQueryBuilder,\n} from '../../PresentationalComponents/Common/Tables';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport API from '../../Utilities/Api';\nimport BellSlashIcon from '@patternfly/react-icons/dist/js/icons/bell-slash-icon';\nimport Breadcrumbs from '../../PresentationalComponents/Breadcrumbs/Breadcrumbs';\nimport { Button } from '@patternfly/react-core/dist/js/components/Button/Button';\nimport CaretDownIcon from '@patternfly/react-icons/dist/js/icons/caret-down-icon';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport DisableRule from '../../PresentationalComponents/Modals/DisableRule';\nimport { Dropdown } from '@patternfly/react-core/dist/js/components/Dropdown/Dropdown';\nimport { DropdownItem } from '@patternfly/react-core/dist/js/components/Dropdown/DropdownItem';\nimport { DropdownToggle } from '@patternfly/react-core/dist/js/components/Dropdown/DropdownToggle';\nimport Failed from '../../PresentationalComponents/Loading/Failed';\nimport { Flex } from '@patternfly/react-core/dist/js/layouts/Flex/Flex';\nimport { FlexItem } from '@patternfly/react-core/dist/js/layouts/Flex/FlexItem';\nimport Inventory from '../../PresentationalComponents/Inventory/Inventory';\nimport { Label } from '@patternfly/react-core/dist/js/components/Label/Label';\nimport Loading from '../../PresentationalComponents/Loading/Loading';\nimport { Main } from '@redhat-cloud-services/frontend-components/Main';\nimport MessageState from '../../PresentationalComponents/MessageState/MessageState';\nimport PropTypes from 'prop-types';\nimport RuleDetails from '../../PresentationalComponents/RuleDetails/RuleDetails';\nimport RuleLabels from '../../PresentationalComponents/RuleLabels/RuleLabels';\nimport { Title } from '@patternfly/react-core/dist/js/components/Title/Title';\nimport { Tooltip } from '@patternfly/react-core/dist/esm/components/Tooltip/Tooltip';\nimport ViewHostAcks from '../../PresentationalComponents/Modals/ViewHostAcks';\nimport { cveToRuleid } from '../../cveToRuleid.js';\nimport messages from '../../Messages';\nimport { addNotification as notification } from '@redhat-cloud-services/frontend-components-notifications/';\nimport routerParams from '@redhat-cloud-services/frontend-components-utilities/RouterParams';\nimport { useIntl } from 'react-intl';\nimport { usePermissions } from '@redhat-cloud-services/frontend-components-utilities/RBACHook';\n\nconst OverviewDetails = ({ match }) => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n\n  const permsDisableRec = usePermissions('advisor', PERMS.disableRec).hasAccess;\n  const [actionsDropdownOpen, setActionsDropdownOpen] = useState(false);\n  const [disableRuleModalOpen, setDisableRuleModalOpen] = useState(false);\n  const [host, setHost] = useState(undefined);\n  const [viewSystemsModalOpen, setViewSystemsModalOpen] = useState(false);\n  const [isRuleUpdated, setIsRuleUpdated] = useState(false);\n\n  const rule = useSelector(({ AdvisorStore }) => AdvisorStore.rule);\n  const ruleFetchStatus = useSelector(\n    ({ AdvisorStore }) => AdvisorStore.ruleFetchStatus\n  );\n  const topics = useSelector(({ AdvisorStore }) => AdvisorStore.topics);\n  const ruleAck = useSelector(({ AdvisorStore }) => AdvisorStore.ruleAck);\n  const selectedTags = useSelector(\n    ({ AdvisorStore }) => AdvisorStore.selectedTags\n  );\n  const workloads = useSelector(({ AdvisorStore }) => AdvisorStore.workloads);\n  const SID = useSelector(({ AdvisorStore }) => AdvisorStore.SID);\n  const fetchTopics = () => dispatch(AppActions.fetchTopics());\n  const addNotification = (data) => dispatch(notification(data));\n\n  const fetchRulefn = useCallback(\n    (newFilter, rule = true, system = true) => {\n      const fetchRule = (options, search) =>\n        dispatch(AppActions.fetchRule(options, search));\n      const fetchSystem = (rule_id, options, search) =>\n        dispatch(AppActions.fetchSystem(rule_id, options, search));\n      let options = selectedTags !== null &&\n        selectedTags.length && {\n          tags: selectedTags.map((tag) => encodeURIComponent(tag)),\n        };\n      workloads &&\n        (options = { ...options, ...workloadQueryBuilder(workloads, SID) });\n      if (system) {\n        fetchSystem(\n          match.params.id,\n          options.tags ? {} : { ...options, ...newFilter },\n          options.tags && encodeOptionsToURL({ ...options, ...newFilter })\n        );\n      }\n      if (rule) {\n        fetchRule(\n          options.tags\n            ? { rule_id: match.params.id }\n            : { rule_id: match.params.id, ...options },\n          options.tags && encodeOptionsToURL(options)\n        );\n      }\n    },\n    [selectedTags, workloads, SID, dispatch, match.params.id]\n  );\n\n  const ruleResolutionRisk = (rule) => {\n    const resolution = rule?.resolution_set?.find(\n      (resolution) =>\n        resolution.system_type === SYSTEM_TYPES.rhel || SYSTEM_TYPES.ocp\n    );\n    return resolution ? resolution.resolution_risk.risk : undefined;\n  };\n\n  const handleModalToggle = (disableRuleModalOpen, host = undefined) => {\n    setDisableRuleModalOpen(disableRuleModalOpen);\n    setHost(host);\n  };\n\n  const enableRule = async (rule) => {\n    try {\n      await API.delete(`${BASE_URL}/ack/${rule.rule_id}/`);\n      addNotification({\n        variant: 'success',\n        timeout: true,\n        dismissable: true,\n        title: intl.formatMessage(messages.recSuccessfullyEnabled),\n      });\n      fetchRulefn();\n    } catch (error) {\n      handleModalToggle(false);\n      addNotification({\n        variant: 'danger',\n        dismissable: true,\n        title: intl.formatMessage(messages.error),\n        description: `${error}`,\n      });\n    }\n  };\n\n  const afterDisableFn = async () => {\n    setHost(undefined);\n    fetchRulefn();\n  };\n\n  const actionResolver = () => [\n    {\n      title: 'Disable recommendation for system',\n      onClick: (event, rowIndex, item) => handleModalToggle(true, item),\n    },\n  ];\n\n  const bulkHostActions = async () => {\n    try {\n      const hostAckResponse = (\n        await API.get(\n          `${BASE_URL}/hostack/`,\n          {},\n          { rule_id: rule.rule_id, limit: rule.hosts_acked_count }\n        )\n      ).data;\n      const data = {\n        systems: hostAckResponse?.data?.map((item) => item.system_uuid),\n      };\n\n      await API.post(`${BASE_URL}/rule/${rule.rule_id}/unack_hosts/`, {}, data);\n      fetchRulefn();\n      addNotification({\n        variant: 'success',\n        timeout: true,\n        dismissable: true,\n        title: intl.formatMessage(messages.recSuccessfullyEnabledForSystem),\n      });\n    } catch (error) {\n      addNotification({\n        variant: 'danger',\n        dismissable: true,\n        title: intl.formatMessage(messages.error),\n        description: `${error}`,\n      });\n    }\n  };\n\n  useEffect(() => {\n    const isCVE =\n      cveToRuleid &&\n      cveToRuleid.find((mapping) => mapping.rule_id === match.params.id);\n\n    if (isCVE) {\n      window.location.href = `${UI_BASE}/vulnerability/cves/${\n        isCVE.cves[0].includes('CVE-')\n          ? `${isCVE.cves[0]}?security_rule=${match.params.id}`\n          : ''\n      }`;\n    } else {\n      fetchTopics();\n    }\n    fetchRulefn({}, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const tagRef = useRef();\n  const workloadRef = useRef();\n  const sidRef = useRef();\n\n  useEffect(() => {\n    if (\n      isRuleUpdated &&\n      selectedTags !== null &&\n      (JSON.stringify(tagRef.current) !== JSON.stringify(selectedTags) ||\n        JSON.stringify(workloadRef.current) !== JSON.stringify(workloads) ||\n        JSON.stringify(sidRef.current) !== JSON.stringify(SID))\n    ) {\n      fetchRulefn({}, false);\n    }\n\n    tagRef.current = selectedTags;\n    workloadRef.current = workloads;\n    sidRef.current = SID;\n  }, [selectedTags, workloads, SID, fetchRulefn, isRuleUpdated]);\n\n  useEffect(() => {\n    const fetchRuleAck = (data) => dispatch(AppActions.fetchRuleAck(data));\n\n    if (rule.rule_status !== 'enabled' && rule.rule_id && isRuleUpdated) {\n      fetchRuleAck({ rule_id: rule.rule_id });\n    } else if (!isRuleUpdated) {\n      fetchRulefn({}, true, false);\n      setIsRuleUpdated(true);\n    }\n\n    if (rule && rule.description) {\n      const subnav = `${rule.description} - ${messages.recommendations.defaultMessage}`;\n      document.title = intl.formatMessage(messages.documentTitle, { subnav });\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [rule, rule.rule_status, rule.rule_id]);\n\n  return (\n    <React.Fragment>\n      {viewSystemsModalOpen && (\n        <ViewHostAcks\n          handleModalToggle={(toggleModal) =>\n            setViewSystemsModalOpen(toggleModal)\n          }\n          isModalOpen={viewSystemsModalOpen}\n          afterFn={fetchRulefn}\n          rule={rule}\n        />\n      )}\n      {disableRuleModalOpen && (\n        <DisableRule\n          handleModalToggle={handleModalToggle}\n          isModalOpen={disableRuleModalOpen}\n          rule={rule}\n          afterFn={afterDisableFn}\n          host={host}\n        />\n      )}\n      {ruleFetchStatus === 'fulfilled' && (\n        <React.Fragment>\n          <PageHeader className=\"pageHeaderOverride\">\n            <Breadcrumbs\n              ouiaId=\"override\"\n              current={rule.description || ''}\n              match={match}\n            />\n          </PageHeader>\n          <Main className=\"pf-m-light pf-u-pt-sm\">\n            <RuleDetails\n              resolutionRisk={ruleResolutionRisk(rule)}\n              isDetailsPage\n              rule={rule}\n              topics={topics}\n              header={\n                <React.Fragment>\n                  <PageHeaderTitle\n                    title={\n                      <React.Fragment>\n                        <RuleLabels rule={rule} />\n                        {rule.description}\n                      </React.Fragment>\n                    }\n                  />\n                  <p>\n                    {intl.formatMessage(messages.rulesDetailsPubishdate, {\n                      date: (\n                        <DateFormat\n                          date={new Date(rule.publish_date)}\n                          type=\"onlyDate\"\n                        />\n                      ),\n                    })}\n                    <Label className=\"categoryLabel\" color=\"blue\">\n                      {rule.category.name}\n                    </Label>\n                  </p>\n                </React.Fragment>\n              }\n            >\n              <Flex>\n                <FlexItem align={{ default: 'alignRight' }}>\n                  <Tooltip\n                    trigger={!permsDisableRec ? 'mouseenter' : ''}\n                    content={intl.formatMessage(messages.permsAction)}\n                  >\n                    <Dropdown\n                      className=\"ins-c-rec-details__actions_dropdown\"\n                      onSelect={() =>\n                        setActionsDropdownOpen(!actionsDropdownOpen)\n                      }\n                      position=\"right\"\n                      ouiaId=\"actions\"\n                      toggle={\n                        <DropdownToggle\n                          isDisabled={!permsDisableRec}\n                          onToggle={(actionsDropdownOpen) =>\n                            setActionsDropdownOpen(actionsDropdownOpen)\n                          }\n                          toggleIndicator={CaretDownIcon}\n                        >\n                          {intl.formatMessage(messages.actions)}\n                        </DropdownToggle>\n                      }\n                      isOpen={actionsDropdownOpen}\n                      dropdownItems={\n                        rule && rule.rule_status === 'enabled'\n                          ? [\n                              <DropdownItem\n                                key=\"link\"\n                                ouiaId=\"disable\"\n                                onClick={() => {\n                                  handleModalToggle(true);\n                                }}\n                              >\n                                {intl.formatMessage(messages.disableRule)}\n                              </DropdownItem>,\n                            ]\n                          : [\n                              <DropdownItem\n                                key=\"link\"\n                                ouiaId=\"enable\"\n                                onClick={() => {\n                                  enableRule(rule);\n                                }}\n                              >\n                                {intl.formatMessage(messages.enableRule)}\n                              </DropdownItem>,\n                            ]\n                      }\n                    />\n                  </Tooltip>\n                </FlexItem>\n              </Flex>\n            </RuleDetails>\n          </Main>\n        </React.Fragment>\n      )}\n      {ruleFetchStatus === 'pending' && <Loading />}\n      <Main>\n        <React.Fragment>\n          {ruleFetchStatus === 'fulfilled' && (\n            <React.Fragment>\n              {(rule.hosts_acked_count > 0 ||\n                rule.rule_status !== 'enabled') && (\n                <Card className=\"cardOverride\">\n                  <CardHeader>\n                    <Title headingLevel=\"h4\" size=\"xl\">\n                      <BellSlashIcon size=\"sm\" />\n                      &nbsp;\n                      {intl.formatMessage(\n                        rule.hosts_acked_count > 0 &&\n                          rule.rule_status === 'enabled'\n                          ? messages.ruleIsDisabledForSystems\n                          : messages.ruleIsDisabled\n                      )}\n                    </Title>\n                  </CardHeader>\n                  <CardBody>\n                    {rule.hosts_acked_count > 0 &&\n                    rule.rule_status === 'enabled' ? (\n                      <React.Fragment>\n                        {intl.formatMessage(\n                          messages.ruleIsDisabledForSystemsBody,\n                          { systems: rule.hosts_acked_count }\n                        )}\n                        &nbsp;\n                        <Button\n                          isInline\n                          variant=\"link\"\n                          onClick={() => setViewSystemsModalOpen(true)}\n                          ouiaId=\"viewSystems\"\n                        >\n                          {intl.formatMessage(messages.viewSystems)}\n                        </Button>\n                      </React.Fragment>\n                    ) : (\n                      <React.Fragment>\n                        {intl.formatMessage(\n                          messages.ruleIsDisabledJustification\n                        )}\n                        <i>\n                          {ruleAck.justification ||\n                            intl.formatMessage(messages.none)}\n                        </i>\n                        {ruleAck.updated_at && (\n                          <span>\n                            &nbsp;\n                            <DateFormat\n                              date={new Date(ruleAck.updated_at)}\n                              type=\"onlyDate\"\n                            />\n                          </span>\n                        )}\n                      </React.Fragment>\n                    )}\n                  </CardBody>\n                  <CardFooter>\n                    {rule.hosts_acked_count > 0 &&\n                    rule.rule_status === 'enabled' ? (\n                      <Button\n                        isInline\n                        variant=\"link\"\n                        onClick={() => bulkHostActions()}\n                        ouiaId=\"bulkHost\"\n                      >\n                        {intl.formatMessage(messages.enableRuleForSystems)}\n                      </Button>\n                    ) : (\n                      <Button\n                        isInline\n                        variant=\"link\"\n                        onClick={() => enableRule(rule)}\n                        ouiaId=\"rule\"\n                      >\n                        {intl.formatMessage(messages.enableRule)}\n                      </Button>\n                    )}\n                  </CardFooter>\n                </Card>\n              )}\n              {rule.rule_status === 'enabled' && (\n                <React.Fragment>\n                  <Title className=\"titleOverride\" headingLevel=\"h3\" size=\"2xl\">\n                    {intl.formatMessage(messages.affectedSystems)}\n                  </Title>\n                  <Inventory\n                    tableProps={{\n                      canSelectAll: false,\n                      actionResolver,\n                      isStickyHeader: true,\n                    }}\n                    rule={rule}\n                    afterDisableFn={afterDisableFn}\n                    selectedTags={selectedTags}\n                    workloads={workloads}\n                    SID={SID}\n                  />\n                </React.Fragment>\n              )}\n              {rule.rule_status !== 'enabled' && (\n                <MessageState\n                  icon={BellSlashIcon}\n                  title={intl.formatMessage(messages.ruleIsDisabled)}\n                  text={intl.formatMessage(messages.ruleIsDisabledBody)}\n                />\n              )}\n            </React.Fragment>\n          )}\n          {ruleFetchStatus === 'pending' && <Loading />}\n          {ruleFetchStatus === 'failed' && (\n            <Failed\n              message={intl.formatMessage(messages.rulesTableFetchRulesError)}\n            />\n          )}\n        </React.Fragment>\n      </Main>\n    </React.Fragment>\n  );\n};\n\nOverviewDetails.propTypes = {\n  match: PropTypes.any,\n};\n\nexport default routerParams(OverviewDetails);\n"],"sourceRoot":""}