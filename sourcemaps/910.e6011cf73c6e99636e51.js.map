{"version":3,"sources":["webpack:///./src/SmartComponents/SystemAdvisor/SystemAdvisor.js"],"names":["BaseSystemAdvisor","intl","useIntl","dispatch","useDispatch","entity","useSelector","entityDetails","systemProfile","systemProfileStore","routerData","useState","inventoryReportFetchStatus","setInventoryReportFetchStatus","rows","setRows","activeReports","setActiveReports","kbaDetailsData","setKbaDetailsData","sortBy","setSortBy","filters","setFilters","accountSettings","setAccountSettings","searchValue","setSearchValue","isSelected","setIsSelected","isAllExpanded","setIsAllExpanded","results","length","satelliteManaged","satellite_managed","hideResultsSatelliteManaged","show_satellite_hosts","getSelectedItems","filter","selected","selectedAnsibleRules","r","resolution","has_playbook","selectedItemsLength","selectableItemsLength","cols","title","formatMessage","messages","transforms","sortable","cellWidth","AnsibeTowerIcon","size","fitContent","dataLabel","actions","RemediationButton","key","isDisabled","dataProvider","processRemediation","onRemediationCreated","result","data","getNotification","addNotificationAction","className","activeRuleFirst","reports","activeRuleIndex","params","findIndex","report","rule","rule_id","id","activeReport","splice","buildRows","kbaDetails","kbaLoading","builtRows","flatMap","value","kbaDetail","Object","keys","article","node_id","rowVal","rowKey","isOpen","reportRow","disableSelection","cells","description","RuleLabels","DateFormat","date","publish_date","type","tooltipProps","position","TooltipPosition","style","verticalAlign","Tooltip","content","LIKELIHOOD_LABEL","likelihood","IMPACT_LABEL","impact","InsightsLabel","total_risk","CheckCircleIcon","parent","fullWidth","ReportDetails","isValidSearchValue","toLowerCase","includes","isValidFilterValue","map","filterValues","rowValue","category","RULE_CATEGORIES","name","find","String","every","x","forEach","row","index","onBulkSelect","bulkSelect","items","onClick","count","checked","onSelect","activeFiltersConfig","deleteTitle","prunedFilters","entries","chips","item","FC","values","label","capitalize","urlParam","push","buildFilterChips","onDelete","_e","itemsToRemove","isAll","onFilterChange","fetchKbaDetails","reportsData","kbaIds","API","join","credentials","kbaDetailsFetch","response","docs","console","error","param","newFilters","removeFilterParam","issues","systems","filterConfigItems","onChange","onInputChange","useEffect","Promise","BASE_URL","all","settingsFetch","reportsFetch","activeRuleFirstReportsData","dataFetch","insights_id","Fragment","PrimaryToolbar","expandAll","allRows","prototype","hasOwnProperty","call","actionsConfig","filterConfig","pagination","Card","CardBody","MessageState","icon","PficonSatelliteIcon","text","href","rel","ExternalLinkAltIcon","Table","aria-label","rowId","onCollapse","collapseRows","canSelectAll","onSort","direction","sortedReports","1","2","3","4","sort","concat","firstItem","secondItem","sortedReportsDirectional","SortByDirection","reverse","variant","TableVariant","isStickyHeader","TableHeader","TableBody","CheckIcon","iconClass","ChartSpikeIcon","Bullseye","Stack","hasGutter","StackItem","ClipboardCopy","Button","component","target","TimesCircleIcon","SystemAdvisor","customItnl","intlProps","props","Wrapper","IntlProvider","locale","navigator","language","slice","onError","log","propTypes","PropTypes"],"mappings":"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","file":"js/910.cb3f1ae376c06ca26eb9.js","sourcesContent":["import './SystemAdvisor.scss';\n\nimport {\n  AnsibeTowerIcon,\n  ChartSpikeIcon,\n  CheckCircleIcon,\n  CheckIcon,\n  ExternalLinkAltIcon,\n  PficonSatelliteIcon,\n  TimesCircleIcon,\n} from '@patternfly/react-icons';\nimport {\n  BASE_URL,\n  FILTER_CATEGORIES as FC,\n  IMPACT_LABEL,\n  LIKELIHOOD_LABEL,\n  RULE_CATEGORIES,\n} from '../../AppConstants';\nimport {\n  Bullseye,\n  Button,\n  Card,\n  CardBody,\n  ClipboardCopy,\n  Stack,\n  StackItem,\n  Tooltip,\n  TooltipPosition,\n} from '@patternfly/react-core';\nimport { IntlProvider, useIntl } from 'react-intl';\nimport React, { Fragment, useEffect, useState } from 'react';\nimport {\n  SortByDirection,\n  Table,\n  TableBody,\n  TableHeader,\n  TableVariant,\n  cellWidth,\n  fitContent,\n  sortable,\n} from '@patternfly/react-table';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport API from '../../Utilities/Api';\nimport DateFormat from '@redhat-cloud-services/frontend-components/DateFormat';\nimport InsightsLabel from '@redhat-cloud-services/frontend-components/InsightsLabel';\nimport { List } from 'react-content-loader';\nimport MessageState from '../../PresentationalComponents/MessageState/MessageState';\nimport PrimaryToolbar from '@redhat-cloud-services/frontend-components/PrimaryToolbar';\nimport PropTypes from 'prop-types';\nimport RemediationButton from '@redhat-cloud-services/frontend-components-remediations/RemediationButton';\nimport ReportDetails from '../../PresentationalComponents/ReportDetails';\nimport RuleLabels from '../../PresentationalComponents/RuleLabels/RuleLabels';\nimport { addNotification as addNotificationAction } from '@redhat-cloud-services/frontend-components-notifications/';\nimport { capitalize } from '../../PresentationalComponents/Common/Tables';\nimport messages from '../../Messages';\n\nconst BaseSystemAdvisor = () => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n  const addNotification = (data) => dispatch(addNotificationAction(data));\n\n  const entity = useSelector(({ entityDetails }) => entityDetails.entity);\n  const systemProfile = useSelector(({ systemProfileStore }) =>\n    systemProfileStore ? systemProfileStore.systemProfile : {}\n  );\n  const routerData = useSelector(({ routerData }) => routerData);\n\n  const [inventoryReportFetchStatus, setInventoryReportFetchStatus] =\n    useState('pending');\n  const [rows, setRows] = useState([]);\n  const [activeReports, setActiveReports] = useState([]);\n  const [kbaDetailsData, setKbaDetailsData] = useState([]);\n  const [sortBy, setSortBy] = useState({});\n  const [filters, setFilters] = useState({});\n  const [accountSettings, setAccountSettings] = useState({});\n  const [searchValue, setSearchValue] = useState('');\n  const [isSelected, setIsSelected] = useState(false);\n  const [isAllExpanded, setIsAllExpanded] = useState(false);\n  const results = rows ? rows.length / 2 : 0;\n  const satelliteManaged =\n    (systemProfile && systemProfile.satellite_managed) || false; // system is managed by satellite\n  const satelliteShowHosts = accountSettings.show_satellite_hosts || false; // setting to show satellite managed systems\n  const hideResultsSatelliteManaged = !satelliteShowHosts && satelliteManaged;\n  const getSelectedItems = (rows) => rows.filter((entity) => entity.selected);\n  const selectedAnsibleRules = getSelectedItems(rows).filter(\n    (r) => r.resolution && r.resolution.has_playbook\n  );\n  const selectedItemsLength = getSelectedItems(rows).length;\n  const selectableItemsLength = rows.filter(\n    (r) => r.resolution && r.resolution.has_playbook\n  ).length;\n\n  const cols = [\n    {\n      title: intl.formatMessage(messages.topicAddEditDescription),\n      transforms: [sortable],\n    },\n    {\n      title: intl.formatMessage(messages.added),\n      transforms: [sortable, cellWidth(15)],\n    },\n    {\n      title: intl.formatMessage(messages.totalRisk),\n      transforms: [sortable],\n    },\n    {\n      title: (\n        <span>\n          {AnsibeTowerIcon && <AnsibeTowerIcon size=\"md\" />}{' '}\n          {intl.formatMessage(messages.ansible)}\n        </span>\n      ),\n      transforms: [sortable, fitContent],\n      dataLabel: intl.formatMessage(messages.ansible),\n    },\n  ];\n\n  const onExpandAllClick = (_e, isOpen) => {\n    setIsAllExpanded(isOpen);\n    const allRows = [...rows];\n\n    allRows.map((row) => {\n      if (Object.prototype.hasOwnProperty.call(row, 'isOpen')) {\n        row.isOpen = isOpen;\n      }\n    });\n\n    setRows(allRows);\n  };\n\n  const actions = [\n    <RemediationButton\n      key=\"remediation-button\"\n      isDisabled={selectedAnsibleRules.length === 0}\n      dataProvider={() => processRemediation(selectedAnsibleRules)}\n      onRemediationCreated={(result) =>\n        addNotification(result.getNotification())\n      }\n    >\n      {AnsibeTowerIcon && (\n        <AnsibeTowerIcon size=\"sm\" className=\"ins-c-background__default\" />\n      )}{' '}\n      Remediate\n    </RemediationButton>,\n  ];\n\n  const activeRuleFirst = (activeReports) => {\n    const reports = [...activeReports];\n    const activeRuleIndex =\n      routerData && typeof routerData.params !== 'undefined'\n        ? activeReports.findIndex(\n            (report) => report.rule.rule_id === routerData.params.id\n          )\n        : -1;\n    const activeReport = reports.splice(activeRuleIndex, 1);\n\n    return activeRuleIndex !== -1\n      ? [activeReport[0], ...reports]\n      : activeReports;\n  };\n\n  const handleOnCollapse = (_e, rowId, isOpen) => {\n    const collapseRows = [...rows];\n    collapseRows[rowId] = { ...collapseRows[rowId], isOpen };\n    setRows(collapseRows);\n  };\n\n  const buildRows = (\n    activeReports,\n    kbaDetails,\n    filters,\n    rows,\n    searchValue = '',\n    kbaLoading = false\n  ) => {\n    const builtRows = activeReports.flatMap((value, key) => {\n      const rule = value.rule;\n      const resolution = value.resolution;\n      const kbaDetail = Object.keys(kbaDetails).length\n        ? kbaDetails.filter((article) => article.id === value.rule.node_id)[0]\n        : {};\n      const entity = rows.filter(\n        (rowVal, rowKey) =>\n          rowKey % 2 === 0 && rowVal.rule.rule_id === rule.rule_id && rowVal\n      );\n      const selected = entity.length ? entity[0].selected : false;\n      const isOpen = rows.length\n        ? entity.length\n          ? entity[0].isOpen\n          : false\n        : key === 0\n        ? true\n        : false;\n\n      const reportRow = [\n        {\n          rule,\n          resolution,\n          isOpen,\n          selected,\n          disableSelection: !resolution.has_playbook,\n          cells: [\n            {\n              title: (\n                <span>\n                  {rule.description} <RuleLabels rule={rule} />\n                </span>\n              ),\n            },\n            {\n              title: (\n                <div key={key}>\n                  <DateFormat\n                    date={rule.publish_date}\n                    type=\"relative\"\n                    tooltipProps={{ position: TooltipPosition.bottom }}\n                  />\n                </div>\n              ),\n            },\n            {\n              title: (\n                <div key={key} style={{ verticalAlign: 'top' }}>\n                  <Tooltip\n                    key={key}\n                    position={TooltipPosition.bottom}\n                    content={\n                      <span>\n                        The <strong>likelihood</strong> that this will be a\n                        problem is {LIKELIHOOD_LABEL[rule.likelihood]}. The{' '}\n                        <strong>impact</strong> of the problem would be &nbsp;\n                        {IMPACT_LABEL[rule.impact.impact]} if it occurred.\n                      </span>\n                    }\n                  >\n                    <InsightsLabel value={rule.total_risk} />\n                  </Tooltip>\n                </div>\n              ),\n            },\n            {\n              title: (\n                <div className=\"ins-c-center-text\" key={key}>\n                  {resolution.has_playbook ? (\n                    <CheckCircleIcon className=\"successColorOverride\" />\n                  ) : (\n                    'No'\n                  )}\n                </div>\n              ),\n            },\n          ],\n        },\n        {\n          parent: key,\n          fullWidth: true,\n          cells: [\n            {\n              title: (\n                <ReportDetails\n                  key={`child-${key}`}\n                  report={value}\n                  kbaDetail={kbaDetail}\n                  kbaLoading={kbaLoading}\n                />\n              ),\n            },\n          ],\n        },\n      ];\n      const isValidSearchValue =\n        searchValue.length === 0 ||\n        rule.description.toLowerCase().includes(searchValue.toLowerCase());\n      const isValidFilterValue =\n        Object.keys(filters).length === 0 ||\n        Object.keys(filters)\n          .map((key) => {\n            const filterValues = filters[key];\n            const rowValue = {\n              has_playbook: value.resolution.has_playbook,\n              publish_date: rule.publish_date,\n              total_risk: rule.total_risk,\n              category: RULE_CATEGORIES[rule.category.name.toLowerCase()],\n            };\n            return filterValues.find(\n              (value) => String(value) === String(rowValue[key])\n            );\n          })\n          .every((x) => x);\n\n      return isValidSearchValue && isValidFilterValue ? reportRow : [];\n    });\n    //must recalculate parent for expandable table content whenever the array size changes\n    builtRows.forEach((row, index) =>\n      row.parent ? (row.parent = index - 1) : null\n    );\n\n    return builtRows;\n  };\n\n  const onRowSelect = (_e, isSelected, rowId) =>\n    setRows(\n      buildRows(\n        activeReports,\n        kbaDetailsData,\n        filters,\n        rows.map((row, index) =>\n          index === rowId ? { ...row, selected: isSelected } : row\n        ),\n        searchValue\n      )\n    );\n\n  const onBulkSelect = (isSelected) => {\n    setIsSelected(isSelected);\n    setRows(\n      buildRows(\n        activeReports,\n        kbaDetailsData,\n        filters,\n        rows.map((row, index) =>\n          // We need to use mod 2 here to ignore children with no has_playbook param\n          index % 2 === 0 && row.resolution.has_playbook\n            ? { ...row, selected: isSelected }\n            : row\n        ),\n        searchValue\n      )\n    );\n  };\n\n  const bulkSelect = {\n    items: [\n      {\n        title: 'Select none',\n        onClick: () => onBulkSelect(false),\n      },\n      {\n        title: 'Select all',\n        onClick: () => onBulkSelect(true),\n      },\n    ],\n    count: selectedItemsLength,\n    checked: selectedItemsLength === selectableItemsLength,\n    onSelect: () => onBulkSelect(!isSelected),\n  };\n\n  const buildFilterChips = (filters) => {\n    const prunedFilters = Object.entries(filters);\n    let chips =\n      filters && prunedFilters.length > 0\n        ? prunedFilters.map((item) => {\n            const category = FC[item[0]];\n            const chips = item[1].map((value) => ({\n              name: category.values.find(\n                (values) => values.value === String(value)\n              ).label,\n              value,\n            }));\n            return {\n              category: capitalize(category.title),\n              chips,\n              urlParam: category.urlParam,\n            };\n          })\n        : [];\n    searchValue.length > 0 &&\n      chips.push({\n        category: 'Description',\n        chips: [{ name: searchValue, value: searchValue }],\n      });\n    return chips;\n  };\n\n  const onChipDelete = (_e, itemsToRemove, isAll) => {\n    if (isAll) {\n      setRows(buildRows(activeReports, kbaDetailsData, {}, rows, ''));\n      setFilters({});\n      setSearchValue('');\n    } else {\n      itemsToRemove.map((item) => {\n        if (item.category === 'Description') {\n          setRows(buildRows(activeReports, kbaDetailsData, filters, rows, ''));\n          setSearchValue('');\n        } else {\n          onFilterChange(\n            item.urlParam,\n            filters[item.urlParam].filter(\n              (value) => String(value) !== String(item.chips[0].value)\n            )\n          );\n        }\n      });\n    }\n  };\n\n  const activeFiltersConfig = {\n    deleteTitle: intl.formatMessage(messages.resetFilters),\n    filters: buildFilterChips(filters),\n    onDelete: onChipDelete,\n  };\n\n  const fetchKbaDetails = async (reportsData) => {\n    const kbaIds = reportsData.map(({ rule }) => rule.node_id).filter((x) => x);\n    try {\n      const kbaDetailsFetch = (\n        await API.get(\n          `https://access.redhat.com/hydra/rest/search/kcs?q=id:(${kbaIds.join(\n            ` OR `\n          )})&fl=view_uri,id,publishedTitle&rows=${\n            kbaIds.length\n          }&redhat_client=$ADVISOR`,\n          {},\n          { credentials: 'include' }\n        )\n      ).data.response.docs;\n\n      setKbaDetailsData(kbaDetailsFetch);\n      setRows(\n        buildRows(reportsData, kbaDetailsFetch, filters, rows, searchValue)\n      );\n    } catch (error) {\n      console.error(error, 'KBA fetch failed.');\n    }\n  };\n\n  const onSort = (_e, index, direction) => {\n    const sortedReports = {\n      1: 'description',\n      2: 'publish_date',\n      3: 'total_risk',\n      4: 'has_playbook',\n    };\n    const key = index === 5 ? 'resolution' : 'rule';\n    const sort = (key) =>\n      activeReports\n        .concat()\n        .sort((firstItem, secondItem) =>\n          firstItem[key][sortedReports[index]] >\n          secondItem[key][sortedReports[index]]\n            ? 1\n            : secondItem[key][sortedReports[index]] >\n              firstItem[key][sortedReports[index]]\n            ? -1\n            : 0\n        );\n    const sortedReportsDirectional =\n      direction === SortByDirection.asc ? sort(key) : sort(key).reverse();\n\n    setActiveReports(sortedReportsDirectional);\n    setSortBy({\n      index,\n      direction,\n    });\n    setRows(\n      buildRows(\n        sortedReportsDirectional,\n        kbaDetailsData,\n        filters,\n        rows,\n        searchValue\n      )\n    );\n  };\n\n  const onFilterChange = (param, values) => {\n    const removeFilterParam = (param) => {\n      const filter = { ...filters };\n      delete filter[param];\n      return filter;\n    };\n\n    const newFilters =\n      values.length > 0\n        ? { ...filters, ...{ [param]: values } }\n        : removeFilterParam(param);\n    setRows(\n      buildRows(activeReports, kbaDetailsData, newFilters, rows, searchValue)\n    );\n    setFilters(newFilters);\n  };\n\n  const onInputChange = (value) => {\n    const builtRows = buildRows(\n      activeReports,\n      kbaDetailsData,\n      filters,\n      rows,\n      value\n    );\n    setSearchValue(value);\n    setRows(builtRows);\n  };\n\n  const processRemediation = (selectedAnsibleRules) => {\n    const playbookRows = selectedAnsibleRules.filter(\n      (r) => r.resolution && r.resolution.has_playbook\n    );\n    const issues = playbookRows.map((r) => ({\n      id: `advisor:${r.rule.rule_id}`,\n      description: r.rule.description,\n    }));\n    return issues.length ? { issues, systems: [entity.id] } : false;\n  };\n\n  const filterConfigItems = [\n    {\n      label: 'description',\n      filterValues: {\n        key: 'text-filter',\n        onChange: (_e, value) => onInputChange(value),\n        value: searchValue,\n      },\n    },\n    {\n      label: FC.total_risk.title,\n      type: FC.total_risk.type,\n      id: FC.total_risk.urlParam,\n      value: `checkbox-${FC.total_risk.urlParam}`,\n      filterValues: {\n        key: `${FC.total_risk.urlParam}-filter`,\n        onChange: (_e, values) =>\n          onFilterChange(FC.total_risk.urlParam, values),\n        value: filters.total_risk,\n        items: FC.total_risk.values,\n      },\n    },\n    {\n      label: FC.category.title,\n      type: FC.category.type,\n      id: FC.category.urlParam,\n      value: `checkbox-${FC.category.urlParam}`,\n      filterValues: {\n        key: `${FC.category.urlParam}-filter`,\n        onChange: (_e, values) => onFilterChange(FC.category.urlParam, values),\n        value: filters.category,\n        items: FC.category.values,\n      },\n    },\n    {\n      label: FC.has_playbook.title,\n      type: FC.has_playbook.type,\n      id: FC.has_playbook.urlParam,\n      value: `checkbox-${FC.has_playbook.urlParam}`,\n      filterValues: {\n        key: `${FC.has_playbook.urlParam}-filter`,\n        onChange: (_e, values) =>\n          onFilterChange(FC.has_playbook.urlParam, values),\n        value: filters.has_playbook,\n        items: FC.has_playbook.values,\n      },\n    },\n  ];\n\n  useEffect(() => {\n    const dataFetch = async () => {\n      try {\n        const [settingsFetch, reportsFetch] = await Promise.all([\n          (\n            await API.get(`${BASE_URL}/account_setting/`, {\n              credentials: 'include',\n            })\n          ).data,\n          (\n            await API.get(`${BASE_URL}/system/${entity.id}/reports/`, {\n              credentials: 'include',\n            })\n          ).data,\n        ]);\n\n        const activeRuleFirstReportsData = activeRuleFirst(reportsFetch);\n        fetchKbaDetails(activeRuleFirstReportsData);\n        setRows(\n          buildRows(\n            activeRuleFirstReportsData,\n            {},\n            filters,\n            rows,\n            searchValue,\n            true\n          )\n        );\n        setInventoryReportFetchStatus('fulfilled');\n        setActiveReports(activeRuleFirstReportsData);\n        setAccountSettings(settingsFetch);\n      } catch (error) {\n        setInventoryReportFetchStatus('failed');\n      }\n    };\n    dataFetch();\n  }, []);\n\n  return (\n    <div className=\"ins-c-inventory-insights__overrides\">\n      {inventoryReportFetchStatus === 'pending' ||\n      (inventoryReportFetchStatus === 'fulfilled' &&\n        hideResultsSatelliteManaged) ||\n      entity.insights_id === null ? (\n        <Fragment />\n      ) : (\n        <PrimaryToolbar\n          expandAll={{ isAllExpanded, onClick: onExpandAllClick }}\n          actionsConfig={{ actions }}\n          bulkSelect={bulkSelect}\n          filterConfig={{ items: filterConfigItems }}\n          pagination={\n            <Fragment>\n              {' '}\n              {results === 1\n                ? `${results} Recommendation`\n                : `${results} Recommendations`}{' '}\n            </Fragment>\n          }\n          activeFiltersConfig={activeFiltersConfig}\n        />\n      )}\n      {inventoryReportFetchStatus === 'pending' && (\n        <Card>\n          <CardBody>\n            <List />\n          </CardBody>\n        </Card>\n      )}\n      {inventoryReportFetchStatus === 'fulfilled' &&\n        (hideResultsSatelliteManaged ? (\n          <MessageState\n            icon={PficonSatelliteIcon}\n            title=\"Satellite managed system\"\n            text={\n              <span key=\"satellite managed system\">\n                Insights results can not be displayed for this host, as the\n                &quot;Hide Satellite Managed Systems&quot; setting has been\n                enabled by an org admin.\n                <br />\n                For more information on this setting and how to modify it,\n                <a\n                  href=\"https://access.redhat.com/solutions/4281761\"\n                  rel=\"noopener\"\n                >\n                  {' '}\n                  Please visit this Knowledgebase article &nbsp;\n                  <ExternalLinkAltIcon />\n                </a>\n                .\n              </span>\n            }\n          />\n        ) : activeReports.length > 0 ? (\n          <Fragment>\n            <Table\n              aria-label={'report-table'}\n              onSelect={onRowSelect}\n              onCollapse={handleOnCollapse}\n              rows={rows}\n              cells={cols}\n              sortBy={sortBy}\n              canSelectAll={false}\n              onSort={onSort}\n              variant={TableVariant.compact}\n              isStickyHeader\n            >\n              <TableHeader />\n              <TableBody />\n            </Table>\n            {results === 0 && (\n              <Card>\n                <CardBody>\n                  <MessageState\n                    title=\"No matching recommendations found\"\n                    text={`This filter criteria matches no recommendations. Try changing your filter settings.`}\n                  />\n                </CardBody>\n              </Card>\n            )}\n          </Fragment>\n        ) : entity.insights_id !== null ? (\n          <Card>\n            <CardBody>\n              <MessageState\n                icon={CheckIcon}\n                iconClass=\"ins-c-insights__check\"\n                title=\"No recommendations\"\n                text={`No known recommendations affect this system`}\n              />\n            </CardBody>\n          </Card>\n        ) : (\n          <MessageState\n            iconClass=\"chartSpikeIconColor\"\n            icon={ChartSpikeIcon}\n            title=\"Get started with Red Hat Insights\"\n            text={\n              <Bullseye>\n                <Stack hasGutter>\n                  <StackItem>\n                    1. Install the client on the RHEL system.\n                    <ClipboardCopy>yum install insights-client</ClipboardCopy>\n                  </StackItem>\n                  <StackItem>\n                    2. Register the system to Red Hat Insights.\n                    <ClipboardCopy>insights-client --register</ClipboardCopy>\n                  </StackItem>\n                </Stack>\n              </Bullseye>\n            }\n          >\n            <Button\n              component=\"a\"\n              href=\"https://access.redhat.com/products/red-hat-insights#getstarted\"\n              target=\"_blank\"\n              variant=\"primary\"\n            >\n              Getting started documentation\n            </Button>\n          </MessageState>\n        ))}\n      {inventoryReportFetchStatus === 'failed' && entity && (\n        <Card>\n          <CardBody>\n            <MessageState\n              icon={TimesCircleIcon}\n              title=\"Error getting recommendations\"\n              text={\n                entity\n                  ? `There was an error fetching recommendations for this entity. Refresh your page to try again.`\n                  : `This entity can not be found or might no longer be registered to Red Hat Insights.`\n              }\n            />\n          </CardBody>\n        </Card>\n      )}\n    </div>\n  );\n};\n\nconst SystemAdvisor = ({ customItnl, intlProps, ...props }) => {\n  const Wrapper = customItnl ? IntlProvider : Fragment;\n  return (\n    <Wrapper\n      {...(customItnl && {\n        locale: navigator.language.slice(0, 2),\n        messages,\n        onError: console.log,\n        ...intlProps,\n      })}\n    >\n      <BaseSystemAdvisor {...props} />\n    </Wrapper>\n  );\n};\n\nexport default SystemAdvisor;\n\nSystemAdvisor.propTypes = {\n  customItnl: PropTypes.bool,\n  intlProps: PropTypes.shape({\n    locale: PropTypes.string,\n    messages: PropTypes.array,\n    onError: PropTypes.func,\n  }),\n};\n"],"sourceRoot":""}