{"version":3,"sources":["webpack:///./src/SmartComponents/SystemAdvisor/SystemAdvisor.js"],"names":["BaseSystemAdvisor","intl","useIntl","dispatch","useDispatch","entity","useSelector","entityDetails","systemProfile","systemProfileStore","routerData","useState","inventoryReportFetchStatus","setInventoryReportFetchStatus","rows","setRows","activeReports","setActiveReports","kbaDetailsData","setKbaDetailsData","sortBy","setSortBy","filters","setFilters","accountSettings","setAccountSettings","searchValue","setSearchValue","isSelected","setIsSelected","results","length","satelliteManaged","satellite_managed","hideResultsSatelliteManaged","show_satellite_hosts","getSelectedItems","filter","selected","selectedAnsibleRules","r","resolution","has_playbook","selectedItemsLength","selectableItemsLength","cols","title","formatMessage","messages","transforms","sortable","cellWidth","AnsibeTowerIcon","size","fitContent","dataLabel","onKebabClick","action","isOpen","allRows","map","row","key","Object","prototype","hasOwnProperty","call","handleOnCollapse","actions","RemediationButton","isDisabled","dataProvider","processRemediation","onRemediationCreated","result","data","getNotification","addNotificationAction","className","label","onClick","activeRuleFirst","reports","activeRuleIndex","params","findIndex","report","rule","rule_id","id","activeReport","splice","_e","rowId","collapseRows","buildRows","kbaDetails","kbaLoading","builtRows","flatMap","value","kbaDetail","keys","article","node_id","rowVal","rowKey","reportRow","cells","aria-label","type","checked","onChange","event","onSelect","description","DateFormat","date","publish_date","tooltipProps","position","TooltipPosition","style","verticalAlign","Tooltip","content","LIKELIHOOD_LABEL","likelihood","IMPACT_LABEL","impact","InsightsLabel","total_risk","CheckCircleIcon","parent","fullWidth","ReportDetails","isValidSearchValue","toLowerCase","includes","isValidFilterValue","filterValues","rowValue","category","RULE_CATEGORIES","name","find","String","every","x","forEach","index","onBulkSelect","bulkSelect","items","count","activeFiltersConfig","deleteTitle","prunedFilters","entries","chips","item","FC","values","capitalize","urlParam","push","buildFilterChips","onDelete","itemsToRemove","isAll","onFilterChange","fetchKbaDetails","reportsData","kbaIds","API","join","credentials","kbaDetailsFetch","response","docs","console","error","param","newFilters","removeFilterParam","oneRow","issues","systems","filterConfigItems","onInputChange","useEffect","Promise","BASE_URL","all","settingsFetch","reportsFetch","activeRuleFirstReportsData","dataFetch","insights_id","Fragment","PrimaryToolbar","actionsConfig","filterConfig","pagination","Card","CardBody","MessageState","icon","PficonSatelliteIcon","text","href","rel","ExternalLinkAltIcon","Table","onCollapse","canSelectAll","onSort","direction","sortedReports","2","3","4","5","sort","concat","firstItem","secondItem","sortedReportsDirectional","SortByDirection","reverse","isStickyHeader","TableHeader","TableBody","CheckIcon","iconClass","ChartSpikeIcon","Bullseye","Stack","hasGutter","StackItem","ClipboardCopy","Button","component","target","variant","TimesCircleIcon","SystemAdvisor","customItnl","intlProps","props","Wrapper","IntlProvider","locale","navigator","language","slice","onError","log","propTypes","PropTypes"],"mappings":"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","file":"js/5910.9d8b4a0235a6d80bd14e.js","sourcesContent":["import './SystemAdvisor.scss';\n\nimport {\n  AnsibeTowerIcon,\n  ChartSpikeIcon,\n  CheckCircleIcon,\n  CheckIcon,\n  ExternalLinkAltIcon,\n  PficonSatelliteIcon,\n  TimesCircleIcon,\n} from '@patternfly/react-icons';\nimport {\n  BASE_URL,\n  FILTER_CATEGORIES as FC,\n  IMPACT_LABEL,\n  LIKELIHOOD_LABEL,\n  RULE_CATEGORIES,\n} from '../../AppConstants';\nimport {\n  Bullseye,\n  Button,\n  Card,\n  CardBody,\n  ClipboardCopy,\n  Stack,\n  StackItem,\n  Tooltip,\n  TooltipPosition,\n} from '@patternfly/react-core';\nimport React, { Fragment, useEffect, useState } from 'react';\nimport {\n  SortByDirection,\n  Table,\n  TableBody,\n  TableHeader,\n  cellWidth,\n  fitContent,\n  sortable,\n} from '@patternfly/react-table';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport API from '../../Utilities/Api';\nimport DateFormat from '@redhat-cloud-services/frontend-components/DateFormat';\nimport InsightsLabel from '@redhat-cloud-services/frontend-components/InsightsLabel';\nimport { List } from 'react-content-loader';\nimport MessageState from '../../PresentationalComponents/MessageState/MessageState';\nimport PrimaryToolbar from '@redhat-cloud-services/frontend-components/PrimaryToolbar';\nimport RemediationButton from '@redhat-cloud-services/frontend-components-remediations/RemediationButton';\nimport ReportDetails from '../../PresentationalComponents/ReportDetails';\nimport { addNotification as addNotificationAction } from '@redhat-cloud-services/frontend-components-notifications/';\nimport { capitalize } from '../../PresentationalComponents/Common/Tables';\nimport messages from '../../Messages';\nimport PropTypes from 'prop-types';\nimport { useIntl, IntlProvider } from 'react-intl';\n\nconst BaseSystemAdvisor = () => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n  const addNotification = (data) => dispatch(addNotificationAction(data));\n\n  const entity = useSelector(({ entityDetails }) => entityDetails.entity);\n  const systemProfile = useSelector(({ systemProfileStore }) =>\n    systemProfileStore ? systemProfileStore.systemProfile : {}\n  );\n  const routerData = useSelector(({ routerData }) => routerData);\n\n  const [inventoryReportFetchStatus, setInventoryReportFetchStatus] =\n    useState('pending');\n  const [rows, setRows] = useState([]);\n  const [activeReports, setActiveReports] = useState([]);\n  const [kbaDetailsData, setKbaDetailsData] = useState([]);\n  const [sortBy, setSortBy] = useState({});\n  const [filters, setFilters] = useState({});\n  const [accountSettings, setAccountSettings] = useState({});\n  const [searchValue, setSearchValue] = useState('');\n  const [isSelected, setIsSelected] = useState(false);\n\n  const results = rows ? rows.length / 2 : 0;\n  const satelliteManaged =\n    (systemProfile && systemProfile.satellite_managed) || false; // system is managed by satellite\n  const satelliteShowHosts = accountSettings.show_satellite_hosts || false; // setting to show satellite managed systems\n  const hideResultsSatelliteManaged = !satelliteShowHosts && satelliteManaged;\n  const getSelectedItems = (rows) => rows.filter((entity) => entity.selected);\n  const selectedAnsibleRules = getSelectedItems(rows).filter(\n    (r) => r.resolution && r.resolution.has_playbook\n  );\n  const selectedItemsLength = getSelectedItems(rows).length;\n  const selectableItemsLength = rows.filter(\n    (r) => r.resolution && r.resolution.has_playbook\n  ).length;\n\n  const cols = [\n    { title: '' },\n    {\n      title: intl.formatMessage(messages.topicAddEditDescription),\n      transforms: [sortable],\n    },\n    {\n      title: intl.formatMessage(messages.added),\n      transforms: [sortable, cellWidth(15)],\n    },\n    {\n      title: intl.formatMessage(messages.totalRisk),\n      transforms: [sortable],\n    },\n    {\n      title: (\n        <span>\n          {AnsibeTowerIcon && <AnsibeTowerIcon size=\"md\" />}{' '}\n          {intl.formatMessage(messages.ansible)}\n        </span>\n      ),\n      transforms: [sortable, fitContent],\n      dataLabel: intl.formatMessage(messages.ansible),\n    },\n  ];\n\n  const onKebabClick = (action) => {\n    const isOpen = action === 'insights-expand-all';\n    const allRows = [...rows];\n\n    allRows.map((row, key) => {\n      if (Object.prototype.hasOwnProperty.call(row, 'isOpen')) {\n        row.isOpen = isOpen;\n        isOpen && handleOnCollapse(null, key, isOpen);\n      }\n    });\n\n    setRows(allRows);\n  };\n\n  const actions = [\n    <RemediationButton\n      key=\"remediation-button\"\n      isDisabled={selectedAnsibleRules.length === 0}\n      dataProvider={() => processRemediation(selectedAnsibleRules)}\n      onRemediationCreated={(result) =>\n        addNotification(result.getNotification())\n      }\n    >\n      {AnsibeTowerIcon && (\n        <AnsibeTowerIcon size=\"sm\" className=\"ins-c-background__default\" />\n      )}{' '}\n      Remediate\n    </RemediationButton>,\n    {\n      label: 'Collapse all',\n      onClick: () => onKebabClick('insights-collapse-all'),\n    },\n    {\n      label: 'Expand all',\n      onClick: () => onKebabClick('insights-expand-all'),\n    },\n  ];\n\n  const activeRuleFirst = (activeReports) => {\n    const reports = [...activeReports];\n    const activeRuleIndex =\n      routerData && typeof routerData.params !== 'undefined'\n        ? activeReports.findIndex(\n            (report) => report.rule.rule_id === routerData.params.id\n          )\n        : -1;\n    const activeReport = reports.splice(activeRuleIndex, 1);\n\n    return activeRuleIndex !== -1\n      ? [activeReport[0], ...reports]\n      : activeReports;\n  };\n\n  const handleOnCollapse = (_e, rowId, isOpen) => {\n    const collapseRows = [...rows];\n    collapseRows[rowId] = { ...collapseRows[rowId], isOpen };\n    setRows(collapseRows);\n  };\n\n  const buildRows = (\n    activeReports,\n    kbaDetails,\n    filters,\n    rows,\n    searchValue = '',\n    kbaLoading = false\n  ) => {\n    const builtRows = activeReports.flatMap((value, key) => {\n      const rule = value.rule;\n      const resolution = value.resolution;\n      const kbaDetail = Object.keys(kbaDetails).length\n        ? kbaDetails.filter((article) => article.id === value.rule.node_id)[0]\n        : {};\n      const entity = rows.filter(\n        (rowVal, rowKey) =>\n          rowKey % 2 === 0 && rowVal.rule.rule_id === rule.rule_id && rowVal\n      );\n      const selected = entity.length ? entity[0].selected : false;\n      const isOpen = rows.length\n        ? entity.length\n          ? entity[0].isOpen\n          : false\n        : key === 0\n        ? true\n        : false;\n      const reportRow = [\n        {\n          rule,\n          resolution,\n          isOpen,\n          selected,\n          cells: [\n            {\n              title: (\n                <div>\n                  {resolution.has_playbook ? (\n                    <input\n                      aria-label=\"select-checkbox\"\n                      type=\"checkbox\"\n                      checked={!!selected}\n                      onChange={(event) => onSelect(event, !selected, rule)}\n                      className=\"pf-c-check\"\n                    />\n                  ) : (\n                    ''\n                  )}\n                </div>\n              ),\n            },\n            { title: <div> {rule.description}</div> },\n            {\n              title: (\n                <div key={key}>\n                  <DateFormat\n                    date={rule.publish_date}\n                    type=\"relative\"\n                    tooltipProps={{ position: TooltipPosition.bottom }}\n                  />\n                </div>\n              ),\n            },\n            {\n              title: (\n                <div key={key} style={{ verticalAlign: 'top' }}>\n                  <Tooltip\n                    key={key}\n                    position={TooltipPosition.bottom}\n                    content={\n                      <span>\n                        The <strong>likelihood</strong> that this will be a\n                        problem is {LIKELIHOOD_LABEL[rule.likelihood]}. The{' '}\n                        <strong>impact</strong> of the problem would be &nbsp;\n                        {IMPACT_LABEL[rule.impact.impact]} if it occurred.\n                      </span>\n                    }\n                  >\n                    <InsightsLabel value={rule.total_risk} />\n                  </Tooltip>\n                </div>\n              ),\n            },\n            {\n              title: (\n                <div className=\"ins-c-center-text\" key={key}>\n                  {resolution.has_playbook ? (\n                    <CheckCircleIcon className=\"successColorOverride\" />\n                  ) : (\n                    'No'\n                  )}\n                </div>\n              ),\n            },\n          ],\n        },\n        {\n          parent: key,\n          fullWidth: true,\n          cells: [\n            {\n              title: (\n                <ReportDetails\n                  key={`child-${key}`}\n                  report={value}\n                  kbaDetail={kbaDetail}\n                  kbaLoading={kbaLoading}\n                />\n              ),\n            },\n          ],\n        },\n      ];\n      const isValidSearchValue =\n        searchValue.length === 0 ||\n        rule.description.toLowerCase().includes(searchValue.toLowerCase());\n      const isValidFilterValue =\n        Object.keys(filters).length === 0 ||\n        Object.keys(filters)\n          .map((key) => {\n            const filterValues = filters[key];\n            const rowValue = {\n              has_playbook: value.resolution.has_playbook,\n              publish_date: rule.publish_date,\n              total_risk: rule.total_risk,\n              category: RULE_CATEGORIES[rule.category.name.toLowerCase()],\n            };\n            return filterValues.find(\n              (value) => String(value) === String(rowValue[key])\n            );\n          })\n          .every((x) => x);\n\n      return isValidSearchValue && isValidFilterValue ? reportRow : [];\n    });\n    //must recalculate parent for expandable table content whenever the array size changes\n    builtRows.forEach((row, index) =>\n      row.parent ? (row.parent = index - 1) : null\n    );\n\n    return builtRows;\n  };\n\n  const onBulkSelect = (isSelected) => {\n    setIsSelected(isSelected);\n    setRows(\n      buildRows(\n        activeReports,\n        kbaDetailsData,\n        filters,\n        rows.map((row, index) =>\n          // We need to use mod 2 here to ignore children with no has_playbook param\n          index % 2 === 0 && row.resolution.has_playbook\n            ? { ...row, selected: isSelected }\n            : row\n        ),\n        searchValue\n      )\n    );\n  };\n\n  const bulkSelect = {\n    items: [\n      {\n        title: 'Select none',\n        onClick: () => onBulkSelect(false),\n      },\n      {\n        title: 'Select all',\n        onClick: () => onBulkSelect(true),\n      },\n    ],\n    count: selectedItemsLength,\n    checked: selectedItemsLength === selectableItemsLength,\n    onSelect: () => onBulkSelect(!isSelected),\n  };\n\n  const buildFilterChips = (filters) => {\n    const prunedFilters = Object.entries(filters);\n    let chips =\n      filters && prunedFilters.length > 0\n        ? prunedFilters.map((item) => {\n            const category = FC[item[0]];\n            const chips = item[1].map((value) => ({\n              name: category.values.find(\n                (values) => values.value === String(value)\n              ).label,\n              value,\n            }));\n            return {\n              category: capitalize(category.title),\n              chips,\n              urlParam: category.urlParam,\n            };\n          })\n        : [];\n    searchValue.length > 0 &&\n      chips.push({\n        category: 'Description',\n        chips: [{ name: searchValue, value: searchValue }],\n      });\n    return chips;\n  };\n\n  const onChipDelete = (_e, itemsToRemove, isAll) => {\n    if (isAll) {\n      setRows(buildRows(activeReports, kbaDetailsData, {}, rows, ''));\n      setFilters({});\n      setSearchValue('');\n    } else {\n      itemsToRemove.map((item) => {\n        if (item.category === 'Description') {\n          setRows(buildRows(activeReports, kbaDetailsData, filters, rows, ''));\n          setSearchValue('');\n        } else {\n          onFilterChange(\n            item.urlParam,\n            filters[item.urlParam].filter(\n              (value) => String(value) !== String(item.chips[0].value)\n            )\n          );\n        }\n      });\n    }\n  };\n\n  const activeFiltersConfig = {\n    deleteTitle: intl.formatMessage(messages.resetFilters),\n    filters: buildFilterChips(filters),\n    onDelete: onChipDelete,\n  };\n\n  const fetchKbaDetails = async (reportsData) => {\n    const kbaIds = reportsData.map(({ rule }) => rule.node_id).filter((x) => x);\n    try {\n      const kbaDetailsFetch = (\n        await API.get(\n          `https://access.redhat.com/hydra/rest/search/kcs?q=id:(${kbaIds.join(\n            ` OR `\n          )})&fl=view_uri,id,publishedTitle&rows=${\n            kbaIds.length\n          }&redhat_client=$ADVISOR`,\n          {},\n          { credentials: 'include' }\n        )\n      ).data.response.docs;\n\n      setKbaDetailsData(kbaDetailsFetch);\n      setRows(\n        buildRows(reportsData, kbaDetailsFetch, filters, rows, searchValue)\n      );\n    } catch (error) {\n      console.error(error, 'KBA fetch failed.');\n    }\n  };\n\n  const onSort = (_e, index, direction) => {\n    const sortedReports = {\n      2: 'description',\n      3: 'publish_date',\n      4: 'total_risk',\n      5: 'has_playbook',\n    };\n    const key = index === 5 ? 'resolution' : 'rule';\n    const sort = (key) =>\n      activeReports\n        .concat()\n        .sort((firstItem, secondItem) =>\n          firstItem[key][sortedReports[index]] >\n          secondItem[key][sortedReports[index]]\n            ? 1\n            : secondItem[key][sortedReports[index]] >\n              firstItem[key][sortedReports[index]]\n            ? -1\n            : 0\n        );\n    const sortedReportsDirectional =\n      direction === SortByDirection.asc ? sort(key) : sort(key).reverse();\n\n    setActiveReports(sortedReportsDirectional);\n    setSortBy({\n      index,\n      direction,\n    });\n    setRows(\n      buildRows(\n        sortedReportsDirectional,\n        kbaDetailsData,\n        filters,\n        rows,\n        searchValue\n      )\n    );\n  };\n\n  const onFilterChange = (param, values) => {\n    const removeFilterParam = (param) => {\n      const filter = { ...filters };\n      delete filter[param];\n      return filter;\n    };\n\n    const newFilters =\n      values.length > 0\n        ? { ...filters, ...{ [param]: values } }\n        : removeFilterParam(param);\n    setRows(\n      buildRows(activeReports, kbaDetailsData, newFilters, rows, searchValue)\n    );\n    setFilters(newFilters);\n  };\n\n  const onInputChange = (value) => {\n    const builtRows = buildRows(\n      activeReports,\n      kbaDetailsData,\n      filters,\n      rows,\n      value\n    );\n    setSearchValue(value);\n    setRows(builtRows);\n  };\n\n  const onSelect = (_e, isSelected, rule) => {\n    setRows(\n      buildRows(\n        activeReports,\n        kbaDetailsData,\n        filters,\n        rows.map((oneRow) =>\n          oneRow.rule && oneRow.rule.rule_id === rule.rule_id\n            ? { ...oneRow, selected: isSelected }\n            : { ...oneRow }\n        ),\n        searchValue\n      )\n    );\n  };\n\n  const processRemediation = (selectedAnsibleRules) => {\n    const playbookRows = selectedAnsibleRules.filter(\n      (r) => r.resolution && r.resolution.has_playbook\n    );\n    const issues = playbookRows.map((r) => ({\n      id: `advisor:${r.rule.rule_id}`,\n      description: r.rule.description,\n    }));\n    return issues.length ? { issues, systems: [entity.id] } : false;\n  };\n\n  const filterConfigItems = [\n    {\n      label: 'description',\n      filterValues: {\n        key: 'text-filter',\n        onChange: (_e, value) => onInputChange(value),\n        value: searchValue,\n      },\n    },\n    {\n      label: FC.total_risk.title,\n      type: FC.total_risk.type,\n      id: FC.total_risk.urlParam,\n      value: `checkbox-${FC.total_risk.urlParam}`,\n      filterValues: {\n        key: `${FC.total_risk.urlParam}-filter`,\n        onChange: (_e, values) =>\n          onFilterChange(FC.total_risk.urlParam, values),\n        value: filters.total_risk,\n        items: FC.total_risk.values,\n      },\n    },\n    {\n      label: FC.category.title,\n      type: FC.category.type,\n      id: FC.category.urlParam,\n      value: `checkbox-${FC.category.urlParam}`,\n      filterValues: {\n        key: `${FC.category.urlParam}-filter`,\n        onChange: (_e, values) => onFilterChange(FC.category.urlParam, values),\n        value: filters.category,\n        items: FC.category.values,\n      },\n    },\n    {\n      label: FC.has_playbook.title,\n      type: FC.has_playbook.type,\n      id: FC.has_playbook.urlParam,\n      value: `checkbox-${FC.has_playbook.urlParam}`,\n      filterValues: {\n        key: `${FC.has_playbook.urlParam}-filter`,\n        onChange: (_e, values) =>\n          onFilterChange(FC.has_playbook.urlParam, values),\n        value: filters.has_playbook,\n        items: FC.has_playbook.values,\n      },\n    },\n  ];\n\n  useEffect(() => {\n    const dataFetch = async () => {\n      try {\n        const [settingsFetch, reportsFetch] = await Promise.all([\n          (\n            await API.get(`${BASE_URL}/account_setting/`, {\n              credentials: 'include',\n            })\n          ).data,\n          (\n            await API.get(`${BASE_URL}/system/${entity.id}/reports/`, {\n              credentials: 'include',\n            })\n          ).data,\n        ]);\n\n        const activeRuleFirstReportsData = activeRuleFirst(reportsFetch);\n        fetchKbaDetails(activeRuleFirstReportsData);\n        setRows(\n          buildRows(\n            activeRuleFirstReportsData,\n            {},\n            filters,\n            rows,\n            searchValue,\n            true\n          )\n        );\n        setInventoryReportFetchStatus('fulfilled');\n        setActiveReports(activeRuleFirstReportsData);\n        setAccountSettings(settingsFetch);\n      } catch (error) {\n        setInventoryReportFetchStatus('failed');\n      }\n    };\n    dataFetch();\n  }, []);\n\n  return (\n    <div className=\"ins-c-inventory-insights__overrides\">\n      {inventoryReportFetchStatus === 'pending' ||\n      (inventoryReportFetchStatus === 'fulfilled' &&\n        hideResultsSatelliteManaged) ||\n      entity.insights_id === null ? (\n        <Fragment />\n      ) : (\n        <PrimaryToolbar\n          actionsConfig={{ actions }}\n          bulkSelect={bulkSelect}\n          filterConfig={{ items: filterConfigItems }}\n          pagination={\n            <React.Fragment>\n              {' '}\n              {results === 1\n                ? `${results} Recommendation`\n                : `${results} Recommendations`}{' '}\n            </React.Fragment>\n          }\n          activeFiltersConfig={activeFiltersConfig}\n        />\n      )}\n      {inventoryReportFetchStatus === 'pending' && (\n        <Card>\n          <CardBody>\n            <List />\n          </CardBody>\n        </Card>\n      )}\n      {inventoryReportFetchStatus === 'fulfilled' &&\n        (hideResultsSatelliteManaged ? (\n          <MessageState\n            icon={PficonSatelliteIcon}\n            title=\"Satellite managed system\"\n            text={\n              <span key=\"satellite managed system\">\n                Insights results can not be displayed for this host, as the\n                &quot;Hide Satellite Managed Systems&quot; setting has been\n                enabled by an org admin.\n                <br />\n                For more information on this setting and how to modify it,\n                <a\n                  href=\"https://access.redhat.com/solutions/4281761\"\n                  rel=\"noopener\"\n                >\n                  {' '}\n                  Please visit this Knowledgebase article &nbsp;\n                  <ExternalLinkAltIcon />\n                </a>\n                .\n              </span>\n            }\n          />\n        ) : activeReports.length > 0 ? (\n          <Fragment>\n            <Table\n              aria-label={'rule-table'}\n              onCollapse={handleOnCollapse}\n              rows={rows}\n              cells={cols}\n              sortBy={sortBy}\n              canSelectAll={false}\n              onSort={onSort}\n              isStickyHeader\n            >\n              <TableHeader />\n              <TableBody />\n            </Table>\n            {results === 0 && (\n              <Card>\n                <CardBody>\n                  <MessageState\n                    title=\"No matching recommendations found\"\n                    text={`This filter criteria matches no recommendations. Try changing your filter settings.`}\n                  />\n                </CardBody>\n              </Card>\n            )}\n          </Fragment>\n        ) : entity.insights_id !== null ? (\n          <Card>\n            <CardBody>\n              <MessageState\n                icon={CheckIcon}\n                iconClass=\"ins-c-insights__check\"\n                title=\"No recommendations\"\n                text={`No known recommendations affect this system`}\n              />\n            </CardBody>\n          </Card>\n        ) : (\n          <MessageState\n            iconClass=\"chartSpikeIconColor\"\n            icon={ChartSpikeIcon}\n            title=\"Get started with Red Hat Insights\"\n            text={\n              <Bullseye>\n                <Stack hasGutter>\n                  <StackItem>\n                    1. Install the client on the RHEL system.\n                    <ClipboardCopy>yum install insights-client</ClipboardCopy>\n                  </StackItem>\n                  <StackItem>\n                    2. Register the system to Red Hat Insights.\n                    <ClipboardCopy>insights-client --register</ClipboardCopy>\n                  </StackItem>\n                </Stack>\n              </Bullseye>\n            }\n          >\n            <Button\n              component=\"a\"\n              href=\"https://access.redhat.com/products/red-hat-insights#getstarted\"\n              target=\"_blank\"\n              variant=\"primary\"\n            >\n              Getting started documentation\n            </Button>\n          </MessageState>\n        ))}\n      {inventoryReportFetchStatus === 'failed' && entity && (\n        <MessageState\n          icon={TimesCircleIcon}\n          title=\"Error getting recommendations\"\n          text={\n            entity\n              ? `There was an error fetching recommendations for this entity. Refresh your page to try again.`\n              : `This entity can not be found or might no longer be registered to Red Hat Insights.`\n          }\n        />\n      )}\n    </div>\n  );\n};\n\nconst SystemAdvisor = ({ customItnl, intlProps, ...props }) => {\n  const Wrapper = customItnl ? IntlProvider : Fragment;\n  return (\n    <Wrapper\n      {...(customItnl && {\n        locale: navigator.language.slice(0, 2),\n        messages,\n        onError: console.log,\n        ...intlProps,\n      })}\n    >\n      <BaseSystemAdvisor {...props} />\n    </Wrapper>\n  );\n};\n\nexport default SystemAdvisor;\n\nSystemAdvisor.propTypes = {\n  customItnl: PropTypes.bool,\n  intlProps: PropTypes.shape({\n    locale: PropTypes.string,\n    messages: PropTypes.array,\n    onError: PropTypes.func,\n  }),\n};\n"],"sourceRoot":""}