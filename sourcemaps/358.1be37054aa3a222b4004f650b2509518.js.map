{"version":3,"file":"js/358.d18478c0476b2a6aec01.js","mappings":"wWAiBMA,EAAe,SAAC,GAAsD,IAApDC,EAAoD,EAApDA,kBAAmBC,EAAiC,EAAjCA,YAAaC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QACtDC,GAAOC,EAAAA,EAAAA,KACPC,GAAWC,EAAAA,EAAAA,eAEXC,EAAU,CACdJ,EAAKK,cAAcC,EAAAA,EAAAA,YACnBN,EAAKK,cAAcC,EAAAA,EAAAA,mBACnBN,EAAKK,cAAcC,EAAAA,EAAAA,cACnB,IAEF,GAAwBC,EAAAA,EAAAA,UAAS,IAAjC,eAAOC,EAAP,KAAaC,EAAb,KACA,GAA8BF,EAAAA,EAAAA,WAAS,GAAvC,eAAOG,EAAP,KAAgBC,EAAhB,KACA,GAKIC,EAAAA,EAAAA,IAAoB,CACtBC,QAASf,EAAKe,QACdC,MAAOhB,EAAKiB,oBAPd,IACEC,KAAMC,OADR,MACmB,GADnB,EAEEC,EAFF,EAEEA,WACAC,EAHF,EAGEA,UACAC,EAJF,EAIEA,QAKIC,EAAS,mCAAG,WAAOC,GAAP,2FAERC,EAAAA,EAAAA,IAAU,GAAD,OAAIC,EAAAA,GAAJ,oBAAwBF,EAAKG,GAA7B,MAFD,OAGdL,IACAT,GAAW,GAJG,gDAMdf,GAAkB,GAxBGoB,EAyBL,CACdU,QAAS,SACTC,aAAa,EACbC,MAAO5B,EAAKK,cAAcC,EAAAA,EAAAA,OAC1BuB,YAAa,GAAF,cA7BiB3B,GAAS4B,EAAAA,EAAAA,IAAad,IAkBtC,kCAlBM,IAACA,IAkBP,oBAAH,sDAmDf,OAnCAe,EAAAA,EAAAA,YAAU,WACR,IAAMvB,EAAOS,MAAAA,OAAH,EAAGA,EAAUe,KAAI,SAACC,GAAD,MAAW,CACpCC,MAAO,CACLD,EAAKE,cAAgBF,EAAKG,YAC1BH,EAAKI,eAAiBrC,EAAKK,cAAcC,EAAAA,EAAAA,MACzC,CACEsB,MACE,kBAAC,IAAD,CAAYU,KAAM,IAAIC,KAAKN,EAAKO,YAAaC,KAAK,cAGtD,CACEb,MACE,kBAAC,EAAAc,OAAD,CACEC,IAAKV,EAAKG,YACVQ,UAAQ,EACRlB,QAAQ,OACRmB,QAAS,kBAAMxB,EAAUY,KAEzB,kBAAC,KAAD,CAAkBa,KAAK,OANzB,WAOO9C,EAAKK,cAAcC,EAAAA,EAAAA,gBAO7Ba,GAAiC,IAApBF,EAAS8B,SACzBhD,IACAH,GAAkB,IAGpBa,EAAQD,KAEP,CAACS,IAGF,kBAAC,KAAD,CACE+B,MAAO,MACPpB,MAAO5B,EAAKK,cAAcC,EAAAA,EAAAA,mBAC1B2C,OAAQpD,EACRqD,QAAS,WACPxC,GAAWX,IACXH,GAAkB,KAGlBsB,EAMA,kBAAC,EAAAiC,MAAD,CACEC,aAAW,iBACX5C,KAAM,CACJ,CACE0B,MAAO,CAAC,CAAEmB,MAAO,CAAEC,QAAS,GAAK1B,MAAO,kBAAC,KAAD,UAG5CM,MAAO9B,GAEP,kBAAC,EAAAmD,YAAD,MACA,kBAAC,EAAAC,UAAD,OAfF,kBAAC,EAAAL,MAAD,CAAOC,aAAW,iBAAiB5C,KAAMA,EAAM0B,MAAO9B,GACpD,kBAAC,EAAAmD,YAAD,MACA,kBAAC,EAAAC,UAAD,SAoBV7D,EAAa8D,UAAY,CACvB5D,YAAa6D,IAAAA,KACb9D,kBAAmB8D,IAAAA,KACnB5D,KAAM4D,IAAAA,OACN3D,QAAS2D,IAAAA,MAGX/D,EAAagE,aAAe,CAC1B9D,aAAa,EACbD,kBAAmB,aACnBE,KAAM,GACNC,QAAS,cAGX","sources":["webpack:///./src/PresentationalComponents/Modals/ViewHostAcks.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Table, TableBody, TableHeader } from '@patternfly/react-table';\n\nimport { BASE_URL } from '../../AppConstants';\nimport { Button } from '@patternfly/react-core/dist/js/components/Button/Button';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { DeleteApi } from '../../Utilities/Api';\nimport { List } from 'react-content-loader';\nimport { Modal } from '@patternfly/react-core/dist/js/components/Modal/Modal';\nimport OutlinedBellIcon from '@patternfly/react-icons/dist/js/icons/outlined-bell-icon';\nimport PropTypes from 'prop-types';\nimport messages from '../../Messages';\nimport { addNotification as notification } from '@redhat-cloud-services/frontend-components-notifications/';\nimport { useDispatch } from 'react-redux';\nimport { useGetHostAcksQuery } from '../../Services/Acks';\nimport { useIntl } from 'react-intl';\n\nconst ViewHostAcks = ({ handleModalToggle, isModalOpen, rule, afterFn }) => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n  const addNotification = (data) => dispatch(notification(data));\n  const columns = [\n    intl.formatMessage(messages.systemName),\n    intl.formatMessage(messages.justificationNote),\n    intl.formatMessage(messages.dateDisabled),\n    '',\n  ];\n  const [rows, setRows] = useState([]);\n  const [unclean, setUnclean] = useState(false);\n  const {\n    data: hostAcks = [],\n    isFetching,\n    isLoading,\n    refetch,\n  } = useGetHostAcksQuery({\n    rule_id: rule.rule_id,\n    limit: rule.hosts_acked_count,\n  });\n  const deleteAck = async (host) => {\n    try {\n      await DeleteApi(`${BASE_URL}/hostack/${host.id}/`);\n      refetch();\n      setUnclean(true);\n    } catch (error) {\n      handleModalToggle(false);\n      addNotification({\n        variant: 'danger',\n        dismissable: true,\n        title: intl.formatMessage(messages.error),\n        description: `${error}`,\n      });\n    }\n  };\n\n  useEffect(() => {\n    const rows = hostAcks?.map((item) => ({\n      cells: [\n        item.display_name || item.system_uuid,\n        item.justification || intl.formatMessage(messages.none),\n        {\n          title: (\n            <DateFormat date={new Date(item.updated_at)} type=\"onlyDate\" />\n          ),\n        },\n        {\n          title: (\n            <Button\n              key={item.system_uuid}\n              isInline\n              variant=\"link\"\n              onClick={() => deleteAck(item)}\n            >\n              <OutlinedBellIcon size=\"sm\" />\n              {` ${intl.formatMessage(messages.enable)}`}\n            </Button>\n          ),\n        },\n      ],\n    }));\n\n    if (!isLoading && hostAcks.length === 0) {\n      afterFn();\n      handleModalToggle(false);\n    }\n\n    setRows(rows);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [hostAcks]);\n\n  return (\n    <Modal\n      width={'75%'}\n      title={intl.formatMessage(messages.hostAckModalTitle)}\n      isOpen={isModalOpen}\n      onClose={() => {\n        unclean && afterFn();\n        handleModalToggle(false);\n      }}\n    >\n      {!isFetching ? (\n        <Table aria-label=\"host-ack-table\" rows={rows} cells={columns}>\n          <TableHeader />\n          <TableBody />\n        </Table>\n      ) : (\n        <Table\n          aria-label=\"host-ack-table\"\n          rows={[\n            {\n              cells: [{ props: { colSpan: 3 }, title: <List /> }],\n            },\n          ]}\n          cells={columns}\n        >\n          <TableHeader />\n          <TableBody />\n        </Table>\n      )}\n    </Modal>\n  );\n};\n\nViewHostAcks.propTypes = {\n  isModalOpen: PropTypes.bool,\n  handleModalToggle: PropTypes.func,\n  rule: PropTypes.object,\n  afterFn: PropTypes.func,\n};\n\nViewHostAcks.defaultProps = {\n  isModalOpen: false,\n  handleModalToggle: () => undefined,\n  rule: {},\n  afterFn: () => undefined,\n};\n\nexport default ViewHostAcks;\n"],"names":["ViewHostAcks","handleModalToggle","isModalOpen","rule","afterFn","intl","useIntl","dispatch","useDispatch","columns","formatMessage","messages","useState","rows","setRows","unclean","setUnclean","useGetHostAcksQuery","rule_id","limit","hosts_acked_count","data","hostAcks","isFetching","isLoading","refetch","deleteAck","host","DeleteApi","BASE_URL","id","variant","dismissable","title","description","notification","useEffect","map","item","cells","display_name","system_uuid","justification","date","Date","updated_at","type","Button","key","isInline","onClick","size","length","width","isOpen","onClose","Table","aria-label","props","colSpan","TableHeader","TableBody","propTypes","PropTypes","defaultProps"],"sourceRoot":""}