{"version":3,"sources":["webpack://advisor-frontend/./src/SmartComponents/Common/ClassicRedirect.js"],"names":["useState","fetchStatus","setFetchStatus","redirect","setRedirect","intl","useIntl","dispatch","useDispatch","getData","pathname","patharray","split","start","some","val","Error","formatMessage","messages","useEffect","window","location","classicId","redirectBase","Api","inventoryId","data","results","id","addNotification","variant","dismissable","title","description","Redirect","to","icon","TimesCircleIcon"],"mappings":"0UAuDA,QA3CwB,WAAM,OACYA,cAAS,WADrB,WACnBC,EADmB,KACNC,EADM,QAEMF,gBAFN,WAEnBG,EAFmB,KAETC,EAFS,KAGpBC,GAAOC,SACPC,GAAWC,mBAEXC,EAAU,SAACC,GACb,IAAMC,EAAYD,EAASE,MAAM,KAC3BC,EAAQF,EAAUG,MAAK,SAAAC,GAAG,MAAY,SAARA,KAAkB,EAAI,EAC1D,OAAQJ,aAAR,EAAQA,EAAY,IAChB,IAAK,UACD,MAAO,CAACA,aAAD,EAACA,EAAYE,GAAb,YACX,IAAK,kBACD,MAAO,CAACF,aAAD,EAACA,EAAYE,EAAQ,GAArB,2BAA6CF,aAA7C,EAA6CA,EAAYE,KACpE,QACI,MAAM,IAAIG,MAAMX,EAAKY,cAAcC,wBAoB/C,OAhBAC,gBAAU,WACN,cAAC,8GAEyCV,EAAQW,OAAOC,SAASX,UAFjE,WAEcY,EAFd,KAEyBC,EAFzB,cAGkCC,QAAA,8CAA+CF,IAHjF,OAGaG,EAHb,OAG+FC,KAAKC,QAAQ,GAAGC,GACxGxB,EAAY,GAAD,OAAImB,EAAJ,YAAoBE,IAC/BvB,EAAe,aALtB,gDAOOK,GAASsB,qBAAgB,CACrBC,QAAS,SAAUC,aAAa,EAAMC,MAAO3B,EAAKY,cAAcC,WAAiBe,YAAa,GAAF,gBAChG/B,EAAe,YATtB,wDAAD,KAaD,CAACE,EAAaF,EAAgBG,EAAME,IAEhC,kBAAC,aAAD,KACc,YAAhBN,GAA6B,kBAAC,IAAD,MACb,cAAhBA,GAA+B,kBAAC,EAAAiC,SAAD,CAAUC,GAAIhC,IAC7B,aAAhBF,GAA8B,kBAAC,IAAD,CAC3BmC,KAAMC,KAAiBL,MAAO3B,EAAKY,cAAcC","file":"js/ClassicRedirect.178ce61b0113e79f24cd.js","sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport Api from '../../Utilities/Api';\nimport Loading from '../../PresentationalComponents/Loading/Loading';\nimport MessageState from '../../PresentationalComponents/MessageState/MessageState';\nimport { Redirect } from 'react-router-dom';\nimport TimesCircleIcon from '@patternfly/react-icons/dist/js/icons/times-circle-icon';\nimport { addNotification } from '@redhat-cloud-services/frontend-components-notifications';\nimport messages from '../../Messages';\nimport { useDispatch } from 'react-redux';\nimport { useIntl } from 'react-intl';\n\nconst ClassicRedirect = () => {\n    const [fetchStatus, setFetchStatus] = useState('pending');\n    const [redirect, setRedirect] = useState();\n    const intl = useIntl();\n    const dispatch = useDispatch();\n\n    const getData = (pathname) => {\n        const patharray = pathname.split('/');\n        const start = patharray.some(val => val === 'beta') ? 6 : 5;\n        switch (patharray?.[3]) {\n            case 'systems':\n                return [patharray?.[start], `/systems`];\n            case 'recommendations':\n                return [patharray?.[start + 1], `/recommendations/${patharray?.[start]}`];\n            default:\n                throw new Error(intl.formatMessage(messages.invalidPathname));\n        }\n    };\n\n    useEffect(() => {\n        (async () => {\n            try {\n                const [classicId, redirectBase] = getData(window.location.pathname);\n                const inventoryId = (await Api.get(`/api/inventory/v1/hosts?insights_id=${classicId}`)).data.results[0].id;\n                setRedirect(`${redirectBase}/${inventoryId}`);\n                setFetchStatus('fulfilled');\n            } catch (error) {\n                dispatch(addNotification({\n                    variant: 'danger', dismissable: true, title: intl.formatMessage(messages.error), description: `${error}` }));\n                setFetchStatus('rejected');\n            }\n        })();\n    //eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [setRedirect, setFetchStatus, intl, dispatch]);\n\n    return <React.Fragment>\n        {fetchStatus === 'pending' && <Loading/>}\n        {fetchStatus === 'fulfilled' && <Redirect to={redirect}/>}\n        {fetchStatus === 'rejected' && <MessageState\n            icon={TimesCircleIcon} title={intl.formatMessage(messages.inventoryIdNotFound)}/>}\n    </React.Fragment>;\n};\n\nexport default ClassicRedirect;\n"],"sourceRoot":""}