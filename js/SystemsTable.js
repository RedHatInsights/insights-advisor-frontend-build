(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1003:function(e,t,a){"use strict";a.r(t);var n=a(178),s=a.n(n),r=a(270),o=a.n(r),i=a(467),c=a(333),l=a(65),f=a(2),u=a.n(f),m=a(322),b=a(326),y=a(48),p=a(335),d=a(332),O=a(560),g=a(482),j=a(107),S=a(473),v=a(474),h=a(1),E=a.n(h),w=a(117),P=a(90),_=a(106),M=a(561),F=a(32),k=a(22),C=a(466),D=a.n(C),T=a(271),N=a.n(T);function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var H=function(e){var t=e.systemsFetchStatus,a=e.fetchSystems,n=e.systems,s=e.intl,r=e.filters,i=e.setFilters,h=e.history,E=Object(f.useState)([{title:s.formatMessage(k.a.name),transforms:[m.a]},{title:s.formatMessage(k.a.numberRuleHits),transforms:[m.a,Object(b.a)(15)]},{title:s.formatMessage(k.a.lastSeen),transforms:[m.a]}]),P=o()(E,1)[0],_=Object(f.useState)([]),F=o()(_,2),C=F[0],T=F[1],N=Object(f.useState)({}),x=o()(N,2),H=x[0],L=x[1],B=Object(f.useState)(10),J=o()(B,2),I=J[0],R=J[1],V=Object(f.useState)(0),q=o()(V,2),z=q[0],G=q[1],K=n.meta?n.meta.count:0,Q=Object(f.useState)(r.display_name||""),U=o()(Q,2),W=U[0],X=U[1],Y=Object(M.a)(W,800),Z=Object(f.useState)(!0),$=o()(Z,2),ee=$[0],te=$[1],ae={0:"display_name",1:"hits",2:"last_seen"},ne=function(e){G(e*I-I)};Object(f.useEffect)((function(){void 0===r.display_name?X(""):X(r.display_name)}),[r.display_name]),Object(f.useEffect)((function(){var e=A({},r),t=W.length?{display_name:W}:{};delete e.display_name,i(A({},e,{},t))}),[Y]),Object(f.useEffect)((function(){if(h.location.search){var e=Object(O.b)(h);void 0!==e.sort&&(e.sort=e.sort[0]),void 0!==e.display_name&&(e.display_name=e.display_name[0]),i(A({},e)),te(!1)}}),[]),Object(f.useEffect)((function(){Object(O.c)(r,h)}),[r,h]),Object(f.useEffect)((function(){if(void 0!==r.sort){var e=Number(Object.entries(ae).find((function(e){return e[1]===r.sort||"-".concat(e[1])===r.sort}))[0]),t="-"===r.sort[0]?"desc":"asc";L({index:e,direction:t})}}),[r.sort]),Object(f.useEffect)((function(){ee||a(A({offset:z,limit:I},r))}),[a,I,z,r,ee]),Object(f.useEffect)((function(){if(n.data)if(n.meta.count){var e=n.data.flatMap((function(e,t){return[{isOpen:!1,system:e,cells:[{title:u.a.createElement(j.Link,{key:t,to:"/rules/systems/".concat(e.system_uuid)},e.display_name)},{title:u.a.createElement("div",{key:t}," ",e.hits)},{title:u.a.createElement("div",{key:t},D()(e.last_seen).fromNow())}]}]}));T(e.asMutable())}else T([{cells:[{title:u.a.createElement(v.a,{icon:w.b,title:s.formatMessage(k.a.noHitsTitle,{item:s.formatMessage(k.a.systems).toLowerCase()}),text:s.formatMessage(k.a.noHitsBody,{item:s.formatMessage(k.a.systems).toLowerCase()})}),props:{colSpan:5}}]}])}),[s,n]);var se=[{label:s.formatMessage(k.a.name),filterValues:{key:"text-filter",onChange:function(e,t){return X(t)},value:W}}],re={filters:W.length>0&&[{category:"Description",chips:[{name:W}]}]||[],onDelete:function(){return X("")}};return u.a.createElement(u.a.Fragment,null,u.a.createElement(l.PrimaryToolbar,{pagination:{itemCount:K,page:z/I+1,perPage:I,onSetPage:function(e,t){ne(t)},onPerPageSelect:function(e,t){R(t)},isCompact:!1},filterConfig:{items:se},activeFiltersConfig:re}),"fulfilled"===t&&u.a.createElement(y.b,{"aria-label":"rule-table",sortBy:H,onSort:function(e,t,a){var n="".concat("asc"===a?"":"-").concat(ae[t]);L({index:t,direction:a}),i(A({},r,{sort:n})),G(0)},cells:P,rows:C},u.a.createElement(p.a,null),u.a.createElement(d.a,null)),"pending"===t&&u.a.createElement(S.a,null),"failed"===t&&u.a.createElement(g.a,{message:s.formatMessage(k.a.systemTableFetchError)}),u.a.createElement(l.TableToolbar,null,u.a.createElement(c.a,{itemCount:K,perPage:I,page:z/I+1,onSetPage:function(e,t){ne(t)},widgetId:"pagination-options-menu-bottom",variant:c.b.bottom})))};H.propTypes={fetchSystems:E.a.func,systemsFetchStatus:E.a.string,systems:E.a.object,addNotification:E.a.func,history:E.a.object,intl:E.a.any,filters:E.a.object,setFilters:E.a.func};t.default=Object(F.c)(N()(Object(_.connect)((function(e,t){return A({systems:e.AdvisorStore.systems,systemsFetchStatus:e.AdvisorStore.systemsFetchStatus,filters:e.AdvisorStore.filtersSystems},t)}),(function(e){return{fetchSystems:function(t){return e(i.h(t))},addNotification:function(t){return e(Object(P.addNotification)(t))},setFilters:function(t){return e(i.n(t))}}}))(H)))}}]);
//# sourceMappingURL=SystemsTable.js.map