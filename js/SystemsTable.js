(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1103:function(e,t,a){"use strict";a.r(t);var n=a(159),s=a.n(n),r=a(264),i=a.n(r),o=a(537),c=a(271),l=a(1),f=a.n(l),u=a(303),m=a(304),b=a(52),y=a(313),p=a(312),d=a(806),O=a(566),g=a(106),j=a(553),S=a(554),v=a(637),h=a(0),E=a.n(h),w=a(163),P=a.n(w),_=a(638),M=a(107),F=a(92),k=a(807),C=a(29),D=a(19),T=a(533),N=a.n(T),x=a(265),A=a.n(x);function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var B=function(e){var t=e.systemsFetchStatus,a=e.fetchSystems,n=e.systems,s=e.intl,r=e.filters,o=e.setFilters,h=e.history,E=Object(l.useState)([{title:s.formatMessage(D.a.name),transforms:[u.a]},{title:s.formatMessage(D.a.numberRuleHits),transforms:[u.a,Object(m.a)(15)]},{title:s.formatMessage(D.a.lastSeen),transforms:[u.a]}]),w=i()(E,1)[0],M=Object(l.useState)([]),F=i()(M,2),C=F[0],T=F[1],x=Object(l.useState)({}),A=i()(x,2),H=A[0],B=A[1],J=Object(l.useState)(10),V=i()(J,2),I=V[0],R=V[1],q=Object(l.useState)(0),z=i()(q,2),G=z[0],K=z[1],Q=n.meta?n.meta.count:0,U=Object(l.useState)(r.display_name||""),W=i()(U,2),X=W[0],Y=W[1],Z=Object(k.a)(X,800),$=Object(l.useState)(!0),ee=i()($,2),te=ee[0],ae=ee[1],ne={0:"display_name",1:"hits",2:"last_seen"},se=function(e){K(e*I-I)};Object(l.useEffect)((function(){void 0===r.display_name?Y(""):Y(r.display_name)}),[r.display_name]),Object(l.useEffect)((function(){var e=L({},r),t=X.length?{display_name:X}:{};delete e.display_name,o(L({},e,{},t))}),[Z]),Object(l.useEffect)((function(){if(h.location.search){var e=Object(d.b)(h);void 0!==e.sort&&(e.sort=e.sort[0]),void 0!==e.display_name&&(e.display_name=e.display_name[0]),o(L({},e))}ae(!1)}),[]),Object(l.useEffect)((function(){Object(d.c)(r,h)}),[r,h]),Object(l.useEffect)((function(){if(void 0!==r.sort){var e=Number(Object.entries(ne).find((function(e){return e[1]===r.sort||"-".concat(e[1])===r.sort}))[0]),t="-"===r.sort[0]?"desc":"asc";B({index:e,direction:t})}}),[r.sort]),Object(l.useEffect)((function(){te||a(L({offset:G,limit:I},r))}),[a,I,G,r,te]),Object(l.useEffect)((function(){if(n.data)if(n.meta.count){var e=n.data.flatMap((function(e,t){return[{isOpen:!1,system:e,cells:[{title:f.a.createElement(g.Link,{key:t,to:"/rules/systems/".concat(e.system_uuid)},e.display_name)},{title:f.a.createElement("div",{key:t}," ",e.hits)},{title:f.a.createElement("div",{key:t},N()(e.last_seen).fromNow())}]}]}));T(e.asMutable())}else T([{cells:[{title:f.a.createElement(S.a,{icon:P.a,title:s.formatMessage(D.a.noHitsTitle,{item:s.formatMessage(D.a.systems).toLowerCase()}),text:s.formatMessage(D.a.noHitsBody,{item:s.formatMessage(D.a.systems).toLowerCase()})}),props:{colSpan:5}}]}])}),[s,n]);var re=[{label:s.formatMessage(D.a.name),filterValues:{key:"text-filter",onChange:function(e,t){return Y(t)},value:X}}],ie={filters:X.length>0&&[{category:"Description",chips:[{name:X}]}]||[],onDelete:function(){return Y("")}};return f.a.createElement(f.a.Fragment,null,f.a.createElement(v.PrimaryToolbar,{pagination:{itemCount:Q,page:G/I+1,perPage:I,onSetPage:function(e,t){se(t)},onPerPageSelect:function(e,t){R(t)},isCompact:!1},filterConfig:{items:re},activeFiltersConfig:ie}),"fulfilled"===t&&f.a.createElement(b.b,{"aria-label":"rule-table",sortBy:H,onSort:function(e,t,a){var n="".concat("asc"===a?"":"-").concat(ne[t]);B({index:t,direction:a}),o(L({},r,{sort:n})),K(0)},cells:w,rows:C},f.a.createElement(y.a,null),f.a.createElement(p.a,null)),"pending"===t&&f.a.createElement(j.a,null),"failed"===t&&f.a.createElement(O.a,{message:s.formatMessage(D.a.systemTableFetchError)}),f.a.createElement(_.TableToolbar,null,f.a.createElement(c.Pagination,{itemCount:Q,perPage:I,page:G/I+1,onSetPage:function(e,t){se(t)},widgetId:"pagination-options-menu-bottom",variant:c.PaginationVariant.bottom})))};B.propTypes={fetchSystems:E.a.func,systemsFetchStatus:E.a.string,systems:E.a.object,addNotification:E.a.func,history:E.a.object,intl:E.a.any,filters:E.a.object,setFilters:E.a.func};t.default=Object(C.c)(A()(Object(F.connect)((function(e,t){return L({systems:e.AdvisorStore.systems,systemsFetchStatus:e.AdvisorStore.systemsFetchStatus,filters:e.AdvisorStore.filtersSystems},t)}),(function(e){return{fetchSystems:function(t){return e(o.h(t))},addNotification:function(t){return e(Object(M.addNotification)(t))},setFilters:function(t){return e(o.n(t))}}}))(B)))}}]);
//# sourceMappingURL=SystemsTable.js.map