(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[1177],{52202:(e,t,n)=>{"use strict";n.d(t,{k:()=>v,b:()=>y});var a=n(66197),r=n(16545),c=n(82644),s=n(29558),o=n(91290),l=n(26076),i=n(93264),u=n.n(i),m=n(41580),f=n(30893),d=n(28186),p=(0,c.Sn)(),b=navigator.language.slice(0,2),g=(0,s.d)({locale:b},p),v=function(e){return u().createElement("span",{className:"adv-system-reboot-message"},u().createElement(l.ZP,{className:e?"adv-c-icon-reboot-required":"adv-c-icon-no-reboot-required"}),u().createElement(a.TextContent,{className:"adv-c-text-system-reboot-message pf-u-font-size-sm"},u().createElement(a.Text,{component:a.TextVariants.p},g.formatMessage(f.Z.systemReboot,{strong:function(e){return(0,d.fK)(e)},status:e?g.formatMessage(f.Z.is):g.formatMessage(f.Z.isNot)}))))},y=function(e){return u().createElement(r.u,{key:e,position:r.D.right,content:u().createElement("div",null,e)},u().createElement("span",{"aria-label":"Action"},u().createElement(o.ZP,{color:m.global_secondary_color_100.value})))}},58921:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var a=n(4942),r=n(15861),c=n(87757),s=n.n(c),o=n(53446),l=n(35240),i=n(59303),u=n(71094),m=n(97109);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(e){var t={date:(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc"};return"Insights-Advisor_".concat(e,"--").concat(t.date)};const b=function(){var e=(0,r.Z)(s().mark((function e(t,n,a,r,c,f,b){var g,v,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g=(null==r?void 0:r.length)&&{tags:r},c&&(g=d(d({},g),(0,m.s0)(c,f))),b((0,o.addNotification)(i.LH.pending)),e.next=6,(0,u.dX)("".concat(i._n,"/export/").concat(t,".").concat("json"===n?"json":"csv"),{},d(d({},a),g)).then((function(e){return b((0,o.addNotification)(i.LH.success)),e})).catch((function(){return b((0,o.addNotification)(i.LH.error))}));case 6:v=e.sent.data,y="json"===n?JSON.stringify(v):v,(0,l.Sv)(y,p(t),n),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),"".concat(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,a,r,c,s,o){return e.apply(this,arguments)}}()},52837:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var a=n(63732),r=n(15914),c=n(26407),s=n(99332),o=n(69507),l=n(45697),i=n.n(l),u=n(93264),m=n.n(u),f=n(30893),d=n(86896),p=n(42293),b=function(e){var t=e.icon,n=e.text;return m().createElement(p.Label,{icon:t,variant:"outline",color:"blue",isCompact:!0},n)};b.propTypes={icon:i().object,text:i().bool};const g=b;var v=function(e){var t,n=e.labelList,l=(0,d.Z)(),i=(t=n.map((function(e){return e.id})),Object.entries(t.reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),{})).sort((function(e,t){return t[1]-e[1]})));return m().createElement(c.e,{numLabels:1,isCompact:!0},i.map((function(e){return function(e){return[m().createElement(g,{icon:m().createElement(a.ZP,null),text:l.formatMessage(f.Z.availability)}),m().createElement(g,{icon:m().createElement(s.ZP,null),text:l.formatMessage(f.Z.security)}),m().createElement(g,{icon:m().createElement(r.ZP,null),text:l.formatMessage(f.Z.stability)}),m().createElement(g,{icon:m().createElement(o.ZP,null),text:l.formatMessage(f.Z.performance)})][e]}(Number(e[0]-1))})))};v.propTypes={labelList:i().array,isCompact:i().bool},v.defaultProps={isCompact:!0};const y=v},24130:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var a=n(42293),r=n(45697),c=n.n(r),s=n(93264),o=n.n(s),l=n(30893),i=n(86896),u=function(e){var t=e.recLvl,n=(e.isCompact,(0,i.Z)()),r=function(e,t,n){return o().createElement(a.Label,{color:n,isCompact:!0},"".concat(e," - ").concat(t,"%"))};return t>=80?r(n.formatMessage(l.Z.high),t,"red"):t<80&&t>=50?r(n.formatMessage(l.Z.medium),t,"orange"):r(n.formatMessage(l.Z.low),t,"blue")};u.propTypes={props:c().array},u.defaultProps={isCompact:!0};const m=u},44788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var a=n(4942),r=n(15861),c=n(70885),s=n(87757),o=n.n(s),l=n(93264),i=n.n(l),u=n(59303),m=n(6202),f=n(32752),d=n(4853),p=n(23811),b=n(78826),g=n(71094),v=n(45697),y=n.n(v),E=n(12282),h=n(71355),Z=n(30893),O=n(28216),w=n(86896),j=n(77647);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t=e.handleModalToggle,n=e.isModalOpen,a=e.host,s=e.hosts,v=e.rule,y=e.afterFn,k=(0,w.Z)(),M=(0,O.useDispatch)(),S=function(e){return M((0,h.addNotification)(e))},_=(0,l.useState)(""),x=(0,c.Z)(_,2),N=x[0],D=x[1],C=(0,l.useState)(void 0!==a||s.length>0),T=(0,c.Z)(C,2),I=T[0],L=T[1],F=(0,j.om)(),R=(0,c.Z)(F,1)[0],z=function(){var e=(0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={systems:s,justification:N},e.prev=1,e.next=4,(0,g.SO)("".concat(u._n,"/rule/").concat(v.rule_id,"/ack_hosts/"),{},t);case 4:!I&&S({variant:"success",dismissable:!0,timeout:!0,title:k.formatMessage(Z.Z.recSuccessfullyDisabled)}),y&&y(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),S({variant:"danger",dismissable:!0,title:k.formatMessage(Z.Z.error),description:"".concat(e.t0)});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("enabled"!==v.rule_status||s.length){e.next=15;break}return n=I?{type:"HOST",options:{rule:v.rule_id,system_uuid:a.id,justification:N}}:{type:"RULE",options:P({rule_id:v.rule_id},N&&{justification:N})},e.prev=2,e.next=5,R(n).unwrap();case 5:S({variant:"success",timeout:!0,dismissable:!0,title:k.formatMessage(Z.Z.recSuccessfullyDisabled)}),D(""),y&&y(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),S({variant:"danger",dismissable:!0,title:k.formatMessage(Z.Z.error),description:"".concat(e.t0)});case 13:e.next=16;break;case 15:z();case 16:t(!1);case 17:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return i().createElement(b.u_,{variant:"small",title:k.formatMessage(Z.Z.disableRule),isOpen:n,onClose:function(){t(!1),D("")},actions:[i().createElement(m.Button,{key:"confirm",variant:"primary",onClick:function(){return q()},ouiaId:"confirm"},k.formatMessage(Z.Z.save)),i().createElement(m.Button,{key:"cancel",variant:"link",onClick:function(){t(!1),D("")},ouiaId:"cancel"},k.formatMessage(Z.Z.cancel))]},k.formatMessage(Z.Z.disableRuleBody),i().createElement(d.l,null,i().createElement(p.c,{fieldId:"blank-form"}),(void 0!==a||s.length>0)&&i().createElement(p.c,{fieldId:"disable-rule-one-system"},i().createElement(f.X,{isChecked:I,onChange:function(){L(!I)},label:s.length?k.formatMessage(Z.Z.disableRuleForSystems):k.formatMessage(Z.Z.disableRuleSingleSystem),id:"disable-rule-one-system",name:"disable-rule-one-system"})),i().createElement(p.c,{label:k.formatMessage(Z.Z.justificationNote),fieldId:"disable-rule-justification"},i().createElement(E.oi,{type:"text",id:"disable-rule-justification","aria-describedby":"disable-rule-justification",value:N,onChange:function(e){return D(e)},onKeyDown:function(e){return"Enter"===e.key&&(e.preventDefault(),q())}}))))};M.propTypes={isModalOpen:y().bool,host:y().object,handleModalToggle:y().func,rule:y().object,afterFn:y().func,hosts:y().array},M.defaultProps={isModalOpen:!1,handleModalToggle:function(){},system:void 0,rule:{},afterFn:function(){},host:void 0,hosts:[]};const S=M},79364:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var a=n(70885),r=n(4942),c=n(50693),s=n(16475),o=n(89376),l=n(39173),i=n(93264),u=n.n(i),m=n(32203),f=n(70),d=n(62394),p=n(32576),b=n(3673),g=n(2370),v=n(26383),y=n(39727),E=n(72575),h=n(47265),Z=n(69897),O=n(8135),w=n(30893),j=n(28186),k=n(86896),P=function(e){var t,n,a=(0,k.Z)(),r=e.impacted_systems_count,o=e.incident_count,l=e.categories,i=e.critical_risk_count,P=e.high_risk_count,M=e.medium_risk_count,S=e.low_risk_count;return u().createElement(m.Z,{isFlat:!0,isPlain:!0,className:"adv-c-card-pathway adv__background--global-100 pf-u-h-100"},u().createElement(f.l,null,a.formatMessage(w.Z.totalRiskPathway)),u().createElement(d.e,{className:"body"},u().createElement(c.r,{hasGutter:!0},u().createElement(s.P,{span:6},u().createElement("div",null,u().createElement(p.k,{ariaDesc:"Total risk of recommendations",ariaTitle:"Total risk of recommendations",containerComponent:u().createElement(b.H,{labels:function(e){var t=e.datum;return"".concat(t.name,": ").concat(t.y)},constrainToVisibleArea:!0}),domainPadding:{x:[20,15]},height:150,width:300,padding:{bottom:30,left:45,right:10,top:10}},u().createElement(g.C,null),u().createElement(g.C,{dependentAxis:!0,showGrid:!0}),u().createElement(v.G,null,u().createElement(y.B,{barWidth:16,style:{data:{fill:function(e){return e.datum.fill}}},data:[{name:"Critical",x:"Critical",y:i,fill:O.Z.value},{name:"Important",x:"Important",y:P,fill:Z.Z.value},{name:"Moderate",x:"Moderate",y:M,fill:h.Z.value},{name:"Low",x:"Low",y:S,fill:E.Z.value}]}))))),u().createElement(s.P,{span:6,className:"pf-u-font-size-sm"},a.formatMessage(w.Z.thisPathway,{category:(t=l,t.length>1?l.map((function(e){return e.name})).join(", "):null===(n=t[0])||void 0===n?void 0:n.name),systems:r,incidents:o,strong:function(e){return(0,j.fK)(e)}})))))},M=n(90693),S=n(59303),_=n(52202),x=n(24130),N=function(e){var t=e.name,n=e.reboot_required,a=e.resolution_risk,r=e.recommendation_level,c=(0,k.Z)();return u().createElement(m.Z,{isFlat:!0,isPlain:!0,className:"adv-c-card-pathway adv__background--global-100 pf-u-h-100 flex-row"},u().createElement("div",{className:"flex-coloumn"},u().createElement(f.l,null,c.formatMessage(w.Z.resolution)),u().createElement("div",{className:"flex-row "},u().createElement("div",{className:"halfWidth"},u().createElement("p",{className:"pf-u-font-weight-bold pf-u-font-size-sm pf-u-pl-lg"},c.formatMessage(w.Z.remediation)),u().createElement("p",{className:"pf-u-font-size-sm pf-u-pl-lg"},t)),u().createElement(d.e,{className:" pf-u-pl-xl halfWidth"},u().createElement("p",{className:"pf-u-font-weight-bold pf-u-font-size-sm"},c.formatMessage(w.Z.riskOfChange)),u().createElement(M.Z,{text:S.MS[a.risk],value:a.risk,hideIcon:!0,isCompact:!0}))),u().createElement(d.e,{className:"body pf-u-font-size-sm"},c.formatMessage(w.Z.staticRemediationDesc)),u().createElement(d.e,{className:"body"},(0,_.k)(n))),u().createElement("div",{className:"pathwayRight pf-u-p-lg "},u().createElement("p",{className:"pf-u-font-weight-bold pf-u-font-size-sm"},c.formatMessage(w.Z.reclvl)),u().createElement("div",null,u().createElement(x.Z,{recLvl:r}))))},D=n(35262),C=n(28883),T=n(29873),I=n(28672),L=n(28216),F=n(75331),R=n(52837),z=n(62410),q=n(84348),H=n(46891),K=n(87516),A=n(8377),B=n(75662),G=n(97109);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=(0,i.lazy)((function(){return Promise.all([n.e(6692),n.e(6252),n.e(3486),n.e(3877),n.e(7120),n.e(3602),n.e(384)]).then(n.bind(n,65790))}));const J=function(){var e=(0,k.Z)(),t=(0,B.useParams)().id,n=(0,L.useDispatch)(),r=(0,L.useSelector)((function(e){return e.filters.selectedTags})),m=(0,L.useSelector)((function(e){return e.filters.workloads})),f=(0,L.useSelector)((function(e){return e.filters.SID})),d=(0,L.useSelector)((function(e){return e.filters.recState})),p=(0,L.useSelector)((function(e){return e.filters.sysState})),b={};(null==r?void 0:r.length)&&(b=W(W({},b),{tags:r.join(",")})),m&&(b=W(W({},b),(0,G.s0)(m,f)));var g=(0,A.fQ)(W(W({},b),{},{slug:t})),v=g.data,y=void 0===v?{}:v,E=g.isFetching,h=(0,B.useLocation)().pathname,Z=(0,i.useState)(h.includes("/recommendations/pathways/systems/")?1:0),O=(0,a.Z)(Z,2),j=O[0],M=O[1];return(0,i.useEffect)((function(){var e=W({},d),a=W({},p),r={pathway:t,limit:20,offset:0};return n((0,I.hb)(W(W({},r),{},{sort:"category",impacting:!0}))),n((0,I.pu)(W({},r))),h.includes("/recommendations/pathways/systems/")&&setTimeout((function(){var e;(e="#tablesContainer",new Promise((function(t){if(document.querySelector(e))return t(document.querySelector(e));var n=new MutationObserver((function(){document.querySelector(e)&&(t(document.querySelector(e)),n.disconnect())}))}))).then((function(){document.getElementById("tablesContainer").scrollIntoView({behavior:"smooth"})}))}),5e3),function(){n((0,I.hb)(e)),n((0,I.pu)(a))}}),[]),u().createElement(u().Fragment,null,E?u().createElement(H.Z,null):u().createElement(u().Fragment,null,u().createElement(o.Z,{className:"adv-c-page__header"},u().createElement(F.Z,{ouiaId:"override",current:y.name||""}),u().createElement(l.Z,{title:u().createElement(u().Fragment,null,y.name,y.has_incident&&u().createElement(K.Z,{rule:{tags:"incident"}}))}),u().createElement("p",{className:"pf-u-mb-lg"},e.formatMessage(w.Z.rulesDetailsModifieddate,{date:u().createElement(z.Z,{date:new Date(y.publish_date),type:"onlyDate"})}),u().createElement("span",{className:"pf-u-pl-sm"},u().createElement(R.Z,{labelList:y.categories}))),u().createElement("p",{className:"pf-u-mb-lg"},y.description)),u().createElement("section",{className:"pf-u-pb-0"},u().createElement(c.r,{hasGutter:!0},u().createElement(s.P,{sm:12,md:6},u().createElement(P,y)),u().createElement(s.P,{sm:12,md:6},u().createElement(N,y))))),E&&u().createElement(H.Z,null),u().createElement("section",null,u().createElement(D.m,{className:"adv__background--global-100",activeKey:j,onSelect:function(e,t){return M(t)}},u().createElement(C.O,{eventKey:0,title:u().createElement(T.T,null,e.formatMessage(w.Z.recommendations))},E?u().createElement(H.Z,null):u().createElement(i.Suspense,{fallback:u().createElement(H.Z,null)},u().createElement(X,null))),u().createElement(C.O,{eventKey:1,title:u().createElement(T.T,null,e.formatMessage(w.Z.systems))},E?u().createElement(H.Z,null):u().createElement(i.Suspense,{fallback:u().createElement(H.Z,null)},u().createElement(q.Z,{tableProps:{canSelectAll:!1,isStickyHeader:!0},pathway:y,selectedTags:r,workloads:m,SID:f,showTags:!0}))))))}},70347:()=>{},10108:()=>{},90479:()=>{},78752:()=>{},98379:()=>{},25238:()=>{},56024:()=>{},43390:()=>{},72816:()=>{},11177:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Details-Pathways.2caab7ec3b19f83d7109d429c87b66fe.js.map