(self.webpackChunkadvisor=self.webpackChunkadvisor||[]).push([[3815],{58921:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(4942),o=n(15861),a=n(87757),i=n.n(a),l=n(53446),c=n(35240),s=n(59303),u=n(71094),d=n(97109);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(e){var t={date:(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc"};return"Insights-Advisor_".concat(e,"--").concat(t.date)};const g=function(){var e=(0,o.Z)(i().mark((function e(t,n,r,o,a,p,g,h){var v,y,b;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v=(null==o?void 0:o.length)&&{tags:o},a&&(v=f(f({},v),(0,d.s0)(a,p))),g((0,l.addNotification)(s.LH.pending)),e.next=6,(0,u.dX)("".concat(s._n,"/export/").concat(t,".").concat("json"===n?"json":"csv"),{},f(f(f({},r),v),h&&{display_name:h})).then((function(e){return g((0,l.addNotification)(s.LH.success)),e})).catch((function(){return g((0,l.addNotification)(s.LH.error))}));case 6:y=e.sent.data,b="json"===n?JSON.stringify(y):y,(0,c.Sv)(b,m(t),n),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),"".concat(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,r,o,a,i,l,c){return e.apply(this,arguments)}}()},87516:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(72757),o=n(69174),a=n(45697),i=n.n(a),l=n(93264),c=n.n(l),s=n(30893),u=function(e){var t,n=e.rule,a=e.isCompact,i=e.noMargin;return c().createElement(c().Fragment,null,-1!==(null==n||null===(t=n.tags)||void 0===t?void 0:t.search("incident"))&&c().createElement(r.u,{content:s.Z.incidentTooltip.defaultMessage,position:r.D.right},c().createElement(o._,{color:"red",className:i?null:"adv-c-label-incident",isCompact:a},s.Z.incident.defaultMessage)),"disabled"===(null==n?void 0:n.rule_status)&&c().createElement(r.u,{content:s.Z.ruleIsDisabledTooltip.defaultMessage,position:r.D.right},c().createElement(o._,{color:"gray",isCompact:a},s.Z.disabled.defaultMessage)),"rhdisabled"===(null==n?void 0:n.rule_status)&&c().createElement(r.u,{content:s.Z.ruleIsDisabledTooltip.defaultMessage,position:r.D.right},c().createElement(o._,{color:"gray",isCompact:a},s.Z.redhatDisabled.defaultMessage)))};u.propTypes={rule:i().object,isCompact:i().bool,noMargin:i().bool},u.defaultProps={isCompact:!0};const d=u},47197:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ue});var r=n(87462),o=n(15861),a=n(4942),i=n(42982),l=n(70885),c=n(87757),s=n.n(c),u=n(59303),d=n(32203),p=n(62394),f=n(37619),m=n(86896),g=n(93264),h=n.n(g),v=n(48585),y=n(3351),b=n(22860),k=n(6934),Z=n(75863),E=n(28216),_=n(71094),O=n(24561),w=n(7887),P=n(45697),S=n.n(P),j=n(98132),C=n(71355),x=n(97109),D=n(30893),M=n(87135),W=n(27361),T=n.n(W),R=n(46818),A=n(7732),I=n(72757),N=n(16712),L=n(90693),H=n(62410),F=n(87516),V=n(27330),B=n(74761),G=n(98614),z=n(72781),X=n(52643),q=n(47173),K=n(66435),J=n(49739),$=n(83826),Q=n(34702),U=function(){return h().createElement(X.b,null,h().createElement(Q.Z,{title:"No matching recommendations found",text:"To continue, edit your filter settings and search again."}))},Y=function(){return h().createElement(X.b,null,h().createElement(Q.Z,{icon:G.ZP,iconClass:"ins-c-insights__check",title:"No recommendations",text:"No known recommendations affect this system"}))},ee=function(){return h().createElement(Q.Z,{iconClass:"chartSpikeIconColor",icon:B.ZP,title:"Get started with Red Hat Insights",text:h().createElement(X.b,null,h().createElement(J.K,{hasGutter:!0},h().createElement($.v,null,"1. Install the client on the RHEL system.",h().createElement(K.M5,null,"yum install insights-client")),h().createElement($.v,null,"2. Register the system to Red Hat Insights.",h().createElement(K.M5,null,"insights-client --register"))))},h().createElement(q.zx,{component:"a",href:"https://access.redhat.com/products/red-hat-insights#getstarted",target:"_blank",variant:"primary"},"Getting started documentation"))},te=function(e){var t=e.entity;return h().createElement(X.b,null,h().createElement(Q.Z,{icon:z.ZP,title:"Error getting recommendations",text:t?"There was an error fetching recommendations for this entity. Refresh your page to try again.":"This entity can not be found or might no longer be registered to Red Hat Insights."}))};te.propTypes={entity:S().object};var ne=n(62012);function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=n(58921),ie=n(43707);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=function(e){var t,n=e.entity,r=e.inventoryId,c=(0,m.Z)(),P=(0,g.useRef)({rowCount:0}),S=(0,E.useDispatch)(),W=function(e){return S((0,C.addNotification)(e))},B=(0,ne.useParams)().id,G=(0,g.useState)("pending"),z=(0,l.Z)(G,2),X=z[0],q=z[1],K=(0,g.useState)([]),J=(0,l.Z)(K,2),$=J[0],Q=J[1],re=(0,g.useState)([]),le=(0,l.Z)(re,2),se=le[0],ue=le[1],de=(0,g.useState)([]),pe=(0,l.Z)(de,2),fe=pe[0],me=pe[1],ge=(0,g.useState)({}),he=(0,l.Z)(ge,2),ve=he[0],ye=he[1],be=(0,g.useState)({}),ke=(0,l.Z)(be,2),Ze=ke[0],Ee=ke[1],_e=(0,g.useState)(""),Oe=(0,l.Z)(_e,2),we=Oe[0],Pe=Oe[1],Se=(0,g.useState)(!1),je=(0,l.Z)(Se,2),Ce=je[0],xe=je[1],De=(0,g.useState)(!1),Me=(0,l.Z)(De,2),We=Me[0],Te=Me[1],Re=(0,g.useState)({}),Ae=(0,l.Z)(Re,2),Ie=Ae[0],Ne=Ae[1],Le=(0,g.useState)(!0),He=(0,l.Z)(Le,2),Fe=He[0],Ve=He[1],Be=(0,E.useSelector)((function(e){var t=e.filters;return null==t?void 0:t.selectedTags})),Ge=(0,E.useSelector)((function(e){var t=e.filters;return null==t?void 0:t.workloads})),ze=(0,E.useSelector)((function(e){var t=e.filters;return null==t?void 0:t.SID})),Xe=(0,ie.TE)("advisor",u.Gd.export).hasAccess,qe=function(e){return e.filter((function(e){return e.selected}))},Ke=qe($).filter((function(e){var t;return null===(t=e.resolution)||void 0===t?void 0:t.has_playbook})),Je=qe($).length,$e=$.filter((function(e){var t;return null===(t=e.resolution)||void 0===t?void 0:t.has_playbook})).length,Qe=function(e){return[{title:e.formatMessage(D.Z.topicAddEditDescription),transforms:[A.p]},{title:e.formatMessage(D.Z.modified),transforms:[A.p,R.E0]},{title:e.formatMessage(D.Z.firstImpacted),transforms:[A.p,R.E0]},{title:e.formatMessage(D.Z.totalRisk),transforms:[A.p,R.E0]},{title:e.formatMessage(D.Z.remediation),transforms:[A.p,R.E0]}]}(c),Ue=Fe||"edge"===(null==Ie?void 0:Ie.host_type)?[]:[h().createElement(j.Z,{key:"remediation-button",fallback:h().createElement(f.$,{size:"md"}),isDisabled:0===Ke.length,dataProvider:function(){return it(Ke)},onRemediationCreated:function(e){return function(e){tt(!1);try{e.remediation&&W(e.getNotification())}catch(e){W({variant:"danger",dismissable:!0,title:c.formatMessage(D.Z.error),description:"".concat(e)})}}(e)}},c.formatMessage(D.Z.remediate))],Ye=function(e){var t=(0,i.Z)(e),n=B?e.findIndex((function(e){return e.rule.rule_id===B})):-1,r=t.splice(n,1);return-1!==n?[r[0]].concat((0,i.Z)(t)):e},et=function(e,t,n,r){var o,a=null===(o=(0,ne.useLocation)().pathname)||void 0===o?void 0:o.split("/");return(0,g.useCallback)((function(o,i,l,c){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",d=arguments.length>5&&void 0!==arguments[5]&&arguments[5],p=arguments.length>6&&void 0!==arguments[6]&&arguments[6],f=o,m=window.location.href.indexOf("activeRule")>-1;if(m&&p){var g=a[2];f.sort((function(e,t){return e.rule.rule_id===g?-1:t.rule.rule_id===g?1:0}))}else p&&f.sort((function(e,t){return e.rule.total_risk>t.rule.total_risk?-1:t.rule.total_risk>e.rule.total_risk?1:0}));var v=f.flatMap((function(t,n){var r=t.rule,o=t.resolution,a=Object.keys(i).length?i.filter((function(e){return e.id===t.rule.node_id}))[0]:{},f=c.find((function(e){var t;return(null==e||null===(t=e.rule)||void 0===t?void 0:t.rule_id)===r.rule_id})),g=null==f?void 0:f.selected,v=(null==f?void 0:f.isOpen)||m&&p&&0===n,y=[{rule:r,resolution:o,isOpen:o?v:void 0,selected:g,disableSelection:!o||!o.has_playbook,cells:[{title:h().createElement("span",null,r.description," ",h().createElement(F.Z,{rule:r}))},{title:h().createElement("span",null,h().createElement(H.Z,{date:r.publish_date,type:"relative",tooltipProps:{position:I.D.bottom}}))},{title:h().createElement("div",{key:n},h().createElement(H.Z,{date:t.impacted_date,type:"relative",tooltipProps:{position:I.D.bottom}}))},{title:h().createElement("div",{key:n,style:{verticalAlign:"top"}},h().createElement(I.u,{key:n,position:I.D.bottom,content:h().createElement("span",null,"The ",h().createElement("strong",null,"likelihood")," that this will be a problem is ",u.FV[r.likelihood],". The"," ",h().createElement("strong",null,"impact")," of the problem would be  ",u.dz[r.impact.impact]," if it occurred.")},h().createElement(L.Z,{value:r.total_risk,isCompact:!0})))},{title:h().createElement("div",{className:"ins-c-center-text",key:n},null===o?e.formatMessage(D.Z.notAvailable):null!=o&&o.has_playbook?h().createElement("span",null,h().createElement(N.ZP,{size:"sm"})," ",e.formatMessage(D.Z.playbook)):e.formatMessage(D.Z.manual))}]},o&&{parent:n,fullWidth:!0,cells:[{title:h().createElement(V.G,{key:"child-".concat(n),report:oe(oe({},t),{},{resolution:t.resolution.resolution}),kbaDetail:a,kbaLoading:d})}]}],b=0===s.length||r.description.toLowerCase().includes(s.toLowerCase()),k=0===Object.keys(l).length||Object.keys(l).map((function(e){var n,o=l[e],a={has_playbook:null===(n=t.resolution)||void 0===n?void 0:n.has_playbook,publish_date:r.publish_date,total_risk:r.total_risk,category:u.kT[r.category.name.toLowerCase()]};return o.find((function(t){return String(t)===String(a[e])}))})).every((function(e){return e}));return b&&k?y.filter((function(e){return null!==e})):[]}));if(v.forEach((function(e,t){return e.parent?e.parent=t-1:null})),t.current.rowCount=o.length,o.length<1||v.length<1){var y=0===v.length&&U||(null==n?void 0:n.insights_id)&&Y||ee;return[{heightAuto:!0,cells:[{props:{colSpan:5},title:h().createElement(y,null)}]}]}return"failed"===r?[{heightAuto:!0,cells:[{props:{colSpan:5},title:h().createElement(te,{entity:n})}]}]:v}),[n,r])}(c,P,n,X),tt=function(e){xe(e),Q(et(se,fe,Ze,$.map((function(t,n){return n%2==0&&t.resolution.has_playbook?ce(ce({},t),{},{selected:e}):t})),we))},nt={items:[{title:"Select none",onClick:function(){return tt(!1)}},{title:"Select all",onClick:function(){return tt(!0)}}],count:Je,checked:Je===P.current.rowCount?1:Je>0||$e!==P.current.rowCount?null:0,onSelect:function(){return tt(!Ce)}},rt={deleteTitle:c.formatMessage(D.Z.resetFilters),filters:function(e){var t=Object.entries(e),n=e&&t.length>0?t.map((function(e){var t=u.W2[e[0]],n=e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}}));return{category:(0,x.kC)(t.title),chips:n,urlParam:t.urlParam}})):[];return we.length>0&&n.push({category:"Description",chips:[{name:we,value:we}]}),n}(Ze),onDelete:function(e,t,n){n?(Q(et(se,fe,{},$,"")),Ee({}),Pe("")):t.map((function(e){"Description"===e.category?(Q(et(se,fe,Ze,$,"")),Pe("")):at(e.urlParam,Ze[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}))}},ot=function(){var e=(0,o.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.rule.node_id})).filter((function(e){return e})),e.prev=1,e.next=4,(0,_.dX)("https://access.redhat.com/hydra/rest/search/kcs?q=id:(".concat(n.join(" OR "),")&fq=documentKind:(Solution%20or%20Article)&fl=view_uri,id,publishedTitle&redhat_client=$ADVISOR"),{},{credentials:"include"});case 4:r=e.sent.data.response.docs,me(r),Q(et(t,r,Ze,$,we,!1,!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0,"KBA fetch failed.");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),at=function(e,t){var n=t.length>0?ce(ce({},Ze),(0,a.Z)({},e,t)):function(e){var t=ce({},Ze);return delete t[e],t}(e);Q(et(se,fe,n,$,we)),Ee(n)},it=function(e){return(0,g.useCallback)((function(t){var n=t.filter((function(e){var t;return null===(t=e.resolution)||void 0===t?void 0:t.has_playbook})).map((function(e){return{id:"advisor:".concat(e.rule.rule_id),description:e.rule.description}}));return!!n.length&&{issues:n,systems:[e]}}),[e])}(r),lt=function(e,t,n,r){return[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return n(t)},value:t}},{label:u.W2.total_risk.title,type:u.W2.total_risk.type,id:u.W2.total_risk.urlParam,value:"checkbox-".concat(u.W2.total_risk.urlParam),filterValues:{key:"".concat(u.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return r(u.W2.total_risk.urlParam,t)},value:e.total_risk,items:u.W2.total_risk.values}},{label:u.W2.category.title,type:u.W2.category.type,id:u.W2.category.urlParam,value:"checkbox-".concat(u.W2.category.urlParam),filterValues:{key:"".concat(u.W2.category.urlParam,"-filter"),onChange:function(e,t){return r(u.W2.category.urlParam,t)},value:e.category,items:u.W2.category.values}},{label:u.W2.has_playbook.title,type:u.W2.has_playbook.type,id:u.W2.has_playbook.urlParam,value:"checkbox-".concat(u.W2.has_playbook.urlParam),filterValues:{key:"".concat(u.W2.has_playbook.urlParam,"-filter"),onChange:function(e,t){return r(u.W2.has_playbook.urlParam,t)},value:e.has_playbook,items:u.W2.has_playbook.values}}]}(Ze,we,(function(e){var t=et(se,fe,Ze,$,e);Pe(e),Q(t)}),at);(0,g.useEffect)((function(){var e=function(){var e=(0,o.Z)(s().mark((function e(){var t,n,o,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,_.dX)("".concat(u._n,"/system/").concat(r,"/reports/"),{credentials:"include"});case 3:return o=e.sent,a=Ye(o.data),ot(a),Q(et(a,{},Ze,$,we,!0)),q("fulfilled"),ue(a),e.next=11,(0,_.dX)("".concat(u.Lk,"/hosts/").concat(r,"/system_profile"),{credentials:"include"});case 11:i=e.sent,Ne((null==i||null===(t=i.data)||void 0===t||null===(n=t.results[0])||void 0===n?void 0:n.system_profile)||{}),Ve(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),q("failed"),Ve(!1);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var ct=null==n?void 0:n.display_name;return"fulfilled"===X&&null===(null==n?void 0:n.insights_id)?h().createElement(M.Z,{titleText:c.formatMessage(D.Z.notConnectedTitle),bodyText:c.formatMessage(D.Z.notConnectedBody),buttonText:c.formatMessage(D.Z.notConnectedButton)}):h().createElement("div",{className:"ins-c-inventory-insights__overrides"},"pending"===X||null===(null==n?void 0:n.insights_id)?h().createElement(g.Fragment,null):h().createElement(w.Z,{expandAll:{isAllExpanded:We,onClick:function(e,t){Te(t);var n=(0,i.Z)($);n.map((function(e){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t)})),Q(n)}},actionsConfig:{actions:Ue},bulkSelect:nt,filterConfig:{items:lt},pagination:h().createElement(g.Fragment,null," ","".concat(P.current.rowCount," ").concat(1===P.current.rowCount?"Recommendation":"Recommendations")," "),activeFiltersConfig:rt,exportConfig:(t={label:c.formatMessage(D.Z.exportCsv)},(0,a.Z)(t,"label",c.formatMessage(D.Z.exportJson)),(0,a.Z)(t,"onSelect",(function(e,t){return(0,ae.Z)("hits",t,ce(ce({},Ze),{},{text:we}),Be,Ge,ze,S,ct)})),(0,a.Z)(t,"isDisabled",!Xe),(0,a.Z)(t,"tooltipText",Xe?c.formatMessage(D.Z.exportData):c.formatMessage(D.Z.permsAction)),t)}),"pending"===X&&h().createElement(d.Z,null,h().createElement(p.e,null,h().createElement(O.aV,null))),"fulfilled"===X&&h().createElement(g.Fragment,null,h().createElement(y.i,{id:"system-advisor-report-table","aria-label":"report-table",onSelect:!(1===$.length&&$[0].heightAuto)&&function(e,t,n){return Q(et(se,fe,Ze,$.map((function(e,r){return r===n?ce(ce({},e),{},{selected:t}):e})),we))},onCollapse:function(e,t,n){var r=(0,i.Z)($);r[t]=ce(ce({},r[t]),{},{isOpen:n}),Q(r)},rows:$,cells:Qe,sortBy:ve,canSelectAll:!1,onSort:function(e,t,n){var r={2:"rule.description",3:"rule.publish_date",4:"impacted_date",5:"rule.total_risk",6:"resolution.has_playbook"},o=n===v.B.asc?1:-1,a=se.concat().sort((function(e,n){var a=T()(e,r[t]),i=T()(n,r[t]);return 3!==t&&4!==t||(a=new Date(a),i=new Date(i)),a>i?o:i>a?-o:0}));ue(a),ye({index:t,direction:n}),Q(et(a,fe,Ze,$,we))},variant:Z.B.compact,isStickyHeader:!0},h().createElement(k.x,null),h().createElement(b.R,null))))};se.propTypes={entity:S().shape({insights_id:S().string,id:S().string}),inventoryId:S().string.isRequired};const ue=function(e){var t=(0,r.Z)({},e),n=(0,E.useSelector)((function(e){return e.entityDetails.entity}));return h().createElement(se,(0,r.Z)({},t,{entity:n}))}},45467:()=>{},11452:()=>{},34946:()=>{},80598:()=>{},32857:()=>{},37625:()=>{},28992:()=>{},30187:()=>{},90479:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{},53519:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/3815.3f1d00120f149165d7ebc3e4f1ebf8ca.js.map