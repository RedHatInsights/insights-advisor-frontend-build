"use strict";(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[909],{40771:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(15861),a=n(4942),i=n(29439),o=n(87757),s=n.n(o),l=n(59303),c=n(93264),u=n.n(c),d=n(27577),f=n(97109),m=n(82041),p=n(61829),v=n(44788),h=n(71094),b=n(33739),g=n(46891),y=n(45697),k=n.n(y),_=n(98132),w=n(30893),P=n(71355),x=n(46655),O=n(41131),Z=n(86896);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=function(e){var t,n,o,y,k,S=e.tableProps,D=e.rule,E=e.afterDisableFn,I=e.pathway,T=e.selectedTags,j=e.workloads,F=e.SID,U=(0,m.useStore)(),N=(0,Z.Z)(),M=(0,m.useDispatch)(),A=(0,c.useState)([]),R=(0,i.Z)(A,2),V=R[0],L=R[1],X=(0,c.useState)({limit:20,offset:0,sort:"-last_seen",name:""}),Y=(0,i.Z)(X,2),J=Y[0],W=Y[1],z=(0,m.useSelector)((function(e){return e.entities||{}})),B=function(e,t){return M({type:"SELECT_ENTITY",payload:{id:e,selected:t}})},K=function(e){return M((0,P.wN)(e))},q=(0,c.useState)(!1),G=(0,i.Z)(q,2),H=G[0],Q=G[1],$=(0,c.useState)(),ee=(0,i.Z)($,2),te=ee[0],ne=ee[1],re=function(e){Q(e)},ae=function(){ne(!0),B(0,!0)},ie=function(){var e;return te?ne(!1):L(null==z||null===(e=z.rows)||void 0===e?void 0:e.filter((function(e){return!0===e.selected})).map((function(e){return e.id})))},oe=function(e){var t=e.name,n=e.display_name,r=C(C(C({},e),t&&{name:t}),n&&{display_name:n});(0,f.Y4)(r,T)},se=function(e){var t=C(C({},J),{},{offset:0});delete t[e],W(t)},le=[{label:l.Ut.rhel_version.title.toLowerCase(),type:l.Ut.rhel_version.type,id:l.Ut.rhel_version.urlParam,value:"checkbox-".concat(l.Ut.rhel_version.urlParam),filterValues:{key:"".concat(l.Ut.rhel_version.urlParam,"-filter"),onChange:function(e,t){!function(e,t){t.length>0?W(C(C({},J),{},{offset:0},(0,a.Z)({},e,t))):se(e)}(l.Ut.rhel_version.urlParam,t)},value:J.rhel_version,items:l.Ut.rhel_version.values}}],ce={deleteTitle:N.formatMessage(w.Z.resetFilters),filters:(y=C({},J),delete y.sort,delete y.offset,delete y.limit,(0,f.yK)(y,l.Ut)),onDelete:function(e,t,n){n?W({sort:J.sort,limit:J.limit,offset:J.offset}):t.map((function(e){var t=(0,a.Z)({},e.urlParam,Array.isArray(J[e.urlParam])?J[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?W(C(C({},J),t)):se(e.urlParam)}))}};return(0,c.useEffect)((function(){var e;(null==z||null===(e=z.rows)||void 0===e?void 0:e.length)&&ie(z.rows)}),[null==z?void 0:z.rows]),u().createElement(u().Fragment,null,H&&u().createElement(v.Z,{handleModalToggle:re,isModalOpen:H,rule:D,afterFn:E,hosts:V}),u().createElement(b.Z,{hasCheckbox:!0,initialLoading:!0,autoRefresh:!0,hideFilters:{all:!0,name:!1},filterConfig:{items:le},activeFiltersConfig:ce,columns:function(e){return function(e){var t=e.filter((function(e){return"updated"===e.key})),n=e.filter((function(e){return"display_name"===e.key})),r=e.filter((function(e){return"system_profile"===e.key}));return n=C(C({},n[0]),{},{transforms:[d.sortable,d.wrappable],props:{isStatic:!0}}),t=C(C({},t[0]),{},{transforms:[d.sortable,d.wrappable],props:{width:20}}),[n,r=C(C({},r[0]),{},{transforms:[d.wrappable]}),t]}(e)},tableProps:C({variant:d.TableVariant.compact},S),customFilters:{advisorFilters:J,selectedTags:T,workloads:j,SID:F},getEntities:function(){var e=(0,r.Z)(s().mark((function e(t,n,r,a){var i,o,c,u,d,m,p,v,b,g,y,k,_,w,P,x,O;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m=n.per_page,p=n.page,v=n.orderBy,b=n.orderDirection,g=n.advisorFilters,y=n.selectedTags,k=n.workloads,_=n.SID,w="".concat("ASC"===b?"":"-").concat("updated"===v?"last_seen":v),P=C(C(C(C(C({},g),{},{limit:m,offset:p*m-m,sort:w},n.filters.hostnameOrId&&!I&&{name:null==n||null===(i=n.filters)||void 0===i?void 0:i.hostnameOrId}),n.filters.hostnameOrId&&I&&{display_name:null==n||null===(o=n.filters)||void 0===o?void 0:o.hostnameOrId}),y.length&&{tags:y}),Array.isArray(g.rhel_version)&&{rhel_version:null===(c=g.rhel_version)||void 0===c?void 0:c.join(",")}),k&&(P=C(C({},P),(0,f.s0)(k,_))),oe(P),!I){e.next=20;break}return e.next=8,(0,h.dX)("".concat(l.Vo),{},C(C({},P),{},{pathway:I}));case 8:if(e.t2=u=e.sent,e.t1=null===e.t2,e.t1){e.next=12;break}e.t1=void 0===u;case 12:if(!e.t1){e.next=16;break}e.t3=void 0,e.next=17;break;case 16:e.t3=u.data;case 17:e.t0=e.t3,e.next=32;break;case 20:return e.next=22,(0,h.dX)("".concat(l.cJ).concat(encodeURI(D.rule_id),"/systems_detail/"),{},P);case 22:if(e.t5=d=e.sent,e.t4=null===e.t5,e.t4){e.next=26;break}e.t4=void 0===d;case 26:if(!e.t4){e.next=30;break}e.t6=void 0,e.next=31;break;case 30:e.t6=d.data;case 31:e.t0=e.t6;case 32:return x=e.t0,e.next=35,a(x.data.map((function(e){return e.system_uuid})),{page:p,per_page:m,hasItems:!0,fields:{system_profile:["operating_system"]}},r);case 35:return O=e.sent,e.abrupt("return",Promise.resolve({results:(0,f.E9)(x.data,O.results),total:x.meta.count}));case 37:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),dedicatedAction:u().createElement(_.Z,{key:"remediation-button",isDisabled:0===V.length||0===(null==D?void 0:D.playbook_count)||!0,dataProvider:function(){return{issues:[{id:"advisor:".concat(D.rule_id),description:D.description}],systems:V}},onRemediationCreated:function(e){return function(e){B(-1,!1);try{e.remediation&&K(e.getNotification())}catch(e){K({variant:"danger",dismissable:!0,title:N.formatMessage(w.Z.error),description:"".concat(e)})}}(e)}},u().createElement(p.ZP,{size:"sm",className:"ins-c-background__default"}),"Â ",N.formatMessage(w.Z.remediate)),actionsConfig:{actions:["",{label:N.formatMessage(w.Z.disableRuleForSystems),props:{isDisabled:I||0===V.length},onClick:function(){return re(!0)}}]},bulkSelect:{count:V.length,items:[{title:N.formatMessage(w.Z.selectNone),onClick:function(){B(-1,!1)}},C({},(null==z||null===(t=z.rows)||void 0===t?void 0:t.length)>J.limit?{title:N.formatMessage(w.Z.selectPage,{items:J.limit}),onClick:function(){B(0,!0)}}:{}),C({},(null==z||null===(n=z.rows)||void 0===n?void 0:n.length)>0?{title:N.formatMessage(w.Z.selectAll,{items:(null==z?void 0:z.total)||0}),onClick:(k=(0,r.Z)(s().mark((function e(){var t,n,r,a,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I){e.next=15;break}return e.next=3,(0,h.dX)("".concat(l.Vo),{},{pathway:I});case 3:if(e.t2=t=e.sent,e.t1=null===e.t2,e.t1){e.next=7;break}e.t1=void 0===t;case 7:if(!e.t1){e.next=11;break}e.t3=void 0,e.next=12;break;case 11:e.t3=null===(n=t.data)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.map((function(e){return e.system_uuid}));case 12:e.t0=e.t3,e.next=27;break;case 15:return e.next=17,(0,h.dX)("".concat(l.cJ).concat(encodeURI(D.rule_id),"/systems/"),{},{name:J.name});case 17:if(e.t5=a=e.sent,e.t4=null===e.t5,e.t4){e.next=21;break}e.t4=void 0===a;case 21:if(!e.t4){e.next=25;break}e.t6=void 0,e.next=26;break;case 25:e.t6=null===(i=a.data)||void 0===i?void 0:i.host_ids;case 26:e.t0=e.t6;case 27:o=e.t0,L(o),ae();case 30:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)})}:{})],checked:(V.length===(null==z||null===(o=z.rows)||void 0===o?void 0:o.length)||V.length===(null==z?void 0:z.total))&&(null==z?void 0:z.total)>0?1:V.length===J.limit?null:0,onSelect:function(){V.length>0?B(-1,!1):ae(),ie()}},fallback:g.Z,onLoad:function(e){var t=e.mergeWithEntities,n=e.INVENTORY_ACTION_TYPES,r=e.mergeWithDetail;U.replaceReducer((0,O.U)(C(C({},t((0,x.V)([],n),{page:Number(J.offset/J.limit+1||1),perPage:Number(J.limit||20)})),r())))}}))};D.propTypes={tableProps:k().any,rule:k().object,afterDisableFn:k().func,pathway:k().string,selectedTags:k().any,workloads:k().any,SID:k().any};const E=D}}]);
//# sourceMappingURL=../sourcemaps/909.1c3597440bc867511ca52848778354dd.js.map