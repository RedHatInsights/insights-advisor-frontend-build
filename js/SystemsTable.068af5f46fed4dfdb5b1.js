(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[3993],{27724:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>K});var r=s(96156),a=s(28481),n=(s(2174),s(72474)),o=s(67415),i=s(71221),l=s(93264),c=s.n(l),f=s(12563),u=s(77121),m=s(7133),p=s(33739),d=s(13317),y=s(85061),g=s(92137),v=s(87757),b=s.n(v),h=(s(94226),s(94627)),E=s(73085),_=s(45697),S=s.n(_),O=s(51634),A=s(39080),Z=s(87119),w=s(75442),x=s(23992),C=s(71712),P=s(32412),T=s(60578);function M(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function k(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?M(Object(s),!0).forEach((function(t){(0,r.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var j=E.mM.create({bold:{fontWeight:x.default.value},link:{color:C.ZP.value},text:{marginTop:P.ZP.value},nameColumn:{width:"220px"},header:{fontSize:9,color:w.ZP.value,paddingLeft:A.ZP.value,paddingBottom:O.ZP.value,paddingTop:Z.ZP.value}}),D=function(e){var t=e.page,s=e.systems,r=e.intl,n=[{value:r.formatMessage(T.Z.name),style:j.nameColumn},{value:r.formatMessage(T.Z.recommendations),style:{width:"100px",textAlign:"center"}},{value:r.formatMessage(T.Z.critical),style:{width:"70px",textAlign:"center"}},{value:r.formatMessage(T.Z.important),style:{width:"70px",textAlign:"center"}},{value:r.formatMessage(T.Z.moderate),style:{width:"60px",textAlign:"center"}},{value:r.formatMessage(T.Z.low),style:{width:"90px",textAlign:"center"}},{value:r.formatMessage(T.Z.lastSeen),style:{marginLeft:"20px"}}],o=["hits","critical_hits","important_hits","moderate_hits","low_hits"],i=(0,y.Z)(s.map((function(e){var t=new Date(e.last_seen).toUTCString().split(" "),s=(0,a.Z)(t,5),r=s[1],n=s[2],i=s[3],l=s[4],f="".concat(r," ").concat(n," ").concat(i,", ").concat(l.split(":").slice(0,2).join(":")," UTC");return[c().createElement(E.xv,{key:e.system_uuid,style:j.nameColumn},c().createElement(E.rU,{style:j.link,src:"https://cloud.redhat.com/insights/advisor/systems/".concat(e.system_uuid,"/")},e.display_name))].concat((0,y.Z)(o.map((function(t){return r=(s={style:{width:"10px"},value:e[t]}).value,a=s.style,c().createElement(E.xv,{style:a},r);var s,r,a}))),[c().createElement(E.xv,{key:e.last_seen,style:{width:"100px"}},"".concat(f))])})));return c().createElement(c().Fragment,{key:t},c().createElement(h.sg,null,c().createElement(h.iA,{withHeader:!0,rows:[n.map((function(e){return s=(t=e).value,r=t.style,c().createElement(E.xv,{style:k(k(k({},r),j.header),j.bold)},s);var t,s,r}))].concat((0,y.Z)(i))})))};D.propTypes={systems:S().object,page:S().number,intl:S().any};var R=function(e){var t=e.systemsTotal,s=e.systems,r=e.filters,a=e.tags,n=e.intl;return delete r.offset,delete r.limit,c().createElement(c().Fragment,{key:"".concat(n.formatMessage(T.Z.insightsHeader),": ").concat(n.formatMessage(T.Z.systems))},c().createElement(E.xv,{key:"sys-count",style:j.text},n.formatMessage(T.Z.sysTableCount,{systems:c().createElement(E.xv,{key:"sys-count-count",style:j.bold},n.formatMessage(T.Z.execReportHeaderSystems,{systems:t}))})),c().createElement(E.xv,{key:"sys-filters",style:j.text},n.formatMessage(T.Z.filtersApplied)),c().createElement(E.xv,{key:"sys-filters-values",style:j.bold},Object.entries(r).map((function(e){return c().createElement(E.xv,{key:e},"".concat(e[0],": ").concat(e[1],"     "))}))),c().createElement(E.xv,{key:"sys-tags",style:j.text},n.formatMessage(T.Z.tagsApplied)),c().createElement(E.xv,{key:"sys-tags-values",style:j.bold},a?decodeURIComponent(a):n.formatMessage(T.Z.noTags)),c().createElement(h.$0,{key:"systems",title:"Systems"},D({systems:s,intl:n})))};R.propTypes={systems:S().object,systemsTotal:S().number,filters:S().object,tags:S().array,intl:S().any};var I=s(60248),F=s(59458);function L(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function B(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?L(Object(s),!0).forEach((function(t){(0,r.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var Y=function(e){var t=e.filters,s=e.selectedTags,r=e.systemsCount,n=(0,F.Z)(),o=(0,l.useState)(!1),f=(0,a.Z)(o,2),u=f[0],m=f[1],p=function(){var e=(0,g.Z)(b().mark((function e(){var o,l,c,f,u,p;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),o=s.length&&{tags:s},e.t0=Promise,e.next=5,I.Z.get(i.SYSTEMS_FETCH_URL,{},B(B(B({},t),o),{},{limit:r}));case 5:return e.t1=e.sent.data,e.t2=[e.t1],e.next=9,e.t0.all.call(e.t0,e.t2);case 9:return l=e.sent,c=(0,a.Z)(l,1),f=c[0],u=R({systemsTotal:f.meta.count,systems:f.data.slice(0,18),filters:t,tags:s,intl:n}),p=f.data.slice(18,f.data.length).reduce((function(e,t,s){var r=Math.floor(s/31);return!e[r]&&(e[r]=[]),e[r].push(t),e}),[]),m(!1),e.abrupt("return",[u].concat((0,y.Z)(p.map((function(e,t){return D({page:t,systems:e,intl:n})})))));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,l.useMemo)((function(){return c().createElement(h.o6,{groupName:n.formatMessage(T.Z.redHatInsights),allPagesHaveTitle:!1,label:u?n.formatMessage(T.Z.loading):n.formatMessage(T.Z.exportPdf),asyncFunction:p,buttonProps:B({variant:"",component:"button",className:"pf-c-dropdown__menu-item systemsPdfOverride"},u?{isDisabled:!0}:null),reportName:"".concat(n.formatMessage(T.Z.insightsHeader),":"),type:n.formatMessage(T.Z.systems),fileName:"Advisor_systems--".concat((new Date).toUTCString().replace(/ /g,"-"),".pdf"),size:[841.89,595.28]})}),[u])};Y.propTypes={filters:S().object,selectedTags:S().any,systemsCount:S().number};const N=Y;var H=s(24330),G=s(61348),U=s(67336),z=s(95028),V=s(16530),W=s(43707);function q(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function J(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?q(Object(s),!0).forEach((function(t){(0,r.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):q(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const K=function(){var e,t,s,y,g=(0,F.Z)(),v=(0,u.useDispatch)(),b=(0,V.useLocation)().search,h=(0,u.useSelector)((function(e){return e.AdvisorStore.systems})),E=(0,u.useSelector)((function(e){return e.AdvisorStore.systemsFetchStatus})),_=(0,u.useSelector)((function(e){return e.AdvisorStore.filtersSystems})),S=(0,u.useSelector)((function(e){return e.AdvisorStore.selectedTags})),O=(0,u.useSelector)((function(e){return e.AdvisorStore.workloads})),A=(0,u.useSelector)((function(e){return e.AdvisorStore.SID})),Z=function(e){return v(n.aw(e))},w=(0,W.T)("advisor",i.PERMS.export).hasAccess,x=(0,l.useRef)(null),C=h.meta?h.meta.count:0,P=(0,l.useState)(_.display_name||""),M=(0,a.Z)(P,2),k=M[0],j=M[1],D=(0,H.Z)(k,i.DEBOUNCE_DELAY),R=(0,l.useState)(!0),I=(0,a.Z)(R,2),L=I[0],B=I[1],Y={0:"display_name",1:"hits",2:"critical_hits",3:"important_hits",4:"moderate_hits",5:"low_hits",6:"last_seen"},q=(0,l.useCallback)((function(){(0,f.Y4)(_,S);var e,t=S.length&&{tags:S};return O&&(t=J(J({},t),(0,f.s0)(O,A))),e=J(J({},(0,f.qW)(_)),t),v(n.lc(e))}),[S,O,A,_,v]),K=function(e){var t=J(J({},_),{},{offset:0});"text"===e&&j(""),delete t[e],"hits"===e&&void 0===t.hits&&(t.hits=["yes"]),Z(t)},$=[{label:g.formatMessage(T.Z.name),filterValues:{key:"text-filter",onChange:function(e,t){return j(t)},value:k}},{label:i.SYSTEM_FILTER_CATEGORIES.hits.title,type:i.SYSTEM_FILTER_CATEGORIES.hits.type,id:i.SYSTEM_FILTER_CATEGORIES.hits.urlParam,value:"checkbox-".concat(i.SYSTEM_FILTER_CATEGORIES.hits.urlParam),filterValues:{key:"".concat(i.SYSTEM_FILTER_CATEGORIES.hits.urlParam,"-filter"),onChange:function(e,t){return function(e,t){"hits"===e&&t.length>1&&t.includes("yes")&&t.shift(),t.length>0?Z(J(J({},_),{},{offset:0},(0,r.Z)({},e,t))):K(e)}(i.SYSTEM_FILTER_CATEGORIES.hits.urlParam,t)},value:_.hits,items:i.SYSTEM_FILTER_CATEGORIES.hits.values}}],Q={filters:(e=J({},_),e.hits&&e.hits.includes("yes")&&delete e.hits,delete e.sort,delete e.offset,delete e.limit,(0,f.yK)(e,i.SYSTEM_FILTER_CATEGORIES)),onDelete:function(e,t,s){s?(j(""),Z({sort:_.sort,limit:_.limit,offset:_.offset,hits:["yes"]})):t.map((function(e){var t=(0,r.Z)({},e.urlParam,Array.isArray(_[e.urlParam])?_[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?Z(J(J({},_),t)):K(e.urlParam)}))}};return(0,l.useEffect)((function(){void 0===_.display_name?j(""):j(_.display_name)}),[_.display_name]),(0,l.useEffect)((function(){if(!L&&"pending"!==E){var e=J({},_);delete e.display_name,Z(J(J(J({},e),k.length?{display_name:k}:{}),{},{offset:0}))}}),[D]),(0,l.useEffect)((function(){if(b&&L){var e=(0,f.yG)();delete e.tags,void 0!==e.sort&&(e.sort=e.sort[0]),void 0!==e.display_name&&(e.display_name=e.display_name[0]),void 0===e.hits&&(e.hits=["all"]),void 0===e.offset?e.offset=0:e.offset=Number(e.offset[0]),void 0===e.limit?e.limit=10:e.limit=Number(e.limit[0]),Z(J(J({},_),e))}else void 0!==_.limit&&void 0!==_.offset&&void 0!==_.hits||Z(J(J({},_),{},{offset:0,limit:10,hits:["all"]}));B(!1)}),[]),(0,l.useEffect)((function(){!L&&"pending"!==E&&null!==S&&q()}),[q,L,_,S]),"failed"!==E?c().createElement(p.Z,{tableProps:{isStickyHeader:!0},ref:x,items:("pending"!==E&&h&&h.data||[]).map((function(e){return J(J({},e),{},{id:e.system_uuid})})),isFullView:!0,sortBy:(s=Number(null===(t=Object.entries(Y))||void 0===t?void 0:t.find((function(e){return e[1]===_.sort||"-".concat(e[1])===_.sort}))[0]),y="-"===_.sort[0]?"desc":"asc",{index:s,key:6!==s?Y[s]:"updated",direction:y}),onSort:function(e){var t=e.index,s=e.direction,r="".concat("asc"===s?"":"-").concat(Y[t]);Z(J(J({},_),{},{sort:r,offset:0}))},hasCheckbox:!1,page:_.offset/_.limit+1,total:C,isLoaded:"fulfilled"===E,perPage:Number(_.limit),onRefresh:function(e){if("fulfilled"===E){var t=_.offset,s=_.limit;e.page*e.per_page-e.per_page===t&&s===e.per_page||Z(J(J({},_),{},{limit:e.per_page,offset:e.page*e.per_page-e.per_page}))}},filterConfig:{items:$},activeFiltersConfig:Q,exportConfig:{onSelect:function(e,t){return(0,G.Z)("systems",t,(0,f.Y4)(_,S))},extraItems:[c().createElement("li",{key:"download-pd",role:"menuitem"},c().createElement(N,{filters:J({},(0,f.qW)(_)),selectedTags:S,systemsCount:h&&h.meta&&h.meta.count}))],isDisabled:!w,tooltipText:w?g.formatMessage(T.Z.exportData):g.formatMessage(T.Z.permsAction)},fallback:d.Z,onLoad:function(e){var t=e.mergeWithEntities,s=e.INVENTORY_ACTION_TYPES,r=[{title:g.formatMessage(T.Z.name),transforms:[o.sortable,o.cellWidth(80)],key:"display_name"},{title:g.formatMessage(T.Z.numberRuleHits),transforms:[o.sortable,o.wrappable],key:"hits"},{title:g.formatMessage(T.Z.critical),transforms:[o.sortable,o.wrappable],key:"critical_hits"},{title:g.formatMessage(T.Z.important),transforms:[o.sortable,o.wrappable],key:"important_hits"},{title:g.formatMessage(T.Z.moderate),transforms:[o.sortable,o.wrappable],key:"moderate_hits"},{title:g.formatMessage(T.Z.low),transforms:[o.sortable,o.wrappable],key:"low_hits"},{title:g.formatMessage(T.Z.lastSeen),transforms:[o.sortable,o.wrappable],key:"updated"}];(0,U.JH)().register(J({},t((0,z.Vy)([].concat(r),s))))}}):"failed"===E&&c().createElement(m.Z,{message:g.formatMessage(T.Z.systemTableFetchError)})}},51306:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(94015),a=s.n(r),n=s(23645),o=s.n(n)()(a());o.push([e.id,".advisor .systemsPdfOverride{text-align:left !important;border-radius:0 !important}\n","",{version:3,sources:["webpack://./src/PresentationalComponents/Export/_Export.scss"],names:[],mappings:"AAAA,6BACoB,0BAA0B,CAAC,0BAA0B",sourcesContent:[".advisor{\n.systemsPdfOverride{text-align:left !important;border-radius:0 !important}\n\n}"],sourceRoot:""}]);const i=o},6979:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(94015),a=s.n(r),n=s(23645),o=s.n(n)()(a());o.push([e.id,".advisor .pf-c-table__sort-indicator{margin-left:var(--pf-global--spacer--xs)}.advisor .pf-c-table th,.advisor td{padding-right:0px !important}.advisor .pf-c-table tr>:last-child{padding-left:var(--pf-global--spacer--xs)}.advisor .pf-c-table .pf-c-table__sort{min-width:initial}.advisor table.ins-c-entity-table.pf-c-table .ins-composed-col *{font-size:var(--pf-global--FontSize--md)}\n","",{version:3,sources:["webpack://./src/PresentationalComponents/SystemsTable/SystemsTable.scss"],names:[],mappings:"AAAA,qCAC4B,wCAAwC,CADpE,oCACuF,4BAA4B,CADnH,oCAC+I,yCAAyC,CADxL,uCACuN,iBAAiB,CADxO,iEACiS,wCAAwC",sourcesContent:[".advisor{\n.pf-c-table__sort-indicator{margin-left:var(--pf-global--spacer--xs)}.pf-c-table th,td{padding-right:0px !important}.pf-c-table tr>:last-child{padding-left:var(--pf-global--spacer--xs)}.pf-c-table .pf-c-table__sort{min-width:initial}table.ins-c-entity-table.pf-c-table .ins-composed-col *{font-size:var(--pf-global--FontSize--md)}\n\n}"],sourceRoot:""}]);const i=o},94226:(e,t,s)=>{"use strict";var r=s(93379),a=s.n(r),n=s(51306),o=a()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var i=n.default.locals;e.hot.accept(51306,(t=>{n=s(51306),function(e,t,s){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(i,n.default.locals)?(i=n.default.locals,o(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){o()})),n.default.locals},2174:(e,t,s)=>{"use strict";var r=s(93379),a=s.n(r),n=s(6979),o=a()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var i=n.default.locals;e.hot.accept(6979,(t=>{n=s(6979),function(e,t,s){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(i,n.default.locals)?(i=n.default.locals,o(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){o()})),n.default.locals}}]);