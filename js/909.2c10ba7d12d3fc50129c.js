"use strict";(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[909],{40771:(e,t,r)=>{r.d(t,{Z:()=>E});var n=r(4942),a=r(15861),i=r(29439),s=r(87757),o=r.n(s),l=r(59303),c=r(93264),u=r.n(c),d=r(27577),f=r(97109),p=r(82041),m=r(61829),v=r(44788),b=r(71094),h=r(33739),g=r(46891),y=r(45697),k=r.n(y),_=r(98132),w=r(30893),x=r(71355),P=r(46655),O=r(41131),Z=r(86896);function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=function(e){var t,r,s,y,k,S=e.tableProps,D=e.rule,E=e.afterDisableFn,I=e.pathway,j=e.selectedTags,T=e.workloads,U=e.SID,F=(0,p.useStore)(),N=(0,Z.Z)(),M=(0,p.useDispatch)(),A=(0,c.useState)([]),R=(0,i.Z)(A,2),V=R[0],X=R[1],L=(0,c.useState)({limit:20,offset:0,sort:"-last_seen",name:""}),Y=(0,i.Z)(L,2),J=Y[0],W=Y[1],z=(0,p.useSelector)((function(e){return e.entities||{}})),B=function(e,t){return M({type:"SELECT_ENTITY",payload:{id:e,selected:t}})},K=function(e){return M((0,x.wN)(e))},q=(0,c.useState)(!1),G=(0,i.Z)(q,2),H=G[0],Q=G[1],$=(0,c.useState)(),ee=(0,i.Z)($,2),te=ee[0],re=ee[1],ne=function(){var e=(0,a.Z)(o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I){e.next=17;break}return e.next=3,(0,b.dX)("".concat(l._n,"/pathway/").concat(encodeURI(I.slug),"/rules/"),{},{});case 3:if(e.t1=t=e.sent,e.t0=null===e.t1,e.t0){e.next=7;break}e.t0=void 0===t;case 7:if(!e.t0){e.next=11;break}e.t2=void 0,e.next=12;break;case 11:e.t2=t.data.data;case 12:return r=e.t2,n=r.map((function(e){return{id:"advisor:".concat(e.rule_id),description:e.description}})),e.abrupt("return",{issues:n,systems:V});case 17:return e.abrupt("return",{issues:[{id:"advisor:".concat(D.rule_id),description:D.description}],systems:V});case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(e){Q(e)},ie=function(){re(!0),B(0,!0)},se=function(){var e;return te?re(!1):X(null==z||null===(e=z.rows)||void 0===e?void 0:e.filter((function(e){return!0===e.selected})).map((function(e){return e.id})))},oe=function(e){var t=e.name,r=e.display_name,n=C(C(C({},e),t&&{name:t}),r&&{display_name:r});!I&&(0,f.Y4)(n,j)},le=function(e){var t=C(C({},J),{},{offset:0});delete t[e],W(t)},ce=[{label:l.Ut.rhel_version.title.toLowerCase(),type:l.Ut.rhel_version.type,id:l.Ut.rhel_version.urlParam,value:"checkbox-".concat(l.Ut.rhel_version.urlParam),filterValues:{key:"".concat(l.Ut.rhel_version.urlParam,"-filter"),onChange:function(e,t){!function(e,t){t.length>0?W(C(C({},J),{},{offset:0},(0,n.Z)({},e,t))):le(e)}(l.Ut.rhel_version.urlParam,t)},value:J.rhel_version,items:l.Ut.rhel_version.values}}],ue={deleteTitle:N.formatMessage(w.Z.resetFilters),filters:(y=C({},J),delete y.sort,delete y.offset,delete y.limit,(0,f.yK)(y,l.Ut)),onDelete:function(e,t,r){r?W({sort:J.sort,limit:J.limit,offset:J.offset}):t.map((function(e){var t=(0,n.Z)({},e.urlParam,Array.isArray(J[e.urlParam])?J[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?W(C(C({},J),t)):le(e.urlParam)}))}};return(0,c.useEffect)((function(){var e;(null==z||null===(e=z.rows)||void 0===e?void 0:e.length)&&se(z.rows)}),[null==z?void 0:z.rows]),u().createElement(u().Fragment,null,H&&u().createElement(v.Z,{handleModalToggle:ae,isModalOpen:H,rule:D,afterFn:E,hosts:V}),u().createElement(h.Z,{hasCheckbox:!0,initialLoading:!0,autoRefresh:!0,hideFilters:{all:!0,name:!1},filterConfig:{items:ce},activeFiltersConfig:ue,columns:function(e){return function(e){var t=e.filter((function(e){return"updated"===e.key})),r=e.filter((function(e){return"display_name"===e.key})),n=e.filter((function(e){return"system_profile"===e.key}));return r=C(C({},r[0]),{},{transforms:[d.sortable,d.wrappable],props:{isStatic:!0}}),t=C(C({},t[0]),{},{transforms:[d.sortable,d.wrappable],props:{width:20}}),[r,n=C(C({},n[0]),{},{transforms:[d.wrappable]}),t]}(e)},tableProps:C({variant:d.TableVariant.compact},S),customFilters:{advisorFilters:J,selectedTags:j,workloads:T,SID:U},getEntities:function(){var e=(0,a.Z)(o().mark((function e(t,r,n,a){var i,s,c,u,d,p,m,v,h,g,y,k,_,w,x,P,O;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=r.per_page,m=r.page,v=r.orderBy,h=r.orderDirection,g=r.advisorFilters,y=r.selectedTags,k=r.workloads,_=r.SID,w="".concat("ASC"===h?"":"-").concat("updated"===v?"last_seen":v),x=C(C(C(C(C({},g),{},{limit:p,offset:m*p-p,sort:w},r.filters.hostnameOrId&&!I&&{name:null==r||null===(i=r.filters)||void 0===i?void 0:i.hostnameOrId}),r.filters.hostnameOrId&&I&&{display_name:null==r||null===(s=r.filters)||void 0===s?void 0:s.hostnameOrId}),y.length&&{tags:y}),Array.isArray(g.rhel_version)&&{rhel_version:null===(c=g.rhel_version)||void 0===c?void 0:c.join(",")}),k&&(x=C(C({},x),(0,f.s0)(k,_))),oe(x),!I){e.next=20;break}return e.next=8,(0,b.dX)("".concat(l.Vo),{},C(C({},x),{},{pathway:I.slug}));case 8:if(e.t2=u=e.sent,e.t1=null===e.t2,e.t1){e.next=12;break}e.t1=void 0===u;case 12:if(!e.t1){e.next=16;break}e.t3=void 0,e.next=17;break;case 16:e.t3=u.data;case 17:e.t0=e.t3,e.next=32;break;case 20:return e.next=22,(0,b.dX)("".concat(l.cJ).concat(encodeURI(D.rule_id),"/systems_detail/"),{},x);case 22:if(e.t5=d=e.sent,e.t4=null===e.t5,e.t4){e.next=26;break}e.t4=void 0===d;case 26:if(!e.t4){e.next=30;break}e.t6=void 0,e.next=31;break;case 30:e.t6=d.data;case 31:e.t0=e.t6;case 32:return P=e.t0,e.next=35,a(P.data.map((function(e){return e.system_uuid})),{page:m,per_page:p,hasItems:!0,fields:{system_profile:["operating_system"]}},n);case 35:return O=e.sent,e.abrupt("return",Promise.resolve({results:(0,f.E9)(P.data,O.results),total:P.meta.count}));case 37:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),dedicatedAction:u().createElement(_.Z,{key:"remediation-button",isDisabled:0===V.length||!I&&0===(null==D?void 0:D.playbook_count),dataProvider:ne,onRemediationCreated:function(e){return function(e){B(-1,!1);try{e.remediation&&K(e.getNotification())}catch(e){K({variant:"danger",dismissable:!0,title:N.formatMessage(w.Z.error),description:"".concat(e)})}}(e)}},u().createElement(m.ZP,{size:"sm",className:"ins-c-background__default"}),"Â ",N.formatMessage(w.Z.remediate)),actionsConfig:{actions:["",{label:N.formatMessage(w.Z.disableRuleForSystems),props:{isDisabled:0===V.length},onClick:function(){return ae(!0)}}]},bulkSelect:{count:V.length,items:[{title:N.formatMessage(w.Z.selectNone),onClick:function(){B(-1,!1)}},C({},(null==z||null===(t=z.rows)||void 0===t?void 0:t.length)>J.limit?{title:N.formatMessage(w.Z.selectPage,{items:J.limit}),onClick:function(){B(0,!0)}}:{}),C({},(null==z||null===(r=z.rows)||void 0===r?void 0:r.length)>0?{title:N.formatMessage(w.Z.selectAll,{items:(null==z?void 0:z.total)||0}),onClick:(k=(0,a.Z)(o().mark((function e(){var t,r,n,a,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.error(I),!I){e.next=16;break}return e.next=4,(0,b.dX)("".concat(l.Vo),{},{pathway:I.slug,limit:I.impacted_systems_count});case 4:if(e.t2=t=e.sent,e.t1=null===e.t2,e.t1){e.next=8;break}e.t1=void 0===t;case 8:if(!e.t1){e.next=12;break}e.t3=void 0,e.next=13;break;case 12:e.t3=null===(r=t.data)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.map((function(e){return e.system_uuid}));case 13:e.t0=e.t3,e.next=28;break;case 16:return e.next=18,(0,b.dX)("".concat(l.cJ).concat(encodeURI(D.rule_id),"/systems/"),{},{name:J.name});case 18:if(e.t5=a=e.sent,e.t4=null===e.t5,e.t4){e.next=22;break}e.t4=void 0===a;case 22:if(!e.t4){e.next=26;break}e.t6=void 0,e.next=27;break;case 26:e.t6=null===(i=a.data)||void 0===i?void 0:i.host_ids;case 27:e.t0=e.t6;case 28:s=e.t0,console.error(s),X(s),ie();case 32:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)})}:{})],checked:(V.length===(null==z||null===(s=z.rows)||void 0===s?void 0:s.length)||V.length===(null==z?void 0:z.total))&&(null==z?void 0:z.total)>0?1:V.length===J.limit?null:0,onSelect:function(){V.length>0?B(-1,!1):ie(),se()}},fallback:g.Z,onLoad:function(e){var t=e.mergeWithEntities,r=e.INVENTORY_ACTION_TYPES,n=e.mergeWithDetail;F.replaceReducer((0,O.U)(C(C({},t((0,P.V)([],r),{page:Number(J.offset/J.limit+1||1),perPage:Number(J.limit||20)})),n())))}}))};D.propTypes={tableProps:k().any,rule:k().object,afterDisableFn:k().func,pathway:k().object,selectedTags:k().any,workloads:k().any,SID:k().any};const E=D}}]);
//# sourceMappingURL=../sourcemaps/909.927915f55223756408920c1e128cdbdc.js.map