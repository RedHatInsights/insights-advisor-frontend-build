(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[384],{74560:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Y});var r=a(92137),l=a(85061),n=a(96156),i=a(28481),o=a(87757),s=a.n(o),c=(a(55294),a(57149)),u=a(59303),E=a(16530),f=a(13877),m=a(93264),d=a.n(m),R=a(88292),p=a(88678),T=a(76004),_=a(97109),I=a(88931),b=a(71094),g=a(61829),S=a(84785),A=a(6202),C=a(35451),v=a(62410),k=a(44788),y=a(76341),h=a(78216),O=a(46891),L=a(86350),F=a(34702),G=a(57277),P=a(87533),Z=a(83808),x=a(95358),M=a(71355),w=a(40609),D=a(58921),B=a(30893),N=a(28186),j=a(86896),H=a(43707);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Y=function(){var e,t,a=(0,j.Z)(),o=(0,I.useDispatch)(),V=(0,E.useLocation)().search,Y=(0,H.T)("advisor",u.PERMS.export).hasAccess,q=(0,H.T)("advisor",u.PERMS.disableRec).hasAccess,z=(0,m.useState)([{title:a.formatMessage(B.Z.name),transforms:[p.sortable,(0,p.cellWidth)(45)]},{title:a.formatMessage(B.Z.added),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:a.formatMessage(B.Z.totalRisk),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:a.formatMessage(B.Z.riskofchange),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:a.formatMessage(B.Z.systems),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:d().createElement(d().Fragment,null,d().createElement(g.ZP,{size:"md"})," ",a.formatMessage(B.Z.ansible)),transforms:[p.sortable,(0,p.cellWidth)(15),p.fitContent],dataLabel:a.formatMessage(B.Z.ansible)}]),K=(0,i.Z)(z,1)[0],U=(0,I.useSelector)((function(e){return e.AdvisorStore.rules})),J=(0,I.useSelector)((function(e){return e.AdvisorStore.rulesFetchStatus})),Q=(0,I.useSelector)((function(e){return e.AdvisorStore.filters})),X=(0,I.useSelector)((function(e){return e.AdvisorStore.selectedTags})),$=(0,I.useSelector)((function(e){return e.AdvisorStore.workloads})),ee=(0,I.useSelector)((function(e){return e.AdvisorStore.SID})),te=(0,m.useState)([]),ae=(0,i.Z)(te,2),re=ae[0],le=ae[1],ne=(0,m.useState)({}),ie=(0,i.Z)(ne,2),oe=ie[0],se=ie[1],ce=(0,m.useState)(!0),ue=(0,i.Z)(ce,2),Ee=ue[0],fe=ue[1],me=(0,m.useState)((null==Q?void 0:Q.text)||""),de=(0,i.Z)(me,2),Re=de[0],pe=de[1],Te=(0,m.useState)(!1),_e=(0,i.Z)(Te,2),Ie=_e[0],be=_e[1],ge=(0,m.useState)({}),Se=(0,i.Z)(ge,2),Ae=Se[0],Ce=Se[1],ve=(0,m.useState)(!1),ke=(0,i.Z)(ve,2),ye=ke[0],he=ke[1],Oe=(0,m.useState)({}),Le=(0,i.Z)(Oe,2),Fe=Le[0],Ge=Le[1],Pe=function(e){return o((0,M.wN)(e))},Ze=function(e){return o(c.rr(e))},xe=(0,w.Z)(Re,u.DEBOUNCE_DELAY),Me=(null==U||null===(e=U.meta)||void 0===e?void 0:e.count)||0,we={1:"description",2:"publish_date",3:"total_risk",4:"resolution_risk",5:"impacted_count",6:"playbook_count"},De=function(e){var t=e.resolution_set.find((function(e){return e.system_type===u.SYSTEM_TYPES.rhel||u.SYSTEM_TYPES.ocp}));return t?t.resolution_risk.risk:void 0},Be=(0,m.useCallback)((function(){(0,_.Y4)(Q,X);var e=(null==X?void 0:X.length)&&{tags:X.map((function(e){return encodeURIComponent(e)}))};return $&&(e=W(W({},e),(0,_.s0)($,ee))),function(e,t){return o(c.j(e,t))}(e.tags?{}:W(W({},(0,_.qW)(Q)),e),e.tags&&(0,_.gs)(W(W({},(0,_.qW)(Q)),e)))}),[Q,X,$,ee,o]),Ne=function(e){var t=e*Q.limit-Q.limit;Ze(W(W({},Q),{},{offset:t}))},je=function(e){Ze(W(W({},Q),{},{rule_status:e,offset:0},"enabled"!==e&&{impacting:["false"]}))},He=function(){var e=(0,r.Z)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=re[t].rule,e.prev=1,"enabled"!==r.rule_status){e.next=7;break}Ce(r),be(!0),e.next=17;break;case 7:return e.prev=7,e.next=10,b.Z.delete("".concat(u.BASE_URL,"/ack/").concat(r.rule_id,"/"));case 10:Pe({variant:"success",timeout:!0,dismissable:!0,title:a.formatMessage(B.Z.recSuccessfullyEnabled)}),Be(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),Pe({variant:"danger",dismissable:!0,title:a.formatMessage(B.Z.error),description:"".concat(e.t0)});case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(1),Pe({variant:"danger",dismissable:!0,title:"enabled"===r.rule_status?a.formatMessage(B.Z.rulesTableHideReportsErrorDisabled):a.formatMessage(B.Z.rulesTableHideReportsErrorEnabled),description:"".concat(e.t1)});case 22:case"end":return e.stop()}}),e,null,[[1,19],[7,14]])})));return function(t){return e.apply(this,arguments)}}(),Ve=function(e){switch(e){case"enabled":return B.Z.rulesTableNoRuleHitsEnabledRulesBody;case"disabled":return B.Z.rulesTableNoRuleHitsDisabledRulesBody;case"rhdisabled":return B.Z.rulesTableNoRuleHitsRedHatDisabledRulesBody;default:return B.Z.noRecommendations}};(0,m.useEffect)((function(){Ee||null===X||Be()}),[Be,Ee,Q,X]),(0,m.useEffect)((function(){if(V&&Ee){var e=(0,_.yG)();delete e.tags,void 0===e.text?pe(""):pe(e.text),e.sort=void 0===e.sort?"-total_risk":e.sort[0],void 0!==e.has_playbook&&!Array.isArray(e.has_playbook)&&(e.has_playbook=["".concat(e.has_playbook)]),void 0!==e.incident&&!Array.isArray(e.incident)&&(e.incident=["".concat(e.incident)]),void 0===e.offset?e.offset=0:e.offset=Number(e.offset[0]),void 0===e.limit?e.limit=10:e.limit=Number(e.limit[0]),void 0!==e.reboot&&!Array.isArray(e.reboot)&&(e.reboot=["".concat(e.reboot)]),void 0!==e.impacting&&!Array.isArray(e.impacting)&&(e.impacting=["".concat(e.impacting)]),Ze(W(W({},Q),e))}fe(!1)}),[]),(0,m.useEffect)((function(){if(void 0!==Q.sort){var e=Number(Object.entries(we).find((function(e){return e[1]===Q.sort||"-".concat(e[1])===Q.sort}))[0]),t="-"===Q.sort[0]?"desc":"asc";se({index:e,direction:t})}}),[Q.sort]),(0,m.useEffect)((function(){if(U.data)if(0===U.data.length)le([{cells:[{title:d().createElement(F.Z,{icon:C.default,iconClass:"ansibleCheck",title:a.formatMessage(B.Z.rulesTableNoRuleHitsTitle),text:a.formatMessage(Ve(Q.rule_status))},"enabled"===Q.rule_status&&d().createElement(A.Button,{variant:"link",style:{paddingTop:24},onClick:function(){return je("all")}},a.formatMessage(B.Z.rulesTableNoRuleHitsAddDisabledButton))),props:{colSpan:6}}]}]);else{var e=U.data.flatMap((function(e,t){return[{isOpen:!1,rule:e,cells:[{title:d().createElement("span",{key:t},d().createElement(Z.Z,{rule:e}),d().createElement(E.Link,{key:t,to:"/recommendations/".concat(e.rule_id)}," ",e.description," "))},{title:d().createElement(v.Z,{key:t,date:e.publish_date,variant:"relative"})},{title:d().createElement("div",{key:t},d().createElement(T.Tooltip,{key:t,position:T.TooltipPosition.bottom,content:a.formatMessage(B.Z.rulesDetailsTotalriskBody,{risk:u.TOTAL_RISK_LABEL_LOWER[e.total_risk]||a.formatMessage(B.Z.undefined),strong:function(e){return(0,N.f)(e)}})},d().createElement(h.Z,{value:e.total_risk})))},{title:d().createElement("div",{key:t},d().createElement(h.Z,{text:u.RISK_OF_CHANGE_LABEL[De(e)],value:De(e),hideIcon:!0}),d().createElement("div",null))},{title:d().createElement("div",{key:t},"".concat(e.impacted_systems_count.toLocaleString()))},{title:d().createElement("div",{className:"ins-c-center-text ",key:t},e.playbook_count?d().createElement(C.default,{className:"ansibleCheck"}):a.formatMessage(B.Z.no))}]},{parent:2*t,fullWidth:!0,cells:[{title:d().createElement(L.Z,{className:"pf-m-light"},d().createElement(R.Stack,{hasGutter:!0},e.hosts_acked_count?d().createElement(R.StackItem,null,d().createElement(S.ZP,{size:"sm"})," ",e.hosts_acked_count&&!e.impacted_systems_count?a.formatMessage(B.Z.ruleIsDisabledForAllSystems):a.formatMessage(B.Z.ruleIsDisabledForSystemsBody,{systems:e.hosts_acked_count})," "," ",d().createElement(A.Button,{isInline:!0,variant:"link",ouiaId:"viewSystem",onClick:function(){Ge(e),he(!0)}},a.formatMessage(B.Z.viewSystems))):d().createElement(d().Fragment,null),d().createElement(P.Z,{rule:e,resolutionRisk:De(e)})))}]}]}));le(e.asMutable())}}),[U]),(0,m.useEffect)((function(){if(!Ee&&"pending"!==J){var e=W({},Q),t=Re.length?{text:Re}:{};delete e.text,Ze(W(W(W({},e),t),{},{offset:0}))}}),[xe]);var We,Ye=function(e){var t=W(W({},Q),{},{offset:0});"text"===e&&pe(""),delete t[e],Ze(t)},qe=function(e,t){t.length>0?Ze(W(W({},Q),{},{offset:0},(0,n.Z)({},e,t))):Ye(e)},ze=[{label:a.formatMessage(B.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return pe(t)},value:Re,placeholder:a.formatMessage(B.Z.filterBy)}},{label:u.FILTER_CATEGORIES.total_risk.title,type:u.FILTER_CATEGORIES.total_risk.type,id:u.FILTER_CATEGORIES.total_risk.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.total_risk.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.total_risk.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.total_risk.urlParam,t)},value:Q.total_risk,items:u.FILTER_CATEGORIES.total_risk.values}},{label:u.FILTER_CATEGORIES.res_risk.title,type:u.FILTER_CATEGORIES.res_risk.type,id:u.FILTER_CATEGORIES.res_risk.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.res_risk.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.res_risk.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.res_risk.urlParam,t)},value:Q.res_risk,items:u.FILTER_CATEGORIES.res_risk.values}},{label:u.FILTER_CATEGORIES.impact.title,type:u.FILTER_CATEGORIES.impact.type,id:u.FILTER_CATEGORIES.impact.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.impact.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.impact.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.impact.urlParam,t)},value:Q.impact,items:u.FILTER_CATEGORIES.impact.values}},{label:u.FILTER_CATEGORIES.likelihood.title,type:u.FILTER_CATEGORIES.likelihood.type,id:u.FILTER_CATEGORIES.likelihood.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.likelihood.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.likelihood.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.likelihood.urlParam,t)},value:Q.likelihood,items:u.FILTER_CATEGORIES.likelihood.values}},{label:u.FILTER_CATEGORIES.category.title,type:u.FILTER_CATEGORIES.category.type,id:u.FILTER_CATEGORIES.category.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.category.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.category.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.category.urlParam,t)},value:Q.category,items:u.FILTER_CATEGORIES.category.values}},{label:u.FILTER_CATEGORIES.incident.title,type:u.FILTER_CATEGORIES.incident.type,id:u.FILTER_CATEGORIES.incident.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.incident.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.incident.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.incident.urlParam,t)},value:Q.incident,items:u.FILTER_CATEGORIES.incident.values}},{label:u.FILTER_CATEGORIES.has_playbook.title,type:u.FILTER_CATEGORIES.has_playbook.type,id:u.FILTER_CATEGORIES.has_playbook.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.has_playbook.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.has_playbook.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.has_playbook.urlParam,t)},value:Q.has_playbook,items:u.FILTER_CATEGORIES.has_playbook.values}},{label:u.FILTER_CATEGORIES.reboot.title,type:u.FILTER_CATEGORIES.reboot.type,id:u.FILTER_CATEGORIES.reboot.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.reboot.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.reboot.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.reboot.urlParam,t)},value:Q.reboot,items:u.FILTER_CATEGORIES.reboot.values}},{label:u.FILTER_CATEGORIES.rule_status.title,type:u.FILTER_CATEGORIES.rule_status.type,id:u.FILTER_CATEGORIES.rule_status.urlParam,value:"radio-".concat(u.FILTER_CATEGORIES.rule_status.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.rule_status.urlParam,"-filter"),onChange:function(e,t){return je(t)},value:"".concat(Q.rule_status),items:u.FILTER_CATEGORIES.rule_status.values}},{label:u.FILTER_CATEGORIES.impacting.title,type:u.FILTER_CATEGORIES.impacting.type,id:u.FILTER_CATEGORIES.impacting.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.impacting.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.impacting.urlParam,"-filter"),onChange:function(e,t){return qe(u.FILTER_CATEGORIES.impacting.urlParam,t)},value:Q.impacting,items:u.FILTER_CATEGORIES.impacting.values}}],Ke={deleteTitle:a.formatMessage(B.Z.resetFilters),filters:(We=W({},Q),delete We.topic,delete We.sort,delete We.offset,delete We.limit,(0,_.yK)(We,u.FILTER_CATEGORIES)),onDelete:function(e,t,a){a?(pe(""),Ze(W(W({},Q.topic&&{topic:Q.topic}),{},{impacting:["true"],rule_status:"enabled",limit:Q.limit,offset:Q.offset}))):t.map((function(e){var t=(0,n.Z)({},e.urlParam,Array.isArray(Q[e.urlParam])?Q[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?Ze(W(W({},Q),t)):Ye(e.urlParam)}))}};return d().createElement(d().Fragment,null,ye&&d().createElement(x.Z,{handleModalToggle:function(e){return he(e)},isModalOpen:ye,afterFn:function(){Be()},rule:Fe}),Ie&&d().createElement(k.Z,{handleModalToggle:be,isModalOpen:Ie,rule:Ae,afterFn:Be}),d().createElement(G.Z,{pagination:{itemCount:Me,page:Q.offset/Q.limit+1,perPage:Number(Q.limit),onSetPage:function(e,t){Ne(t)},onPerPageSelect:function(e,t){Ze(W(W({},Q),{},{limit:t,offset:0}))},isCompact:!0},exportConfig:(t={label:a.formatMessage(B.Z.exportCsv)},(0,n.Z)(t,"label",a.formatMessage(B.Z.exportJson)),(0,n.Z)(t,"onSelect",(function(e,t){return(0,D.Z)("hits",t,Q,X,$,ee)})),(0,n.Z)(t,"isDisabled",!Y||!Q.impacting||Array.isArray(Q.impacting)&&!Q.impacting.every((function(e){return"true"===e}))),(0,n.Z)(t,"tooltipText",Y?a.formatMessage(B.Z.exportData):a.formatMessage(B.Z.permsAction)),t),filterConfig:{items:ze},activeFiltersConfig:Ke}),"fulfilled"===J&&d().createElement(p.Table,{"aria-label":"rule-table",actionResolver:function(e,t){var r=t.rowIndex,l=re[r].rule?re[r].rule:null;return r%2==0&&l?l&&"enabled"===l.rule_status?[{title:a.formatMessage(B.Z.disableRule),onClick:function(e,t){return He(t)}}]:[{title:a.formatMessage(B.Z.enableRule),onClick:function(e,t){return He(t)}}]:null},onCollapse:function(e,t,a){var r=(0,l.Z)(re);r[t]=W(W({},r[t]),{},{isOpen:a}),le(r)},sortBy:oe,onSort:function(e,t,a){var r="".concat("asc"===a?"":"-").concat(we[t]);se({index:t,direction:a}),Ze(W(W({},Q),{},{sort:r,offset:0}))},cells:K,rows:re,areActionsDisabled:function(){return!q},isStickyHeader:!0},d().createElement(p.TableHeader,null),d().createElement(p.TableBody,null)),"pending"===J&&d().createElement(O.Z,null),"failed"===J&&d().createElement(y.Z,{message:a.formatMessage(B.Z.rulesTableFetchRulesError)}),d().createElement(f.tl,{ouiaId:"page",itemCount:Me,page:Q.offset/Q.limit+1,perPage:Number(Q.limit),onSetPage:function(e,t){Ne(t)},onPerPageSelect:function(e,t){Ze(W(W({},Q),{},{limit:t,offset:0}))},widgetId:"pagination-options-menu-bottom",variant:f.aM.bottom}))}},22080:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(94015),l=a.n(r),n=a(23645),i=a.n(n)()(l());i.push([e.id,".advisor .ansibleCheck{color:var(--pf-global--success-color--100)}@media screen and (min-width: 884px){.advisor .ins-c-conditional-filter .ins-c-conditional-filter__group .pf-c-dropdown__toggle-text{min-width:150px !important}}.advisor .ins-c-center-text{text-align:center}.advisor .pf-c-table tr>:last-child{--pf-c-table--cell--PaddingRight: 0px}\n","",{version:3,sources:["webpack://./src/PresentationalComponents/RulesTable/_RulesTable.scss"],names:[],mappings:"AAAA,uBACc,0CAA0C,CAAC,qCADzD,gGACqL,0BAA0B,CAAE,CADjN,4BACoO,iBAAiB,CADrP,oCACiR,qCAAiC",sourcesContent:[".advisor{\n.ansibleCheck{color:var(--pf-global--success-color--100)}@media screen and (min-width: 884px){.ins-c-conditional-filter .ins-c-conditional-filter__group .pf-c-dropdown__toggle-text{min-width:150px !important}}.ins-c-center-text{text-align:center}.pf-c-table tr>:last-child{--pf-c-table--cell--PaddingRight: 0px}\n\n}"],sourceRoot:""}]);const o=i},55294:(e,t,a)=>{"use strict";var r=a(93379),l=a.n(r),n=a(22080),i=l()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var o=n.default.locals;e.hot.accept(22080,(t=>{n=a(22080),function(e,t,a){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(o,n.default.locals)?(o=n.default.locals,i(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),n.default.locals}}]);
//# sourceMappingURL=../sourcemaps/RulesTable.b275cc60a41889ece163.js.map