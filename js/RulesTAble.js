(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{592:function(e,t,a){(e.exports=a(4)(!1)).push([e.i,".pf-c-check__label #battery_svg{height:1.25rem}\n",""])},803:function(e,t,a){"use strict";a.r(t);var r=a(160),n=a.n(r),o=a(266),i=a.n(o),l=a(804),s=a.n(l),c=a(159),u=a.n(c),E=a(264),f=a.n(E),m=(a(805),a(537)),d=a(13),p=a(271),T=a(1),R=a.n(T),b=a(560),_=a(303),I=a(304),O=a(52),g=a(313),h=a(312),S=a(162),v=a(806),y=a(546),k=a(341),C=a.n(k),A=a(110),F=a(600),L=a.n(F),P=a(80),G=a(93),j=a.n(G),w=a(58),M=a.n(w),x=a(606),B=a(566),N=a(106),D=a(554),H=a(556),V=a(555),z=a(638),J=a(0),K=a.n(J),U=a(650),W=a(643),q=a(639),Q=a(644),X=a(107),Y=a(92),Z=a(807),$=a(29),ee=a(19),te=a(533),ae=a.n(te),re=a(265),ne=a.n(re);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){u()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var le=function(e){var t=e.rules,a=e.filters,r=e.rulesFetchStatus,o=e.setFilters,l=e.fetchRules,c=e.addNotification,E=e.history,m=e.intl,k=Object(T.useState)([{title:m.formatMessage(ee.a.description),transforms:[_.a]},{title:m.formatMessage(ee.a.added),transforms:[_.a,Object(I.a)(15)]},{title:m.formatMessage(ee.a.totalRisk),transforms:[_.a,Object(I.a)(15)]},{title:m.formatMessage(ee.a.systems),transforms:[_.a]},{title:R.a.createElement(R.a.Fragment,null,R.a.createElement(C.a,{size:"md"})," ",m.formatMessage(ee.a.ansible)),transforms:[_.a],dataLabel:m.formatMessage(ee.a.ansible)}]),F=f()(k,1)[0],G=Object(T.useState)([]),w=f()(G,2),J=w[0],K=w[1],X=Object(T.useState)({}),Y=f()(X,2),$=Y[0],te=Y[1],re=Object(T.useState)(a.impacting),ne=f()(re,2),oe=ne[0],le=ne[1],se=Object(T.useState)(10),ce=f()(se,2),ue=ce[0],Ee=ce[1],fe=Object(T.useState)(0),me=f()(fe,2),de=me[0],pe=me[1],Te=Object(T.useState)(!0),Re=f()(Te,2),be=Re[0],_e=Re[1],Ie=Object(T.useState)(""),Oe=f()(Ie,2),ge=Oe[0],he=Oe[1],Se=Object(T.useState)(""),ve=f()(Se,2),ye=ve[0],ke=ve[1],Ce=Object(T.useState)(!1),Ae=f()(Ce,2),Fe=Ae[0],Le=Ae[1],Pe=Object(T.useState)({}),Ge=f()(Pe,2),je=Ge[0],we=Ge[1],Me=Object(T.useState)(!1),xe=f()(Me,2),Be=xe[0],Ne=xe[1],De=Object(T.useState)({}),He=f()(De,2),Ve=He[0],ze=He[1],Je=Object(Z.a)(ye,800),Ke=t.meta?t.meta.count:0,Ue={1:"description",2:"publish_date",3:"total_risk",4:"impacted_count",5:"playbook_count"},We=function(){l(ie({},Object(v.a)(a),{offset:0,limit:ue,impacting:oe}))},qe=function(e){pe(e*ue-ue)},Qe=function(e){var t="undefined"===e?void 0:e;o(ie({},a,{reports_shown:t},"true"!==t&&{impacting:!1})),"true"!==t&&le(!1),pe(0)},Xe=function(){var e=i()(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=J[t].rule,e.prev=1,!a.reports_shown){e.next=7;break}we(a),Le(!0),e.next=10;break;case 7:return e.next=9,y.a.delete("".concat(d.BASE_URL,"/ack/").concat(a.rule_id,"/"));case 9:We();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),c({variant:"danger",dismissable:!0,title:a.reports_shown?m.formatMessage(ee.a.rulesTableHideReportsErrorDisabled):m.formatMessage(ee.a.rulesTableHideReportsErrorEnabled),description:"".concat(e.t0)});case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),Ye=Object(T.useCallback)((function(){pe(0)}),[]);Object(T.useEffect)((function(){if(E.location.search){var e=Object(v.b)(E);e.reports_shown=void 0===e.reports_shown||"undefined"===e.reports_shown[0]?void 0:e.reports_shown,e.sort=void 0===e.sort?"-publish_date":e.sort[0],void 0!==e.incident&&!Array.isArray(e.incident)&&(e.incident=["".concat(e.incident)]),le(e.impacting),o(ie({},e))}_e(!1)}),[]),Object(T.useEffect)((function(){var e=Object(v.c)(a);he(e),E.replace({search:e})}),[a,E]),Object(T.useEffect)((function(){be||l(ie({},Object(v.a)(a),{offset:de,limit:ue}))}),[l,be,a,ue,de]),Object(T.useEffect)((function(){if(void 0!==a.sort){var e=Number(Object.entries(Ue).find((function(e){return e[1]===a.sort||"-".concat(e[1])===a.sort}))[0]),t="-"===a.sort[0]?"desc":"asc";te({index:e,direction:t})}}),[a,a.sort]),Object(T.useEffect)((function(){if(t.data)if(0===t.data.length)K([{cells:[{title:R.a.createElement(V.a,{icon:M.a,iconClass:"ansibleCheck",size:"sm",title:m.formatMessage(ee.a.rulesTableNoRuleHitsTitle),text:a.reports_shown?m.formatMessage(ee.a.rulesTableNoRuleHitsEnabledRulesBody):m.formatMessage(ee.a.rulesTableNoRuleHitsAnyRulesBody)},a.reports_shown&&R.a.createElement(P.Button,{variant:"link",style:{paddingTop:24},onClick:function(){Qe("undefined"),Ye()}},m.formatMessage(ee.a.rulesTableNoRuleHitsAddDisabledButton))),props:{colSpan:5}}]}]);else{var e=t.data.flatMap((function(e,t){return[{isOpen:!1,rule:e,cells:[{title:R.a.createElement("span",{key:t},R.a.createElement(W.a,{rule:e}),R.a.createElement(N.Link,{key:t,to:"/rules/".concat(e.rule_id)}," ",e.description," "))},{title:R.a.createElement("div",{key:t},ae()(e.publish_date).fromNow())},{title:R.a.createElement("div",{className:"pf-m-center",key:t},R.a.createElement(S.Tooltip,{key:t,position:S.TooltipPosition.bottom,content:m.formatMessage(ee.a.rulesDetailsTotalriskBody,{likelihood:d.LIKELIHOOD_LABEL[e.likelihood]||m.formatMessage(ee.a.undefined),impact:d.IMPACT_LABEL[e.impact.impact]||m.formatMessage(ee.a.undefined),strong:function(e){return R.a.createElement("strong",null,e)}})},R.a.createElement(A.Battery,{label:d.TOTAL_RISK_LABEL[e.total_risk]||m.formatMessage(ee.a.undefined),severity:e.total_risk})))},{title:R.a.createElement("div",{key:t}," ",e.reports_shown?"".concat(e.impacted_systems_count.toLocaleString()):m.formatMessage(ee.a.nA))},{title:R.a.createElement("div",{className:"pf-m-center ",key:t},e.playbook_count?R.a.createElement(j.a,{className:"ansibleCheck"}):m.formatMessage(ee.a.no))}]},{parent:2*t,fullWidth:!0,cells:[{title:R.a.createElement(H.Main,{className:"pf-m-light"},R.a.createElement(b.Stack,{gutter:"md"},e.hosts_acked_count?R.a.createElement(b.StackItem,null,R.a.createElement(L.a,{size:"sm"})," ",e.hosts_acked_count&&!e.impacted_systems_count?m.formatMessage(ee.a.ruleIsDisabledForAllSystems):m.formatMessage(ee.a.ruleIsDisabledForSystemsBody,{systems:e.hosts_acked_count}),"  ",R.a.createElement(P.Button,{isInline:!0,variant:"link",onClick:function(){ze(e),Ne(!0)}},m.formatMessage(ee.a.viewSystems))):R.a.createElement(R.a.Fragment,null),R.a.createElement(U.a,{rule:e})))}]}]}));K(e.asMutable())}}),[Ye,a,t,o]),Object(T.useEffect)((function(){void 0===a.text?ke(""):ke(a.text)}),[a.text]),Object(T.useEffect)((function(){if(!be){var e=ie({},a),t=ye.length?{text:ye}:{};delete e.text,o(ie({},e,{},t))}}),[Je]);var Ze=function(e){var t=ie({},a);delete t[e],o(t)},$e=function(e,t){t.length>0?o(ie({},a,{},u()({},e,t))):Ze(e)},et=["",{label:m.formatMessage(oe?ee.a.rulesTableActionShow:ee.a.rulesTableActionHide),onClick:function(){return function(e){o(ie({},a,{impacting:e})),le(e),pe(0)}(!oe)}}],tt=[{label:m.formatMessage(ee.a.description),filterValues:{key:"text-filter",onChange:function(e,t){return ke(t)},value:ye}},{label:d.FILTER_CATEGORIES.total_risk.title,type:d.FILTER_CATEGORIES.total_risk.type,id:d.FILTER_CATEGORIES.total_risk.urlParam,value:"checkbox-".concat(d.FILTER_CATEGORIES.total_risk.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.total_risk.urlParam,"-filter"),onChange:function(e,t){return $e(d.FILTER_CATEGORIES.total_risk.urlParam,t)},value:a.total_risk,items:d.FILTER_CATEGORIES.total_risk.values}},{label:d.FILTER_CATEGORIES.res_risk.title,type:d.FILTER_CATEGORIES.res_risk.type,id:d.FILTER_CATEGORIES.res_risk.urlParam,value:"checkbox-".concat(d.FILTER_CATEGORIES.res_risk.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.res_risk.urlParam,"-filter"),onChange:function(e,t){return $e(d.FILTER_CATEGORIES.res_risk.urlParam,t)},value:a.res_risk,items:d.FILTER_CATEGORIES.res_risk.values}},{label:d.FILTER_CATEGORIES.impact.title,type:d.FILTER_CATEGORIES.impact.type,id:d.FILTER_CATEGORIES.impact.urlParam,value:"checkbox-".concat(d.FILTER_CATEGORIES.impact.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.impact.urlParam,"-filter"),onChange:function(e,t){return $e(d.FILTER_CATEGORIES.impact.urlParam,t)},value:a.impact,items:d.FILTER_CATEGORIES.impact.values}},{label:d.FILTER_CATEGORIES.likelihood.title,type:d.FILTER_CATEGORIES.likelihood.type,id:d.FILTER_CATEGORIES.likelihood.urlParam,value:"checkbox-".concat(d.FILTER_CATEGORIES.likelihood.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.likelihood.urlParam,"-filter"),onChange:function(e,t){return $e(d.FILTER_CATEGORIES.likelihood.urlParam,t)},value:a.likelihood,items:d.FILTER_CATEGORIES.likelihood.values}},{label:d.FILTER_CATEGORIES.category.title,type:d.FILTER_CATEGORIES.category.type,id:d.FILTER_CATEGORIES.category.urlParam,value:"checkbox-".concat(d.FILTER_CATEGORIES.category.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.category.urlParam,"-filter"),onChange:function(e,t){return $e(d.FILTER_CATEGORIES.category.urlParam,t)},value:a.category,items:d.FILTER_CATEGORIES.category.values}},{label:d.FILTER_CATEGORIES.incident.title,type:d.FILTER_CATEGORIES.incident.type,id:d.FILTER_CATEGORIES.incident.urlParam,value:"checkbox-".concat(d.FILTER_CATEGORIES.incident.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.incident.urlParam,"-filter"),onChange:function(e,t){return $e(d.FILTER_CATEGORIES.incident.urlParam,t)},value:a.incident,items:d.FILTER_CATEGORIES.incident.values}},{label:d.FILTER_CATEGORIES.reports_shown.title,type:d.FILTER_CATEGORIES.reports_shown.type,id:d.FILTER_CATEGORIES.reports_shown.urlParam,value:"radio-".concat(d.FILTER_CATEGORIES.reports_shown.urlParam),filterValues:{key:"".concat(d.FILTER_CATEGORIES.reports_shown.urlParam,"-filter"),onChange:function(e,t){return Qe(t)},value:void 0===a.reports_shown?"undefined":"".concat(a.reports_shown),items:d.FILTER_CATEGORIES.reports_shown.values}}],at={filters:function(){var e=ie({},a);delete e.impacting,delete e.topic,delete e.sort;var t=Object.entries(e);return t.length>0?t.map((function(e){if(d.FILTER_CATEGORIES[e[0]]){var t=d.FILTER_CATEGORIES[e[0]],a=Array.isArray(e[1])?e[1].map((function(e){var a=t.values.find((function(t){return t.value===String(e)}));return{name:a.text||a.label,value:e}})):[{name:t.values.find((function(t){return t.value===String(e[1])})).label,value:e[1]}];return{category:t.title,chips:a,urlParam:t.urlParam}}return{category:"Description",chips:[{name:e[1],value:e[1]}],urlParam:e[0]}})):[]}(),onDelete:function(e,t,r){r?o(ie({},a.topic&&{topic:a.topic},{impacting:!0,reports_shown:"true"})):t.map((function(e){var t=u()({},e.urlParam,Array.isArray(a[e.urlParam])?a[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?o(ie({},a,{},t)):Ze(e.urlParam)}))}};return R.a.createElement(R.a.Fragment,null,Be&&R.a.createElement(Q.a,{handleModalToggle:function(e){return Ne(e)},isModalOpen:Be,afterFn:function(){We()},rule:Ve}),Fe&&R.a.createElement(x.a,{handleModalToggle:Le,isModalOpen:Fe,rule:je,afterFn:We}),R.a.createElement(z.PrimaryToolbar,{pagination:{itemCount:Ke,page:de/ue+1,perPage:ue,onSetPage:function(e,t){qe(t)},onPerPageSelect:function(e,t){Ee(t)},isCompact:!1},exportConfig:{onSelect:function(e,t){return window.location="".concat(d.BASE_URL,"/export/hits.").concat("json"===t?"json":"csv","/").concat(ge)},isDisabled:!oe},actionsConfig:{actions:et},filterConfig:{items:tt},activeFiltersConfig:at}),"fulfilled"===r&&R.a.createElement(O.b,{"aria-label":"rule-table",actionResolver:function(e,t){var a=t.rowIndex,r=J[a].rule?J[a].rule:null;return a%2==0&&r?r&&r.reports_shown?[{title:m.formatMessage(ee.a.disableRule),onClick:function(e,t){return Xe(t)}}]:[{title:m.formatMessage(ee.a.enableRule),onClick:function(e,t){return Xe(t)}}]:null},onCollapse:function(e,t,a){var r=s()(J);r[t]=ie({},r[t],{isOpen:a}),K(r)},sortBy:$,onSort:function(e,t,r){var n="".concat("asc"===r?"":"-").concat(Ue[t]);te({index:t,direction:r}),o(ie({},a,{sort:n})),pe(0)},cells:F,rows:J},R.a.createElement(g.a,null),R.a.createElement(h.a,null)),"pending"===r&&R.a.createElement(D.a,null),"failed"===r&&R.a.createElement(B.a,{message:m.formatMessage(ee.a.rulesTableFetchRulesError)}),R.a.createElement(q.TableToolbar,null,R.a.createElement(p.Pagination,{itemCount:Ke,perPage:ue,page:de/ue+1,onSetPage:function(e,t){qe(t)},widgetId:"pagination-options-menu-bottom",variant:p.PaginationVariant.bottom})))};le.propTypes={fetchRules:K.a.func,rulesFetchStatus:K.a.string,rules:K.a.object,filters:K.a.object,addNotification:K.a.func,setFilters:K.a.func,history:K.a.object,intl:K.a.any};t.default=Object($.c)(ne()(Object(Y.connect)((function(e,t){return ie({rules:e.AdvisorStore.rules,rulesFetchStatus:e.AdvisorStore.rulesFetchStatus,filters:e.AdvisorStore.filters},t)}),(function(e){return{fetchRules:function(t){return e(m.d(t))},addNotification:function(t){return e(Object(X.addNotification)(t))},setFilters:function(t){return e(m.m(t))}}}))(le)))},805:function(e,t,a){var r=a(592);"string"==typeof r&&(r=[[e.i,r,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0},o=a(5)(r,n);r.locals&&(e.exports=r.locals),e.hot.accept(592,(function(){var t=a(592);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var a,r=0;for(a in e){if(!t||e[a]!==t[a])return!1;r++}for(a in t)r--;return 0===r}(r.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");o(t)})),e.hot.dispose((function(){o()}))}}]);
//# sourceMappingURL=RulesTAble.js.map