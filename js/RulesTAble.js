(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{645:function(e,t,a){"use strict";a.r(t);var r=a(162),n=a.n(r),l=a(274),o=a.n(l),c=a(570),s=a.n(c),i=a(161),u=a.n(i),f=a(540),m=a.n(f),p=a(582),b=a.n(p),d=a(2),h=a.n(d),g=a(368),v=a(273),O=a.n(v),E=a(1),y=a.n(E),j=a(239),w=a(213),k=a(241),T=a(533),S=a.n(T),P=a(86),C=a(79),x=a(282),F=a(290),_=a(350),A=a(299),M=a(17),R=a(300),N=a(285),D=a(296),H=a(324),B=a(325),I=a(44),J=a(351),L=a(349),z=a(87),U=a(31),W=a(535),q=a(539),G=a(569),K=a(320),Q=a(319),V=a(298),X=a(262),Y=a(321),Z=a(118),$=a(18),ee=a(634),te=a(201),ae=a(127),re=a(297),ne=a(144),le=a(534);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var ce=function(e){var t=e.filters,a=e.removeFilter,r=e.removeAllFilters,n=e.intl,l=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(a,!0).forEach((function(t){u()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t);delete l.text,delete l.impacting,delete l.reports_shown,delete l.topic;var o=Object.entries(l);return o.length>0&&h.a.createElement(h.a.Fragment,null,h.a.createElement(ae.a,{withToolbar:!0,numChips:4},o.map((function(e){var t=$.d.find((function(t){return t.urlParam===e[0]}));return h.a.createElement(re.a,{key:e[0],categoryName:t.title},e[1].split(",").map((function(e){var r=t.values.find((function(t){return t.value===String(e)}));return h.a.createElement(ne.a,{key:e,onClick:function(){return a(t.urlParam,r.value)}},r.label)})))}))),h.a.createElement(x.a,{variant:"link",onClick:function(){return r()}},n.formatMessage(le.a.filterChipsClearAll)))};ce.propTypes={filters:y.a.object,removeFilter:y.a.func,removeAllFilters:y.a.func,intl:y.a.any};var se=Object(U.c)(ce);function ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ie(a,!0).forEach((function(t){u()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ie(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var fe=function(e){var t=e.children,a=e.searchPlaceholder,r=e.filters,n=e.hideCategories,l=e.setFilters,o=e.fetchAction,c=Object(d.useState)(""),s=m()(c,2),i=s[0],f=s[1],p=Object(ee.a)(i,800),b=h.a.Children.toArray(t),v=b.pop(),O=function(e,t){var a=u()({},e,r[e].split(",").filter((function(e){return Number(e)!==Number(t)})).join(","));if(a[e].length)l(ue({},r,{},a)),o(ue({},r,{},a));else{var n=ue({},r);delete n[e],l(n),o(n)}};return Object(d.useEffect)((function(){f(r.text),void 0===r.text&&f("")}),[r.text]),Object(d.useEffect)((function(){var e=ue({},r),t=i.length?{text:i}:{};delete e.text,l(ue({},e,{},t)),o(ue({},e,{},t))}),[p]),h.a.createElement(h.a.Fragment,null,h.a.createElement(K.a,null,h.a.createElement(Q.a,{className:"pf-u-mr-xl"},h.a.createElement(V.a,null,h.a.createElement(X.a,{name:"search-input","aria-label":"Search",id:"insights-search-input",type:"search",value:i,placeholder:a,onChange:f}),h.a.createElement(x.a,{variant:x.c.tertiary,"aria-label":"search button for search input"},h.a.createElement(te.b,null)))),h.a.createElement(Q.a,{className:"pf-u-mr-md"},h.a.createElement(g.FilterDropdown,{filters:r,addFilter:function(e,t,a){var n;switch(a){case"checkbox":n=r[e]?u()({},e,"".concat(r[e],",").concat(t)):u()({},e,t);break;case"radio":n=u()({},e,t)}l(ue({},r,{},n)),o(ue({},r,{},n))},removeFilter:O,hideCategories:n,filterCategories:$.d})),h.a.Children.map(b,(function(e){return h.a.createElement(Q.a,null," ",e," ")}))),h.a.createElement(K.a,null,h.a.createElement(Q.a,null,v)),h.a.createElement(Y.a,{"aria-label":"Filter Chips Section"},h.a.createElement(K.a,null,h.a.createElement(Q.a,null,h.a.createElement(se,{filters:r,fetchAction:o,removeFilter:O,removeAllFilters:function(){var e={impacting:!0,reports_shown:!0};l(e),o(e)}})))))};fe.propTypes={children:y.a.any,hideCategories:y.a.array,searchPlaceholder:y.a.string,filters:y.a.object,setFilters:y.a.func,fetchAction:y.a.func,results:y.a.number};var me=O()(Object(C.connect)((function(e,t){return ue({filters:e.AdvisorStore.filters},t)}),(function(e){return Object(Z.a)({setFilters:function(e){return W.j(e)}},e)}))(fe)),pe=a(596),be=a(548),de=a(646);function he(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?he(a,!0).forEach((function(t){u()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):he(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ve=function(e){var t=e.rules,a=e.filters,r=e.rulesFetchStatus,l=e.setFilters,c=e.fetchRules,i=e.addNotification,f=e.history,p=e.intl,v=Object(d.useState)([{title:p.formatMessage(le.a.rulesTableColumnTitleRule),transforms:[H.a]},{title:p.formatMessage(le.a.rulesTableColumnTitleAdded),transforms:[H.a,Object(B.a)(15)]},{title:p.formatMessage(le.a.rulesTableColumnTitleTotalrisk),transforms:[H.a]},{title:p.formatMessage(le.a.systems),transforms:[H.a]},{title:h.a.createElement(h.a.Fragment,null,h.a.createElement(j.b,{size:"md"})," ",p.formatMessage(le.a.rulesTableColumnTitleAnsible)),transforms:[H.a],dataLabel:p.formatMessage(le.a.rulesTableColumnTitleAnsible)}]),O=m()(v,1)[0],E=Object(d.useState)([]),y=m()(E,2),T=y[0],C=y[1],z=Object(d.useState)({}),U=m()(z,2),W=U[0],K=U[1],Q=Object(d.useState)("-publish_date"),V=m()(Q,2),X=V[0],Y=V[1],Z=Object(d.useState)(a.impacting),ee=m()(Z,2),te=ee[0],ae=ee[1],re=Object(d.useState)(10),ne=m()(re,2),oe=ne[0],ce=ne[1],se=Object(d.useState)(0),ie=m()(se,2),ue=ie[0],fe=ie[1],he=Object(d.useState)(!1),ve=m()(he,2),Oe=ve[0],Ee=ve[1],ye=Object(d.useState)(!0),je=m()(ye,2),we=je[0],ke=je[1],Te=t.meta?t.meta.count:0,Se=Object(d.useCallback)((function(e,t,a){var r="".concat("asc"===a?"":"-").concat({1:"description",2:"publish_date",3:"total_risk",4:"impacted_count",5:"playbook_count"}[t]);K({index:t,direction:a}),Y(r),fe(0)}),[Y,K,fe]),Pe=function(e,t){fe(t*oe-oe)},Ce=function(e,t){ce(t)},xe=function(){var e=o()(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=T[t].rule,e.prev=1,!r.reports_shown){e.next=7;break}return e.next=5,pe.a.post("".concat($.a,"/ack/"),{rule_id:r.rule_id});case 5:e.next=9;break;case 7:return e.next=9,pe.a.delete("".concat($.a,"/ack/").concat(r.rule_id,"/"));case 9:c(ge({},a,{offset:0,limit:oe,impacting:te,sort:X})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),i({variant:"danger",dismissable:!0,title:r.reports_shown?p.formatMessage(le.a.rulesTableHideReportsErrorDisabled):p.formatMessage(le.a.rulesTableHideReportsErrorEnabled),description:p.formatMessage(le.a.rulesTableHideReportsErrorBody,{ruleName:r.description})});case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),Fe=Object(d.useCallback)((function(){fe(0)}),[]);Object(d.useEffect)((function(){if(f.location.search){var e=new URLSearchParams(f.location.search),t=Array.from(e).reduce((function(e,t){var a=m()(t,2),r=a[0],n=a[1];return ge({},e,u()({},r,"true"===n||"false"===n?JSON.parse(n):n))}),{}),a={};"undefined"===t.reports_shown&&(a={reports_shown:void 0}),ae(t.impacting),l(ge({},t,{},a))}ke(!1)}),[]),Object(d.useEffect)((function(){var e=Object.keys(a).map((function(e){return e+"="+a[e]})).join("&");f.replace({search:"?".concat(e)})}),[a,f]),Object(d.useEffect)((function(){we||c(ge({},a,{offset:ue,limit:oe,sort:X}))}),[c,we,a,oe,ue,X]),Object(d.useEffect)((function(){T.length||Se(null,2,"desc")}),[Se,T.length]),Object(d.useEffect)((function(){if(t.data)if(0===t.data.length)C([{cells:[{title:h.a.createElement(be.a,{icon:w.b,title:p.formatMessage(le.a.rulesTableNoRuleHitsTitle),text:a.reports_shown?p.formatMessage(le.a.rulesTableNoRuleHitsEnabledRulesBody):p.formatMessage(le.a.rulesTableNoRuleHitsAnyRulesBody)},a.reports_shown&&h.a.createElement(x.a,{variant:"link",style:{paddingTop:24},onClick:function(){l(ge({},a,{reports_shown:void 0})),Fe()}},p.formatMessage(le.a.rulesTableNoRuleHitsAddDisabledButton))),props:{colSpan:5}}]}]);else{var e=t.data.map((function(e,t){return[{isOpen:!1,rule:e,cells:[{title:e.reports_shown?h.a.createElement(P.Link,{key:t,to:"/rules/".concat(e.rule_id)},e.description):h.a.createElement("span",{key:t}," ",h.a.createElement(F.a,{isRead:!0},p.formatMessage(le.a.disabled))," ",e.description)},{title:h.a.createElement("div",{key:t},S()(e.publish_date).fromNow())},{title:h.a.createElement("div",{className:"pf-m-center",key:t,style:{verticalAlign:"top"}},h.a.createElement(g.Battery,{label:p.formatMessage(le.a.rulesTableColumnTitleTotalrisk),labelHidden:!0,severity:e.total_risk}))},{title:h.a.createElement("div",{key:t}," ",e.reports_shown?"".concat(e.impacted_systems_count.toLocaleString()):p.formatMessage(le.a.notapplicable))},{title:h.a.createElement("div",{className:"pf-m-center ",key:t},e.playbook_count?h.a.createElement(w.b,{className:"ansibleCheck"}):null)}]},{parent:2*t,fullWidth:!0,cells:[{title:h.a.createElement(g.Main,{className:"pf-m-light"}," ",h.a.createElement(de.a,{rule:e}))}]}]}));C(b()(e))}}),[Fe,a,t,l]);var _e=function(e){return h.a.createElement(_.a,{itemCount:Te,perPage:oe,page:ue/oe+1,onSetPage:Pe,onPerPageSelect:Ce,widgetId:"pagination-options-menu-".concat("bottom"===e?"bottom":"top"),variant:"bottom"===e?_.b.bottom:null})};return h.a.createElement(h.a.Fragment,null,h.a.createElement(g.TableToolbar,{style:{justifyContent:"space-between"}},h.a.createElement(me,{fetchAction:Fe,searchPlaceholder:p.formatMessage(le.a.rulesTableFilterInputText),results:Te},h.a.createElement(A.a,{position:M.d.left,toggle:h.a.createElement(R.a,{onToggle:function(e){Ee(e)}}),onSelect:function(){Ee(!1)},isOpen:Oe,isPlain:!0,dropdownItems:[h.a.createElement(N.a,{value:"json",href:"".concat($.a,"/export/hits.json/"),key:"export json","aria-label":"export data json"},h.a.createElement(k.b,null)," ",p.formatMessage(le.a.rulesTableActionExportJson)),h.a.createElement(N.a,{value:"csv",href:"".concat($.a,"/export/hits.csv/"),key:"export csv","aria-label":"export data csv"},h.a.createElement(k.b,null)," ",p.formatMessage(le.a.rulesTableActionExportCsv))]}),h.a.createElement(D.a,{label:p.formatMessage(le.a.rulesTableActionShowrulehits),isChecked:te,onChange:function(e){l(ge({},a,{impacting:e})),ae(e),fe(0)},"aria-label":"InsightsRulesHideHits",id:"InsightsRulesHideHits"}),_e())),"fulfilled"===r&&h.a.createElement(I.b,{"aria-label":"rule-table",actionResolver:function(e,t){var a=t.rowIndex,r=T[a].rule?T[a].rule:null;return a%2==0&&r?r&&r.reports_shown?[{title:p.formatMessage(le.a.rulesTableActionDisableRule),onClick:function(e,t){return xe(t)}}]:[{title:p.formatMessage(le.a.rulesTableActionEnableRule),onClick:function(e,t){return xe(t)}}]:null},onCollapse:function(e,t,a){var r=s()(T);r[t]=ge({},r[t],{isOpen:a}),C(r)},sortBy:W,onSort:Se,cells:O,rows:T},h.a.createElement(J.a,null),h.a.createElement(L.a,null)),"pending"===r&&h.a.createElement(q.a,null),"failed"===r&&h.a.createElement(G.a,{message:p.formatMessage(le.a.rulesTableFetchRulesError)}),h.a.createElement(g.TableToolbar,null,_e("bottom")))};ve.propTypes={fetchRules:y.a.func,rulesFetchStatus:y.a.string,rules:y.a.object,filters:y.a.object,addNotification:y.a.func,setFilters:y.a.func,history:y.a.object,intl:y.a.any};t.default=Object(U.c)(O()(Object(C.connect)((function(e,t){return ge({rules:e.AdvisorStore.rules,rulesFetchStatus:e.AdvisorStore.rulesFetchStatus,filters:e.AdvisorStore.filters},t)}),(function(e){return{fetchRules:function(t){return e(W.b(t))},addNotification:function(t){return e(Object(z.addNotification)(t))},setFilters:function(t){return e(W.j(t))}}}))(ve)))}}]);