(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[137],{75331:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(70885),a=n(93264),o=n.n(a),s=n(85991),i=n(49489),l=n(75662),c=n(45697),u=n.n(c),d=n(30893),f=n(75546),p=n(86896),m=function(e){var t,n=e.current,c=(0,p.Z)(),u=null===(t=(0,l.useLocation)().pathname)||void 0===t?void 0:t.split("/"),m=(0,a.useState)([]),v=(0,r.Z)(m,2),g=v[0],h=v[1],b=!("recommendations"===u[1]&&4===u.length)||"pathways"===u[2],y=(0,f.m1)({ruleId:u[2]},{skip:b}),k=y.data,w=y.isFetching;return(0,a.useEffect)((function(){var e;(e=[]).push({title:"".concat(c.formatMessage(d.Z.insightsHeader)," ").concat(u[1]),navigate:"/".concat(u[1])}),b||e.push({title:null==k?void 0:k.description,navigate:"/".concat(u[1],"/").concat(u[2])}),"pathways"===u[2]&&(e=[{title:"Advisor pathways",navigate:"/recommendations/pathways"}]),h(e)}),[k]),o().createElement(o().Fragment,null,!w&&g.length>0?o().createElement(s.a,{ouiaId:"detail"},g.map((function(e,t){return o().createElement(i.g,{key:t},o().createElement(l.Link,{to:e.navigate},e.title))})),o().createElement(i.g,{isActive:!0},n)):c.formatMessage(d.Z.loading))};m.propTypes={current:u().string};const v=m},40771:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var r=n(4942),a=n(15861),o=n(70885),s=n(87757),i=n.n(s),l=n(59303),c=n(93264),u=n.n(c),d=n(30381),f=n(97109),p=n(28216),m=n(44788),v=n(71094),g=n(33739),h=n(46891),b=n(45697),y=n.n(b),k=n(98132),w=n(30893),x=n(71355),_=n(46655),Z=n(41131),E=n(86896),P=n(58921);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t,n,s,b,y,O,T,C=e.tableProps,D=e.rule,I=e.afterDisableFn,F=e.pathway,M=e.selectedTags,j=e.workloads,U=e.SID,A=e.permsExport,N=e.exportTable,R=e.showTags,L=(0,p.useStore)(),V=(0,E.Z)(),X=(0,p.useDispatch)(),Y=(0,c.useState)([]),J=(0,o.Z)(Y,2),W=J[0],B=J[1],H=(0,c.useState)({limit:20,offset:0,sort:"-last_seen",name:""}),K=(0,o.Z)(H,2),q=K[0],z=K[1],G=(0,p.useSelector)((function(e){return e.entities||{}})),Q=function(e,t){return X({type:"SELECT_ENTITY",payload:{id:e,selected:t}})},$=function(e){return X((0,x.wN)(e))},ee=(0,c.useState)(!1),te=(0,o.Z)(ee,2),ne=te[0],re=te[1],ae=(0,c.useState)(),oe=(0,o.Z)(ae,2),se=oe[0],ie=oe[1],le=function(){var e=(0,a.Z)(i().mark((function e(){var t,n,r,a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!F){e.next=30;break}return e.next=3,(0,v.dX)("".concat(l._n,"/pathway/").concat(encodeURI(F.slug),"/rules/"),{},{});case 3:if(e.t1=t=e.sent,e.t0=null===e.t1,e.t0){e.next=7;break}e.t0=void 0===t;case 7:if(!e.t0){e.next=11;break}e.t2=void 0,e.next=12;break;case 11:e.t2=t.data.data;case 12:return r=e.t2,e.next=15,(0,v.dX)("".concat(l._n,"/pathway/").concat(encodeURI(F.slug),"/reports/"),{},{});case 15:if(e.t4=n=e.sent,e.t3=null===e.t4,e.t3){e.next=19;break}e.t3=void 0===n;case 19:if(!e.t3){e.next=23;break}e.t5=void 0,e.next=24;break;case 23:e.t5=n.data.rules;case 24:return a=e.t5,o=[],r.forEach((function(e){var t=[];a[e.rule_id].forEach((function(e){W.includes(e)&&t.push(e)})),t.length&&o.push({id:"advisor:".concat(e.rule_id),description:e.description,systems:t})})),e.abrupt("return",{issues:o});case 30:return e.abrupt("return",{issues:[{id:"advisor:".concat(D.rule_id),description:D.description}],systems:W});case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(e){re(e)},ue=function(){ie(!0),Q(0,!0)},de=function(){var e;return se?ie(!1):B(null==G||null===(e=G.rows)||void 0===e?void 0:e.filter((function(e){return!0===e.selected})).map((function(e){return e.id})))},fe=function(e){var t=e.name,n=e.display_name,r=S(S(S({},e),t&&{name:t}),n&&{display_name:n});!F&&(0,f.Y4)(r,M)},pe=function(e){var t=S(S({},q),{},{offset:0});delete t[e],z(t)},me=[{label:l.Ut.rhel_version.title.toLowerCase(),type:l.Ut.rhel_version.type,id:l.Ut.rhel_version.urlParam,value:"checkbox-".concat(l.Ut.rhel_version.urlParam),filterValues:{key:"".concat(l.Ut.rhel_version.urlParam,"-filter"),onChange:function(e,t){!function(e,t){t.length>0?z(S(S({},q),{},{offset:0},(0,r.Z)({},e,t))):pe(e)}(l.Ut.rhel_version.urlParam,t)},value:q.rhel_version,items:l.Ut.rhel_version.values}}],ve={deleteTitle:V.formatMessage(w.Z.resetFilters),filters:(y=S({},q),delete y.sort,delete y.offset,delete y.limit,(0,f.yK)(y,l.Ut)),onDelete:function(e,t,n){n?z({sort:q.sort,limit:q.limit,offset:q.offset}):t.map((function(e){var t=(0,r.Z)({},e.urlParam,Array.isArray(q[e.urlParam])?q[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?z(S(S({},q),t)):pe(e.urlParam)}))}};return(0,c.useEffect)((function(){var e;(null==G||null===(e=G.rows)||void 0===e?void 0:e.length)&&de(G.rows)}),[null==G?void 0:G.rows]),u().createElement(u().Fragment,null,ne&&u().createElement(m.Z,{handleModalToggle:ce,isModalOpen:ne,rule:D,afterFn:I,hosts:W}),u().createElement(g.Z,{id:"tablesContainer",hasCheckbox:!0,initialLoading:!0,autoRefresh:!0,hideFilters:{all:!0,name:!1,tags:!R},filterConfig:{items:me},activeFiltersConfig:ve,columns:function(e){return function(e){var t=e.filter((function(e){return"updated"===e.key})),n=e.filter((function(e){return"display_name"===e.key})),r=e.filter((function(e){return"system_profile"===e.key})),a=e.filter((function(e){return"tags"===e.key}));return n=S(S({},n[0]),{},{transforms:[d.sortable,d.wrappable],props:{isStatic:!0}}),t=S(S({},t[0]),{},{transforms:[d.sortable,d.wrappable],props:{width:20}}),r=S(S({},r[0]),{},{transforms:[d.wrappable]}),[n,a=S({},a[0]),r,t]}(e)},tableProps:S({variant:d.TableVariant.compact},C),customFilters:{advisorFilters:q,selectedTags:M,workloads:j,SID:U},showTags:R,getEntities:function(){var e=(0,a.Z)(i().mark((function e(t,n,r,a){var o,s,c,u,d,p,m,g,h,b,y,k,w,x,_,Z,E,P;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m=n.per_page,g=n.page,h=n.orderBy,b=n.orderDirection,y=n.advisorFilters,k=n.filters,w=n.workloads,x=n.SID,_="".concat("ASC"===b?"":"-").concat("updated"===h?"last_seen":h),Z=S(S(S(S(S({},y),{},{limit:m,offset:g*m-m,sort:_},n.filters.hostnameOrId&&!F&&{name:null==n||null===(o=n.filters)||void 0===o?void 0:o.hostnameOrId}),n.filters.hostnameOrId&&F&&{display_name:null==n||null===(s=n.filters)||void 0===s?void 0:s.hostnameOrId}),Array.isArray(y.rhel_version)&&{rhel_version:null===(c=y.rhel_version)||void 0===c?void 0:c.join(",")}),(null===(u=k.tagFilters)||void 0===u?void 0:u.length)&&(0,f.gh)(k.tagFilters)),w&&(Z=S(S({},Z),(0,f.s0)(w,x))),fe(Z),!F){e.next=20;break}return e.next=8,(0,v.dX)("".concat(l.Vo),{},S(S({},Z),{},{pathway:F.slug}));case 8:if(e.t2=d=e.sent,e.t1=null===e.t2,e.t1){e.next=12;break}e.t1=void 0===d;case 12:if(!e.t1){e.next=16;break}e.t3=void 0,e.next=17;break;case 16:e.t3=d.data;case 17:e.t0=e.t3,e.next=32;break;case 20:return e.next=22,(0,v.dX)("".concat(l.cJ).concat(encodeURI(D.rule_id),"/systems_detail/"),{},Z);case 22:if(e.t5=p=e.sent,e.t4=null===e.t5,e.t4){e.next=26;break}e.t4=void 0===p;case 26:if(!e.t4){e.next=30;break}e.t6=void 0,e.next=31;break;case 30:e.t6=p.data;case 31:e.t0=e.t6;case 32:return E=e.t0,e.next=35,a(E.data.map((function(e){return e.system_uuid})),{page:g,per_page:m,hasItems:!0,fields:{system_profile:["operating_system"]}},r);case 35:return P=e.sent,e.abrupt("return",Promise.resolve({results:(0,f.E9)(E.data,P.results),total:E.meta.count}));case 37:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),dedicatedAction:u().createElement(k.Z,{key:"remediation-button",isDisabled:0===W.length||!F&&0===(null==D?void 0:D.playbook_count),dataProvider:le,onRemediationCreated:function(e){return function(e){Q(-1,!1);try{e.remediation&&$(e.getNotification())}catch(e){$({variant:"danger",dismissable:!0,title:V.formatMessage(w.Z.error),description:"".concat(e)})}}(e)}},V.formatMessage(w.Z.remediate)),actionsConfig:{actions:["",{label:V.formatMessage(w.Z.disableRuleForSystems),props:{isDisabled:0===W.length},onClick:function(){return ce(!0)}}]},bulkSelect:{count:W.length,items:[{title:V.formatMessage(w.Z.selectNone),onClick:function(){Q(-1,!1)}},{title:V.formatMessage(w.Z.selectPage,{items:null==G||null===(t=G.rows)||void 0===t?void 0:t.length}),onClick:function(){Q(0,!0)}},S({},(null==G||null===(n=G.rows)||void 0===n?void 0:n.length)>0?{title:V.formatMessage(w.Z.selectAll,{items:(null==G?void 0:G.total)||0}),onClick:(T=(0,a.Z)(i().mark((function e(){var t,n,r,a,o,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.error(F),!F){e.next=16;break}return e.next=4,(0,v.dX)("".concat(l.Vo),{},{pathway:F.slug,limit:F.impacted_systems_count});case 4:if(e.t2=t=e.sent,e.t1=null===e.t2,e.t1){e.next=8;break}e.t1=void 0===t;case 8:if(!e.t1){e.next=12;break}e.t3=void 0,e.next=13;break;case 12:e.t3=null===(n=t.data)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.map((function(e){return e.system_uuid}));case 13:e.t0=e.t3,e.next=28;break;case 16:return e.next=18,(0,v.dX)("".concat(l.cJ).concat(encodeURI(D.rule_id),"/systems/"),{},{name:q.name});case 18:if(e.t5=a=e.sent,e.t4=null===e.t5,e.t4){e.next=22;break}e.t4=void 0===a;case 22:if(!e.t4){e.next=26;break}e.t6=void 0,e.next=27;break;case 26:e.t6=null===(o=a.data)||void 0===o?void 0:o.host_ids;case 27:e.t0=e.t6;case 28:s=e.t0,console.error(s),B(s),ue();case 32:case"end":return e.stop()}}),e)}))),function(){return T.apply(this,arguments)})}:{})],checked:(W.length===(null==G||null===(O=G.rows)||void 0===O?void 0:O.length)||W.length===(null==G?void 0:G.total))&&(null==G?void 0:G.total)>0?1:W.length===q.limit||W.length>0?null:0,onSelect:function(){W.length>0?Q(-1,!1):ue(),de()}},fallback:h.Z,onLoad:function(e){var t=e.mergeWithEntities,n=e.INVENTORY_ACTION_TYPES,r=e.mergeWithDetail;L.replaceReducer((0,Z.U)(S(S({},t((0,_.V)([],n),{page:Number(q.offset/q.limit+1||1),perPage:Number(q.limit||20)})),r())))},exportConfig:A&&(b={label:V.formatMessage(w.Z.exportCsv)},(0,r.Z)(b,"label",V.formatMessage(w.Z.exportJson)),(0,r.Z)(b,"onSelect",(function(e,t){return(0,P.Z)(N,t,S({rule_id:D.rule_id},q),M,j,U,X)})),(0,r.Z)(b,"isDisabled",!A||0===(null==G||null===(s=G.rows)||void 0===s?void 0:s.length)),(0,r.Z)(b,"tooltipText",A?V.formatMessage(w.Z.exportData):V.formatMessage(w.Z.permsAction)),b)}))};T.propTypes={tableProps:y().any,rule:y().object,afterDisableFn:y().func,pathway:y().object,selectedTags:y().any,workloads:y().any,SID:y().any,permsExport:y().bool,exportTable:y().string,showTags:y().bool};const C=T},58392:()=>{}}]);
//# sourceMappingURL=../sourcemaps/137.0b397254cec83b54536a969e1972e0d5.js.map