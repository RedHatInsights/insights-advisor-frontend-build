"use strict";(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[313],{8584:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var a=n(15861),r=n(29439),s=n(87757),l=n.n(s),c=n(59303),i=n(56161),o=n(71094),u=n(48716),d=n(39173),m=n(93264),f=n.n(m),g=n(88931),p=n(84785),v=n(75331),E=n(6202),Z=n(96466),h=n(62410),b=n(44788),k=n(22910),_=n(96823),y=n(80765),w=n(76341),M=n(36001),D=n(42057),I=n(40771),S=n(23218),F=n(46891),C=n(86350),x=n(34702),O=n(87533),R=n(87516),T=n(34348),B=n(16545),N=n(95358),P=n(57520),H=n(30893),L=n(71355),z=n(77647),A=n(75546),j=n(77187),G=n(86896),J=n(73685),V=n(43707);const X=function(){var e=(0,G.Z)(),t=(0,g.useDispatch)(),n=(0,g.useSelector)((function(e){return e.filters.selectedTags})),s=(0,g.useSelector)((function(e){return e.filters.workloads})),X=(0,g.useSelector)((function(e){return e.filters.SID})),Y=(0,J.useParams)().id,q=function(e){return t((0,L.wN)(e))},K=(0,A.m1)({ruleId:Y}),Q=K.data,U=void 0===Q?{}:Q,W=K.isFetching,$=K.isError,ee=K.refetch,te=(0,z.yr)({ruleId:Y}),ne=te.data,ae=void 0===ne?{}:ne,re=te.isFetching,se=te.refetch,le=(0,j.Fe)(),ce=le.data,ie=void 0===ce?[]:ce,oe=le.isFetching,ue=(0,V.T)("advisor",c.Gd.disableRec).hasAccess,de=(0,m.useState)(!1),me=(0,r.Z)(de,2),fe=me[0],ge=me[1],pe=(0,m.useState)(!1),ve=(0,r.Z)(pe,2),Ee=ve[0],Ze=ve[1],he=(0,m.useState)(void 0),be=(0,r.Z)(he,2),ke=be[0],_e=be[1],ye=(0,m.useState)(!1),we=(0,r.Z)(ye,2),Me=we[0],De=we[1],Ie=function(e){var t,n=null==e||null===(t=e.resolution_set)||void 0===t?void 0:t.find((function(e){return e.system_type===c.CO.rhel||c.CO.ocp}));return n?n.resolution_risk.risk:void 0},Se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;Ze(e),_e(t)},Fe=function(){var t=(0,a.Z)(l().mark((function t(n){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,o.Sp)("".concat(c._n,"/ack/").concat(n.rule_id,"/"));case 3:q({variant:"success",timeout:!0,dismissable:!0,title:e.formatMessage(H.Z.recSuccessfullyEnabled)}),ee(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),Se(!1),q({variant:"danger",dismissable:!0,title:e.formatMessage(H.Z.error),description:"".concat(t.t0)});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),Ce=function(){var e=(0,a.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_e(void 0),ee(),se();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var t=(0,a.Z)(l().mark((function t(){var n,a,r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,o.dX)("".concat(c._n,"/hostack/"),{},{rule_id:U.rule_id,limit:U.hosts_acked_count});case 3:return a=t.sent.data,r={systems:null==a||null===(n=a.data)||void 0===n?void 0:n.map((function(e){return e.system_uuid}))},t.next=7,(0,o.SO)("".concat(c._n,"/rule/").concat(U.rule_id,"/unack_hosts/"),{},r);case 7:ee(),q({variant:"success",timeout:!0,dismissable:!0,title:e.formatMessage(H.Z.recSuccessfullyEnabledForSystem)}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),q({variant:"danger",dismissable:!0,title:e.formatMessage(H.Z.error),description:"".concat(t.t0)});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}();return(0,m.useEffect)((function(){var t=P.i&&P.i.find((function(e){return e.rule_id===Y}));if(t&&(window.location.href="".concat(c.Pu,"/vulnerability/cves/").concat(t.cves[0].includes("CVE-")?"".concat(t.cves[0],"?security_rule=").concat(Y):"")),null!=U&&U.description){var n="".concat(U.description," - ").concat(H.Z.recommendations.defaultMessage);document.title=e.formatMessage(H.Z.documentTitle,{subnav:n})}}),[]),f().createElement(f().Fragment,null,Me&&f().createElement(N.Z,{handleModalToggle:function(e){return De(e)},isModalOpen:Me,afterFn:function(){return ee()},rule:U}),Ee&&f().createElement(b.Z,{handleModalToggle:Se,isModalOpen:Ee,rule:U,afterFn:Ce,host:ke}),!W&&!oe&&f().createElement(f().Fragment,null,f().createElement(u.Z,{className:"pageHeaderOverride"},f().createElement(v.Z,{ouiaId:"override",current:U.description||""})),f().createElement(C.Z,{className:"pf-m-light pf-u-pt-sm"},f().createElement(O.Z,{resolutionRisk:Ie(U),riskOfChangeDesc:c.wY[Ie(U)],isDetailsPage:!0,rule:U,topics:ie,header:f().createElement(f().Fragment,null,f().createElement(d.Z,{title:f().createElement(f().Fragment,null,U.description," ",f().createElement(R.Z,{rule:U}))}),f().createElement("p",null,e.formatMessage(H.Z.rulesDetailsPubishdate,{date:f().createElement(h.Z,{date:new Date(U.publish_date),type:"onlyDate"})}),f().createElement(S.Label,{className:"categoryLabel",color:"blue"},U.category.name))),onFeedbackChanged:function(){var e=(0,a.Z)(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.SO)("".concat(c._n,"/rating/"),{},{rule:t,rating:n});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},f().createElement(M.k,null,f().createElement(D.B,{align:{default:"alignRight"}},f().createElement(B.u,{trigger:ue?"":"mouseenter",content:e.formatMessage(H.Z.permsAction)},f().createElement(k.Dropdown,{className:"ins-c-rec-details__actions_dropdown",onSelect:function(){return ge(!fe)},position:"right",ouiaId:"actions",toggle:f().createElement(y.DropdownToggle,{isDisabled:!ue,onToggle:function(e){return ge(e)},toggleIndicator:Z.default},e.formatMessage(H.Z.actions)),isOpen:fe,dropdownItems:U&&"enabled"===U.rule_status?[f().createElement(_.DropdownItem,{key:"link",ouiaId:"disable",onClick:function(){Se(!0)}},e.formatMessage(H.Z.disableRule))]:[f().createElement(_.DropdownItem,{key:"link",ouiaId:"enable",onClick:function(){Fe(U)}},e.formatMessage(H.Z.enableRule))]}))))))),W&&f().createElement(F.Z,null),f().createElement(C.Z,null,W?$?f().createElement(w.Z,{message:e.formatMessage(H.Z.rulesTableFetchRulesError)}):f().createElement(F.Z,null):f().createElement(f().Fragment,null,(U.hosts_acked_count>0||"enabled"!==U.rule_status)&&f().createElement(i.Card,{className:"cardOverride"},f().createElement(i.CardHeader,null,f().createElement(T.Dx,{headingLevel:"h4",size:"xl"},f().createElement(p.ZP,{size:"sm"})," ",e.formatMessage(U.hosts_acked_count>0&&"enabled"===U.rule_status?H.Z.ruleIsDisabledForSystems:H.Z.ruleIsDisabled))),f().createElement(i.CardBody,null,U.hosts_acked_count>0&&"enabled"===U.rule_status?f().createElement(f().Fragment,null,e.formatMessage(H.Z.ruleIsDisabledForSystemsBody,{systems:U.hosts_acked_count})," ",f().createElement(E.Button,{isInline:!0,variant:"link",onClick:function(){return De(!0)},ouiaId:"viewSystems"},e.formatMessage(H.Z.viewSystems))):!re&&f().createElement(f().Fragment,null,e.formatMessage(H.Z.ruleIsDisabledJustification),f().createElement("i",null,ae.justification||e.formatMessage(H.Z.none)),ae.updated_at&&f().createElement("span",null," ",f().createElement(h.Z,{date:new Date(ae.updated_at),type:"onlyDate"})))),f().createElement(i.CardFooter,null,U.hosts_acked_count>0&&"enabled"===U.rule_status?f().createElement(E.Button,{isInline:!0,variant:"link",onClick:function(){return xe()},ouiaId:"bulkHost"},e.formatMessage(H.Z.enableRuleForSystems)):f().createElement(E.Button,{isInline:!0,variant:"link",onClick:function(){return Fe(U)},ouiaId:"rule"},e.formatMessage(H.Z.enableRule)))),"enabled"===U.rule_status&&f().createElement(f().Fragment,null,f().createElement(T.Dx,{className:"titleOverride",headingLevel:"h3",size:"2xl"},e.formatMessage(H.Z.affectedSystems)),f().createElement(I.Z,{tableProps:{canSelectAll:!1,actionResolver:function(){return[{title:"Disable recommendation for system",onClick:function(e,t,n){return Se(!0,n)}}]},isStickyHeader:!0},rule:U,afterDisableFn:Ce,selectedTags:n,workloads:s,SID:X})),"enabled"!==U.rule_status&&f().createElement(x.Z,{icon:p.ZP,title:e.formatMessage(H.Z.ruleIsDisabled),text:e.formatMessage(H.Z.ruleIsDisabledBody)}))))}}}]);
//# sourceMappingURL=../sourcemaps/Details.69c157fcde0b1ae77e0517e007209b58.js.map