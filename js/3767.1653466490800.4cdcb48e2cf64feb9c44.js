(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[3767],{82661:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ee});var r=a(15861),l=a(42982),n=a(4942),i=a(70885),o=a(87757),s=a.n(o),c=a(59303),u=a(75662),m=a(13877),f=a(93264),d=a.n(f),p=a(88292),b=a(30381),g=a(76004),y=a(97109),k=a(28216),v=a(61829),h=a(84785),W=a(6202),Z=a(66584),E=a(62410),_=a(71094),P=a(44788),x=a(76341),S=a(6497),C=a(46891),M=a(14748),T=a(7887),O=a(96905),w=a(87516),D=a(95358),A=a(71355),j=a(40609),R=a(58921),V=a(30893),F=a(28186),I=a(28672),B=a(75546),N=a(86896),L=a(43707),G=a(57262),H=a(45697),q=a.n(H),z=a(36100),K=a(44012),Y=a(34702),J=function(e){var t=e.filters,a=e.toggleRulesDisabled,r=$()[t.rule_status]||$().default;return d().createElement(Y.Z,{icon:z.CheckCircleIcon,iconClass:"ansibleCheck",title:r.title,text:r.body},"enabled"===t.rule_status&&d().createElement(G.Button,{variant:"link",style:{paddingTop:24},onClick:function(){return a("all")}},d().createElement(K.Z,{id:"rulestable.norulehits.adddisabledbutton"})))};J.propTypes={filters:q().object,toggleRulesDisabled:q().func};const U=J;var $=function(){var e=d().createElement(K.Z,{id:"rulestable.norulehits.title"});return{enabled:{title:e,body:d().createElement(d().Fragment,null,d().createElement(G.Text,null,d().createElement(K.Z,{id:"rulestable.norulehits.enabledrulesbody"})),d().createElement(G.Text,null,d().createElement(K.Z,{id:"rulestable.norulehits.enabledrulesbodysecondline"})))},disabled:{title:e,body:d().createElement(d().Fragment,null,d().createElement(G.Text,null,d().createElement(K.Z,{id:"rulestable.norules.disabledrulesbody"})),d().createElement(G.Text,null,d().createElement(K.Z,{id:"rulestable.norules.disabledrulesbodysecondline"})))},rhdisabled:{title:e,body:d().createElement(G.Text,null,d().createElement(K.Z,{id:"rulestable.norules.redhatdisabledrulesbody"}))},default:{title:e,body:d().createElement(G.Text,null,d().createElement(K.Z,{id:"noRecommendations"}))}}};function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const ee=function(){var e,t,a=(0,N.Z)(),o=(0,k.useDispatch)(),G=(0,u.useLocation)().search,H=(0,L.T)("advisor",c.Gd.export).hasAccess,q=(0,L.T)("advisor",c.Gd.disableRec).hasAccess,z=(0,f.useState)([{title:a.formatMessage(V.Z.name),transforms:[b.sortable,(0,b.cellWidth)(40)]},{title:a.formatMessage(V.Z.modified),transforms:[b.sortable,(0,b.cellWidth)(10)]},{title:a.formatMessage(V.Z.category),transforms:[b.sortable,(0,b.cellWidth)(10)]},{title:a.formatMessage(V.Z.totalRisk),transforms:[b.sortable,(0,b.cellWidth)(15)]},{title:a.formatMessage(V.Z.riskOfChange),transforms:[b.sortable,(0,b.cellWidth)(15)]},{title:a.formatMessage(V.Z.systems),transforms:[b.sortable,(0,b.cellWidth)(15)]},{title:a.formatMessage(V.Z.remediation),transforms:[b.sortable,(0,b.cellWidth)(15),b.fitContent]}]),K=(0,i.Z)(z,1)[0],Y=(0,k.useSelector)((function(e){return e.filters.selectedTags})),J=(0,k.useSelector)((function(e){return e.filters.workloads})),$=(0,k.useSelector)((function(e){return e.filters.SID})),Q=(0,k.useSelector)((function(e){return e.filters.recState})),ee=(0,f.useState)([]),te=(0,i.Z)(ee,2),ae=te[0],re=te[1],le=(0,f.useState)({}),ne=(0,i.Z)(le,2),ie=ne[0],oe=ne[1],se=(0,f.useState)(!0),ce=(0,i.Z)(se,2),ue=ce[0],me=ce[1],fe=(0,f.useState)((null==Q?void 0:Q.text)||""),de=(0,i.Z)(fe,2),pe=de[0],be=de[1],ge=(0,f.useState)(!1),ye=(0,i.Z)(ge,2),ke=ye[0],ve=ye[1],he=(0,f.useState)({}),We=(0,i.Z)(he,2),Ze=We[0],Ee=We[1],_e=(0,f.useState)(!1),Pe=(0,i.Z)(_e,2),xe=Pe[0],Se=Pe[1],Ce=(0,f.useState)({}),Me=(0,i.Z)(Ce,2),Te=Me[0],Oe=Me[1],we=(0,f.useState)(!1),De=(0,i.Z)(we,2),Ae=De[0],je=De[1],Re=function(e){return o((0,A.wN)(e))},Ve=function(e){return o((0,I.hb)(e))},Fe={};(null==Y?void 0:Y.length)&&(Fe=X(X({},Fe),{tags:Y.join(",")})),J&&(Fe=X(X({},Fe),(0,y.s0)(J,$)));var Ie=(0,B.Bs)(X(X({},(0,y.qW)(Q)),Fe)),Be=Ie.data,Ne=void 0===Be?[]:Be,Le=Ie.isFetching,Ge=Ie.isLoading,He=Ie.isError,qe=Ie.refetch,ze=(0,j.Z)(pe,c.$x),Ke=(null==Ne||null===(e=Ne.meta)||void 0===e?void 0:e.count)||0,Ye={1:"description",2:"publish_date",3:"category",4:"total_risk",5:"resolution_risk",6:"impacted_count",7:"playbook_count"};(0,f.useEffect)((function(){ue||null===Y||(0,y.Y4)(Q,Y)}),[Q,Y,J,$]);var Je=function(e){var t=e*Q.limit-Q.limit;Ve(X(X({},Q),{},{offset:t}))},Ue=function(e){Ve(X(X({},Q),{},{rule_status:e,offset:0},"enabled"!==e&&{impacting:["false"]}))},$e=function(){var e=(0,r.Z)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ae[t].rule,e.prev=1,"enabled"!==r.rule_status){e.next=7;break}Ee(r),ve(!0),e.next=17;break;case 7:return e.prev=7,e.next=10,(0,_.Sp)("".concat(c._n,"/ack/").concat(r.rule_id,"/"));case 10:Re({variant:"success",timeout:!0,dismissable:!0,title:a.formatMessage(V.Z.recSuccessfullyEnabled)}),qe(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),Re({variant:"danger",dismissable:!0,title:a.formatMessage(V.Z.error),description:"".concat(e.t0)});case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(1),Re({variant:"danger",dismissable:!0,title:"enabled"===r.rule_status?a.formatMessage(V.Z.rulesTableHideReportsErrorDisabled):a.formatMessage(V.Z.rulesTableHideReportsErrorEnabled),description:"".concat(e.t1)});case 22:case"end":return e.stop()}}),e,null,[[1,19],[7,14]])})));return function(t){return e.apply(this,arguments)}}();(0,f.useEffect)((function(){if(G&&ue){var e=(0,y.yG)();delete e.tags,void 0===e.text?be(""):be(e.text),e.sort=void 0===e.sort?"-total_risk":e.sort[0],void 0!==e.has_playbook&&!Array.isArray(e.has_playbook)&&(e.has_playbook=["".concat(e.has_playbook)]),void 0!==e.incident&&!Array.isArray(e.incident)&&(e.incident=["".concat(e.incident)]),void 0===e.offset?e.offset=0:e.offset=Number(e.offset[0]),void 0===e.limit?e.limit=20:e.limit=Number(e.limit[0]),void 0!==e.reboot&&!Array.isArray(e.reboot)&&(e.reboot=["".concat(e.reboot)]),void 0!==e.impacting&&!Array.isArray(e.impacting)&&(e.impacting=["".concat(e.impacting)]),Ve(X(X({},Q),e))}me(!1)}),[]),(0,f.useEffect)((function(){var e,t=null===(e=Object.entries(Ye))||void 0===e?void 0:e.find((function(e){return e[1]===Q.sort||"-".concat(e[1])===Q.sort}));if(void 0!==Q.sort&&t){var a="-"===Q.sort[0]?"desc":"asc";oe({index:Number(t[0]),direction:a})}}),[Q.sort]),(0,f.useEffect)((function(){if(Ne.data)if(0===Ne.data.length)re(function(e,t){return[{cells:[{title:d().createElement(U,{filters:e,toggleRulesDisabled:t}),props:{colSpan:6}}]}]}(Q,Ue));else{var e=Ne.data.flatMap((function(e,t){return[{isOpen:Ae,rule:e,cells:[{title:d().createElement("span",{key:t},d().createElement(u.Link,{key:t,to:"/recommendations/".concat(e.rule_id)}," ",e.description," "),d().createElement(w.Z,{rule:e,isCompact:!0}))},{title:d().createElement(E.Z,{key:t,date:e.publish_date,variant:"relative"})},{title:d().createElement(Z.Z,{key:t,labelList:[e.category],isCompact:!0})},{title:d().createElement("div",{key:t},d().createElement(g.Tooltip,{key:t,position:g.TooltipPosition.bottom,content:a.formatMessage(V.Z.rulesDetailsTotalRiskBody,{risk:c.Nq[e.total_risk]||a.formatMessage(V.Z.undefined),strong:function(e){return(0,F.fK)(e)}})},d().createElement(S.Z,{value:e.total_risk,isCompact:!0})))},{title:d().createElement("div",{key:t},d().createElement(S.Z,{text:c.MS[(0,y.EW)(e)],value:(0,y.EW)(e),hideIcon:!0,isCompact:!0}),d().createElement("div",null))},{title:"rhdisabled"===e.rule_status?d().createElement(g.Tooltip,{content:a.formatMessage(V.Z.byEnabling,{systems:e.impacted_systems_count})},d().createElement("span",null,a.formatMessage(V.Z.nA))):d().createElement("div",{key:t},"".concat(e.impacted_systems_count.toLocaleString()))},{title:d().createElement("div",{className:"ins-c-center-text ",key:t},e.playbook_count?d().createElement("span",null,d().createElement(v.ZP,{size:"sm"})," ",a.formatMessage(V.Z.playbook)):a.formatMessage(V.Z.manual))}]},{parent:2*t,fullWidth:!0,cells:[{title:d().createElement(M.Z,{className:"pf-m-light"},d().createElement(p.Stack,{hasGutter:!0},e.hosts_acked_count?d().createElement(p.StackItem,null,d().createElement(h.ZP,{size:"sm"})," ",e.hosts_acked_count&&!e.impacted_systems_count?a.formatMessage(V.Z.ruleIsDisabledForAllSystems):a.formatMessage(V.Z.ruleIsDisabledForSystemsBody,{systems:e.hosts_acked_count})," "," ",d().createElement(W.Button,{isInline:!0,variant:"link",ouiaId:"viewSystem",onClick:function(){Oe(e),Se(!0)}},a.formatMessage(V.Z.viewSystems))):d().createElement(d().Fragment,null),d().createElement(O.Ii,{messages:(0,F.k5)(a,O.TO,(0,F.jL)(a,e)),product:O.D1.rhel,rule:e,resolutionRisk:(0,y.EW)(e),resolutionRiskDesc:c.wY[(0,y.EW)(e)],isDetailsPage:!1,showViewAffected:!0,linkComponent:u.Link,knowledgebaseUrl:"https://access.redhat.com/node/".concat(e.node_id)})))}]}]}));re(e)}}),[Ne]),(0,f.useEffect)((function(){if(!ue&&!Ge){var e=X({},Q),t=pe.length?{text:pe}:{};delete e.text,Ve(X(X(X({},e),t),{},{offset:0}))}}),[ze]);var Qe,Xe=function(e){var t=X(X({},Q),{},{offset:0});"text"===e&&be(""),delete t[e],Ve(t)},et=function(e,t){t.length>0?Ve(X(X({},Q),{},{offset:0},(0,n.Z)({},e,t))):Xe(e)},tt=[{label:a.formatMessage(V.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return be(t)},value:pe,placeholder:a.formatMessage(V.Z.filterBy)}},{label:c.W2.total_risk.title,type:c.W2.total_risk.type,id:c.W2.total_risk.urlParam,value:"checkbox-".concat(c.W2.total_risk.urlParam),filterValues:{key:"".concat(c.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.total_risk.urlParam,t)},value:Q.total_risk,items:c.W2.total_risk.values}},{label:c.W2.res_risk.title,type:c.W2.res_risk.type,id:c.W2.res_risk.urlParam,value:"checkbox-".concat(c.W2.res_risk.urlParam),filterValues:{key:"".concat(c.W2.res_risk.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.res_risk.urlParam,t)},value:Q.res_risk,items:c.W2.res_risk.values}},{label:c.W2.impact.title,type:c.W2.impact.type,id:c.W2.impact.urlParam,value:"checkbox-".concat(c.W2.impact.urlParam),filterValues:{key:"".concat(c.W2.impact.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.impact.urlParam,t)},value:Q.impact,items:c.W2.impact.values}},{label:c.W2.likelihood.title,type:c.W2.likelihood.type,id:c.W2.likelihood.urlParam,value:"checkbox-".concat(c.W2.likelihood.urlParam),filterValues:{key:"".concat(c.W2.likelihood.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.likelihood.urlParam,t)},value:Q.likelihood,items:c.W2.likelihood.values}},{label:c.W2.category.title,type:c.W2.category.type,id:c.W2.category.urlParam,value:"checkbox-".concat(c.W2.category.urlParam),filterValues:{key:"".concat(c.W2.category.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.category.urlParam,t)},value:Q.category,items:c.W2.category.values}},{label:c.W2.incident.title,type:c.W2.incident.type,id:c.W2.incident.urlParam,value:"checkbox-".concat(c.W2.incident.urlParam),filterValues:{key:"".concat(c.W2.incident.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.incident.urlParam,t)},value:Q.incident,items:c.W2.incident.values}},{label:c.W2.has_playbook.title,type:c.W2.has_playbook.type,id:c.W2.has_playbook.urlParam,value:"checkbox-".concat(c.W2.has_playbook.urlParam),filterValues:{key:"".concat(c.W2.has_playbook.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.has_playbook.urlParam,t)},value:Q.has_playbook,items:c.W2.has_playbook.values}},{label:c.W2.reboot.title,type:c.W2.reboot.type,id:c.W2.reboot.urlParam,value:"checkbox-".concat(c.W2.reboot.urlParam),filterValues:{key:"".concat(c.W2.reboot.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.reboot.urlParam,t)},value:Q.reboot,items:c.W2.reboot.values}},{label:c.W2.rule_status.title,type:c.W2.rule_status.type,id:c.W2.rule_status.urlParam,value:"radio-".concat(c.W2.rule_status.urlParam),filterValues:{key:"".concat(c.W2.rule_status.urlParam,"-filter"),onChange:function(e,t){return Ue(t)},value:"".concat(Q.rule_status),items:c.W2.rule_status.values}},{label:c.W2.impacting.title,type:c.W2.impacting.type,id:c.W2.impacting.urlParam,value:"checkbox-".concat(c.W2.impacting.urlParam),filterValues:{key:"".concat(c.W2.impacting.urlParam,"-filter"),onChange:function(e,t){return et(c.W2.impacting.urlParam,t)},value:Q.impacting,items:c.W2.impacting.values}}],at={deleteTitle:a.formatMessage(V.Z.resetFilters),filters:(Qe=X({},Q),delete Qe.topic,delete Qe.sort,delete Qe.offset,delete Qe.limit,(0,y.yK)(Qe,c.W2)),showDeleteButton:!0,onDelete:function(e,t,a){a?(be(""),Ve(X(X({},Q.topic&&{topic:Q.topic}),{},{impacting:["true"],rule_status:"enabled",limit:Q.limit,offset:Q.offset,pathway:Q.pathway}))):t.map((function(e){var t=(0,n.Z)({},e.urlParam,Array.isArray(Q[e.urlParam])?Q[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?Ve(X(X({},Q),t)):Xe(e.urlParam)}))}};return d().createElement(d().Fragment,null,xe&&d().createElement(D.Z,{handleModalToggle:function(e){return Se(e)},isModalOpen:xe,afterFn:function(){qe()},rule:Te}),ke&&d().createElement(P.Z,{handleModalToggle:ve,isModalOpen:ke,rule:Ze,afterFn:qe}),d().createElement(T.Z,{expandAll:{isAllExpanded:Ae,onClick:function(e,t){var a=(0,l.Z)(ae);je(t),a.map((function(e,r){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(a[r]=X(X({},e),{},{isOpen:t}))})),re(a)}},pagination:{itemCount:Ke,page:Q.offset/Q.limit+1,perPage:Number(Q.limit),onSetPage:function(e,t){Je(t)},onPerPageSelect:function(e,t){Ve(X(X({},Q),{},{limit:t,offset:0}))},isCompact:!0},exportConfig:(t={label:a.formatMessage(V.Z.exportCsv)},(0,n.Z)(t,"label",a.formatMessage(V.Z.exportJson)),(0,n.Z)(t,"onSelect",(function(e,t){return(0,R.Z)("hits",t,Q,Y,J,$,o)})),(0,n.Z)(t,"isDisabled",!H),(0,n.Z)(t,"tooltipText",H?a.formatMessage(V.Z.exportData):a.formatMessage(V.Z.permsAction)),t),filterConfig:{items:tt},activeFiltersConfig:at}),Le?d().createElement(C.Z,null):He?d().createElement(x.Z,{message:a.formatMessage(V.Z.rulesTableFetchRulesError)}):d().createElement(b.Table,{"aria-label":"rule-table",variant:b.TableVariant.compact,actionResolver:function(e,t){var r=t.rowIndex,l=ae[r].rule?ae[r].rule:null;return r%2==0&&l?l&&"enabled"===l.rule_status?[{title:a.formatMessage(V.Z.disableRule),onClick:function(e,t){return $e(t)}}]:[{title:a.formatMessage(V.Z.enableRule),onClick:function(e,t){return $e(t)}}]:null},onCollapse:function(e,t,a){var r=(0,l.Z)(ae);r[t]=X(X({},r[t]),{},{isOpen:a}),re(r)},sortBy:ie,onSort:function(e,t,a){var r="".concat("asc"===a?"":"-").concat(Ye[t]);oe({index:t,direction:a}),Ve(X(X({},Q),{},{sort:r,offset:0}))},cells:K,rows:ae,areActionsDisabled:function(){return!q},isStickyHeader:!0},d().createElement(b.TableHeader,null),d().createElement(b.TableBody,null)),d().createElement(m.tl,{ouiaId:"page",itemCount:Ke,page:Q.offset/Q.limit+1,perPage:Number(Q.limit),onSetPage:function(e,t){Je(t)},onPerPageSelect:function(e,t){Ve(X(X({},Q),{},{limit:t,offset:0}))},widgetId:"pagination-options-menu-bottom",variant:m.aM.bottom}))}},40609:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(70885),l=a(93264);const n=function(e,t){var a=(0,l.useState)(e),n=(0,r.Z)(a,2),i=n[0],o=n[1];return(0,l.useEffect)((function(){var a=setTimeout((function(){o(e)}),t);return function(){clearTimeout(a)}}),[t,e]),i}},11452:()=>{}}]);
//# sourceMappingURL=../sourcemaps/3767.1bf370ad95a24b14de77e63ae272a2f9.js.map