{"version":3,"sources":["webpack:///./src/PresentationalComponents/TopicsTable/TopicsTable.js","webpack:///./src/SmartComponents/Topics/List.js"],"names":["TopicsTable","topics","topicsFetchStatus","intl","useState","searchText","setSearchText","title","formatMessage","messages","name","transforms","sortable","featured","wrappable","affectedSystems","cols","rows","setRows","index","direction","sort","setSort","buildRows","list","flatMap","value","key","length","toLowerCase","includes","topic","cells","to","slug","props","colSpan","Label","color","icon","className","impacted_systems_count","onSort","_event","sortedReports","0","result","2","3","sortedTopicsDirectional","SortByDirection","asc","reverse","activeFiltersConfig","filters","category","chips","onDelete","useEffect","asMutable","filterConfigItems","label","filterValues","onChange","event","Fragment","Loading","PrimaryToolbar","filterConfig","items","Table","aria-label","sortBy","MessageState","SearchIcon","noHitsTitle","item","text","noHitsBody","TimesCircleIcon","topicsListNotopicsTitle","topicsListNotopicsBody","propTypes","PropTypes","array","string","any","injectIntl","routerParams","connect","state","AdvisorStore","TagsToolbar","asyncComponent","List","fetchTopics","selectedTags","options","tags","join","isGlobalFilter","PageHeader","insightsHeader","Main","displayName","func","ownProps","dispatch","AppActions"],"mappings":"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","file":"js/TopicsList.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { SortByDirection, Table, TableBody, TableHeader, sortable, wrappable } from '@patternfly/react-table';\n\nimport { Label } from '@patternfly/react-core/dist/js/components/Label/Label';\nimport { Link } from 'react-router-dom';\nimport Loading from '../../PresentationalComponents/Loading/Loading';\nimport MessageState from '../../PresentationalComponents/MessageState/MessageState';\nimport { PrimaryToolbar } from '@redhat-cloud-services/frontend-components/components/PrimaryToolbar';\nimport PropTypes from 'prop-types';\nimport SearchIcon from '@patternfly/react-icons/dist/js/icons/search-icon';\nimport StarIcon from '@patternfly/react-icons/dist/js/icons/star-icon';\nimport TimesCircleIcon from '@patternfly/react-icons/dist/js/icons/times-circle-icon';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../Messages';\nimport routerParams from '@redhat-cloud-services/frontend-components-utilities/files/RouterParams';\nimport { sortBy } from 'lodash';\n\nconst TopicsTable = ({ topics, topicsFetchStatus, intl }) => {\n    const [searchText, setSearchText] = useState('');\n    const [cols] = useState([\n        { title: intl.formatMessage(messages.name), transforms: [sortable] },\n        '',\n        { title: intl.formatMessage(messages.featured), transforms: [sortable, wrappable] },\n        { title: intl.formatMessage(messages.affectedSystems), transforms: [sortable, wrappable] }\n    ]);\n    const [rows, setRows] = useState([]);\n    const [sort, setSort] = useState({ index: 2, direction: 'desc' });\n\n    const buildRows = (list) => list.flatMap((value, key) => {\n        const isValidSearchText = searchText.length === 0 || value.name.toLowerCase().includes(searchText.toLowerCase());\n\n        return isValidSearchText ? [{\n            topic: value,\n            cells: [{\n                title: <span key={key}><Link key={key} to={`/topics/${value.slug}`}> {value.name} </Link></span>,\n                props: { colSpan: 2 }\n            }, {\n                title: <span key={key}> {value.featured &&\n                    <Label color=\"blue\" icon={<StarIcon />}>{intl.formatMessage(messages.featured)}</Label>\n                } </span>\n            }, {\n                title: <span className=\"pf-m-center\" key={key}> {value.impacted_systems_count}                </span>\n            }]\n        }] : [];\n    });\n\n    const onSort = (_event, index, direction) => {\n        const sortedReports = {\n            0: sortBy(topics, [result => result.name]),\n            2: sortBy(topics, [result => result.featured]),\n            3: sortBy(topics, [result => result.impacted_systems_count])\n        };\n        const sortedTopicsDirectional = direction === SortByDirection.asc ? sortedReports[index] : sortedReports[index].reverse();\n        setSort({ index, direction });\n        setRows(buildRows(sortedTopicsDirectional));\n    };\n\n    const activeFiltersConfig = {\n        filters: searchText.length ? [{ category: 'Description', chips: [{ name: searchText, value: searchText }] }] : [],\n        onDelete: () => { setSearchText(''); setSort({}); }\n    };\n\n    useEffect(() => {\n        sort.index ? onSort(null, sort.index, sort.direction) : setRows(buildRows(topics).asMutable());\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [topics, searchText]);\n\n    const filterConfigItems = [{\n        label: intl.formatMessage(messages.name),\n        filterValues: {\n            key: 'text-filter',\n            onChange: (event, value) => { setSearchText(value); setSort({}); },\n            value: searchText\n        }\n    }];\n\n    return <React.Fragment>\n        {topicsFetchStatus === '' || topicsFetchStatus === 'pending' && <Loading />}\n        {topicsFetchStatus === 'fulfilled' && topics.length > 0 &&\n            <React.Fragment>\n                <PrimaryToolbar\n                    filterConfig={{ items: filterConfigItems }}\n                    activeFiltersConfig={activeFiltersConfig}\n                />\n                <Table aria-label={'topics-table'} sortBy={sort} onSort={onSort} cells={cols} rows={rows} >\n                    <TableHeader />\n                    <TableBody />\n                    {rows.length === 0 && topicsFetchStatus !== 'pending' && setRows([{\n                        cells: [{\n                            title: (\n                                <MessageState icon={SearchIcon}\n                                    title={intl.formatMessage(messages.noHitsTitle, { item: intl.formatMessage(messages.topics).toLowerCase() })}\n                                    text={intl.formatMessage(messages.noHitsBody, { item: intl.formatMessage(messages.topics).toLowerCase() })} />),\n                            props: { colSpan: 4 }\n                        }]\n                    }])\n                    }\n                </Table>\n            </React.Fragment>\n        }\n        {topicsFetchStatus === 'failed' || topicsFetchStatus === 'rejected' || (topicsFetchStatus === 'fulfilled' && topics.length === 0) &&\n            < MessageState icon={TimesCircleIcon}\n                title={intl.formatMessage(messages.topicsListNotopicsTitle)}\n                text={intl.formatMessage(messages.topicsListNotopicsBody)} />\n        }\n    </React.Fragment>;\n};\n\nTopicsTable.propTypes = {\n    topics: PropTypes.array,\n    topicsFetchStatus: PropTypes.string,\n    intl: PropTypes.any\n};\n\nexport default injectIntl(routerParams(connect((state) => ({\n    topics: state.AdvisorStore.topics,\n    topicsFetchStatus: state.AdvisorStore.topicsFetchStatus\n}), null)(TopicsTable)));\n\n","import * as AppActions from '../../AppActions';\n\nimport { PageHeader, PageHeaderTitle } from '@redhat-cloud-services/frontend-components/components/PageHeader';\nimport React, { useEffect } from 'react';\n\nimport { Main } from '@redhat-cloud-services/frontend-components/components/Main';\nimport PropTypes from 'prop-types';\nimport TopicsTable from '../../PresentationalComponents/TopicsTable/TopicsTable';\nimport asyncComponent from '../../Utilities/asyncComponent';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../Messages';\nimport routerParams from '@redhat-cloud-services/frontend-components-utilities/files/RouterParams';\nimport { isGlobalFilter } from '../../AppConstants';\n\nconst TagsToolbar = asyncComponent(() => import(/* webpackChunkName: \"TagsToolbar\" */ '../../PresentationalComponents/TagsToolbar/TagsToolbar'));\n\nconst List = ({ fetchTopics, intl, selectedTags }) => {\n    useEffect(() => {\n        const options = selectedTags !== null && selectedTags.length && ({ tags: selectedTags.join() });\n        fetchTopics(options);\n    }, [fetchTopics, selectedTags]);\n\n    return <React.Fragment>\n        { !isGlobalFilter() && <TagsToolbar /> }\n        <PageHeader>\n            <PageHeaderTitle title={`${intl.formatMessage(messages.insightsHeader)} ${intl.formatMessage(messages.topics).toLowerCase()}`} />\n        </PageHeader>\n        <Main>\n            <TopicsTable />\n        </Main>\n    </React.Fragment>;\n};\n\nList.displayName = 'list-topics';\nList.propTypes = { fetchTopics: PropTypes.func, intl: PropTypes.any, selectedTags: PropTypes.array };\nconst mapStateToProps = (state, ownProps) => ({\n    selectedTags: state.AdvisorStore.selectedTags,\n    ...ownProps\n});\nconst mapDispatchToProps = dispatch => ({ fetchTopics: (options) => dispatch(AppActions.fetchTopics(options)) });\n\nexport default injectIntl(routerParams(connect(mapStateToProps, mapDispatchToProps)(List)));\n"],"sourceRoot":""}