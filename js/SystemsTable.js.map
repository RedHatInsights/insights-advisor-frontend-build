{"version":3,"sources":["webpack:///./src/PresentationalComponents/SystemsTable/SystemsTable.js","webpack:///./src/PresentationalComponents/Loading/Failed.js","webpack:///./node_modules/@patternfly/react-icons/dist/js/icons/frown-open-icon.js"],"names":["SystemsTable","systemsFetchStatus","fetchSystems","systems","intl","filters","setFilters","history","useState","title","formatMessage","messages","name","transforms","sortable","numberRuleHits","cellWidth","lastSeen","cols","rows","setRows","sortBy","setSortBy","results","meta","count","display_name","searchText","setSearchText","debouncedSearchText","debounce","filterBuilding","setFilterBuilding","sortIndices","0","1","2","onSetPage","pageNumber","newOffset","limit","offset","useEffect","undefined","filter","text","length","location","search","paramsObject","paramParser","sort","Number","urlBuilder","sortIndex","Object","entries","find","item","sortDirection","index","direction","offest","data","flatMap","value","key","isOpen","system","cells","to","system_uuid","hits","date","last_seen","variant","asMutable","icon","SearchIcon","noHitsTitle","toLowerCase","noHitsBody","props","colSpan","filterConfigItems","label","filterValues","onChange","event","activeFiltersConfig","category","chips","onDelete","Fragment","pagination","itemCount","page","perPage","onPerPageSelect","isCompact","filterConfig","items","aria-label","onSort","_event","orderParam","message","systemTableFetchError","widgetId","PaginationVariant","bottom","propTypes","PropTypes","func","string","object","addNotification","any","injectIntl","routerParams","connect","state","ownProps","AdvisorStore","filtersSystems","dispatch","url","AppActions","Failed","className","size","defineProperty","exports","FrownOpenIconConfig","obj","_createIcon","__esModule","height","width","svgPath","yOffset","xOffset","transform","_default"],"mappings":"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","file":"js/SystemsTable.js","sourcesContent":["/* eslint camelcase: 0 */\nimport * as AppActions from '../../AppActions';\n\nimport { Pagination, PaginationVariant } from '@patternfly/react-core/dist/js/components/Pagination/Pagination';\nimport React, { useEffect, useState } from 'react';\nimport { Table, TableBody, TableHeader, cellWidth, sortable } from '@patternfly/react-table';\nimport { paramParser, urlBuilder } from '../Common/Tables';\n\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/components/DateFormat';\nimport Failed from '../Loading/Failed';\nimport { Link } from 'react-router-dom';\nimport Loading from '../Loading/Loading';\nimport MessageState from '../MessageState/MessageState';\nimport { PrimaryToolbar } from '@redhat-cloud-services/frontend-components/components/PrimaryToolbar';\nimport PropTypes from 'prop-types';\nimport SearchIcon from '@patternfly/react-icons/dist/js/icons/search-icon';\nimport { TableToolbar } from '@redhat-cloud-services/frontend-components/components/TableToolbar';\nimport { addNotification } from '@redhat-cloud-services/frontend-components-notifications';\nimport { connect } from 'react-redux';\nimport debounce from '../../Utilities/Debounce';\nimport { injectIntl } from 'react-intl';\nimport messages from '../../Messages';\nimport routerParams from '@redhat-cloud-services/frontend-components-utilities/files/RouterParams';\n\nconst SystemsTable = ({ systemsFetchStatus, fetchSystems, systems, intl, filters, setFilters, history }) => {\n    const [cols] = useState([\n        { title: intl.formatMessage(messages.name), transforms: [sortable] },\n        { title: intl.formatMessage(messages.numberRuleHits), transforms: [sortable, cellWidth(15)] },\n        { title: intl.formatMessage(messages.lastSeen), transforms: [sortable] }\n    ]);\n    const [rows, setRows] = useState([]);\n    const [sortBy, setSortBy] = useState({});\n    const results = systems.meta ? systems.meta.count : 0;\n    const [searchText, setSearchText] = useState(filters.display_name || '');\n    const debouncedSearchText = debounce(searchText, 800);\n    const [filterBuilding, setFilterBuilding] = useState(true);\n\n    const sortIndices = {\n        0: 'display_name',\n        1: 'hits',\n        2: 'last_seen'\n    };\n\n    const onSort = (_event, index, direction) => {\n        const orderParam = `${direction === 'asc' ? '' : '-'}${sortIndices[index]}`;\n        setSortBy({ index, direction });\n        setFilters({ ...filters, sort: orderParam, offset: 0 });\n    };\n\n    const onSetPage = (pageNumber) => {\n        const newOffset = pageNumber * filters.limit - filters.limit;\n        setFilters({ ...filters, offset: newOffset });\n    };\n\n    useEffect(() => {\n        filters.display_name === undefined ? setSearchText('') : setSearchText(filters.display_name);\n    }, [filters.display_name]);\n\n    useEffect(() => {\n        const filter = { ...filters };\n        const text = searchText.length ? { display_name: searchText } : {};\n        delete filter.display_name;\n        setFilters({ ...filter, ...text });\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [debouncedSearchText]);\n\n    useEffect(() => {\n        if (history.location.search) {\n            const paramsObject = paramParser(history);\n            paramsObject.sort !== undefined && (paramsObject.sort = paramsObject.sort[0]);\n            paramsObject.display_name !== undefined && (paramsObject.display_name = paramsObject.display_name[0]);\n            paramsObject.offset === undefined ? paramsObject.offset = 0 : paramsObject.offset = Number(paramsObject.offset[0]);\n            paramsObject.limit === undefined ? paramsObject.limit = 10 : paramsObject.limit = Number(paramsObject.limit[0]);\n\n            setFilters({ ...paramsObject });\n        }\n\n        setFilterBuilding(false);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    useEffect(() => {\n        urlBuilder(filters, history);\n    }, [filters, history]);\n\n    useEffect(() => {\n        if (filters.sort !== undefined) {\n            const sortIndex = Number(Object.entries(sortIndices).find(item => item[1] === filters.sort || `-${item[1]}` === filters.sort)[0]);\n            const sortDirection = filters.sort[0] === '-' ? 'desc' : 'asc';\n            setSortBy({ index: sortIndex, direction: sortDirection });\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [filters.sort]);\n\n    useEffect(() => {\n        if (!filterBuilding) {\n            filters.limit || filters.offest === undefined && setFilters({ ...filters, offset: 0, limit: 10 });\n\n            fetchSystems({\n                offset: filters.offset,\n                limit: filters.limit,\n                ...filters\n            });\n        }\n    }, [fetchSystems, filters, filterBuilding, setFilters]);\n\n    useEffect(() => {\n        if (systems.data) {\n            if (!systems.meta.count) {\n                setRows([{\n                    cells: [{\n                        title: (<MessageState icon={SearchIcon}\n                            title={intl.formatMessage(messages.noHitsTitle, { item: intl.formatMessage(messages.systems).toLowerCase() })}\n                            text={intl.formatMessage(messages.noHitsBody, { item: intl.formatMessage(messages.systems).toLowerCase() })} />),\n                        props: { colSpan: 5 }\n                    }]\n                }]);\n            } else {\n                const rows = systems.data.flatMap((value, key) => ([{\n                    isOpen: false,\n                    system: value,\n                    cells: [\n                        {\n                            title: <Link key={key} to={`/rules/systems/${value.system_uuid}`}>\n                                {value.display_name}\n                            </Link>\n                        }, {\n                            title: <div key={key}> {value.hits}</div>\n                        }, {\n\n                            title: <DateFormat key={key} date={value.last_seen} variant='relative' />\n                        }\n                    ]\n                }\n                ]));\n                setRows(rows.asMutable());\n            }\n        }\n    }, [intl, systems]);\n\n    const filterConfigItems = [{\n        label: intl.formatMessage(messages.name),\n        filterValues: {\n            key: 'text-filter',\n            onChange: (event, value) => setSearchText(value),\n            value: searchText\n        }\n    }];\n\n    const activeFiltersConfig = {\n        filters: searchText.length > 0 && [({ category: 'Description', chips: [{ name: searchText }] })] || [],\n        onDelete: () => setSearchText('')\n    };\n\n    return <React.Fragment>\n        <PrimaryToolbar\n            pagination={{\n                itemCount: results,\n                page: filters.offset / filters.limit + 1,\n                perPage: Number(filters.limit),\n                onSetPage(event, page) { onSetPage(page); },\n                onPerPageSelect(event, perPage) { setFilters({ ...filters, limit: perPage, offset: 0 }); },\n                isCompact: false\n            }}\n            filterConfig={{ items: filterConfigItems }}\n            activeFiltersConfig={activeFiltersConfig}\n        />\n        {systemsFetchStatus === 'fulfilled' &&\n            <Table aria-label={'rule-table'} sortBy={sortBy} onSort={onSort} cells={cols} rows={rows}>\n                <TableHeader />\n                <TableBody />\n            </Table>\n        }\n        {systemsFetchStatus === 'pending' && (<Loading />)}\n        {systemsFetchStatus === 'failed' && (<Failed message={intl.formatMessage(messages.systemTableFetchError)} />)}\n        <TableToolbar>\n            <Pagination\n                itemCount={results}\n                perPage={Number(filters.limit)}\n                page={(filters.offset / filters.limit + 1)}\n                onSetPage={(event, page) => { onSetPage(page); }}\n                onPerPageSelect={(event, perPage) => { setFilters({ ...filters, limit: perPage, offset: 0 }); }}\n                widgetId={`pagination-options-menu-bottom`}\n                variant={PaginationVariant.bottom}\n            />\n        </TableToolbar>\n    </React.Fragment>;\n};\n\nSystemsTable.propTypes = {\n    fetchSystems: PropTypes.func,\n    systemsFetchStatus: PropTypes.string,\n    systems: PropTypes.object,\n    addNotification: PropTypes.func,\n    history: PropTypes.object,\n    intl: PropTypes.any,\n    filters: PropTypes.object,\n    setFilters: PropTypes.func\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n    systems: state.AdvisorStore.systems,\n    systemsFetchStatus: state.AdvisorStore.systemsFetchStatus,\n    filters: state.AdvisorStore.filtersSystems,\n    ...ownProps\n});\n\nconst mapDispatchToProps = dispatch => ({\n    fetchSystems: (url) => dispatch(AppActions.fetchSystems(url)),\n    addNotification: data => dispatch(addNotification(data)),\n    setFilters: (filters) => dispatch(AppActions.setFiltersSystems(filters))\n});\n\nexport default injectIntl(routerParams(connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(SystemsTable)));\n","import { Card } from '@patternfly/react-core/dist/js/components/Card/Card';\nimport { CardBody } from '@patternfly/react-core/dist/js/components/Card/CardBody';\nimport { CardHeader } from '@patternfly/react-core/dist/js/components/Card/CardHeader';\nimport  FrownOpenIcon  from '@patternfly/react-icons/dist/js/icons/frown-open-icon';\nimport React from 'react';\nimport propTypes from 'prop-types';\n\nconst Failed = ({ message }) => <>\n    <Card className=\"ins-empty-rule-cards\">\n        <CardHeader>\n            <FrownOpenIcon size='lg'/>\n        </CardHeader>\n        <CardBody>\n            { message }\n        </CardBody>\n    </Card></>;\n\nexport default Failed;\n\nFailed.propTypes = {\n    message: propTypes.string\n};\n\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.FrownOpenIconConfig = void 0;\n\nvar _createIcon = _interopRequireDefault(require(\"../createIcon\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/* This file is generated by createIcons.js any changes will be lost. */\nvar FrownOpenIconConfig = {\n  name: 'FrownOpenIcon',\n  height: 512,\n  width: 496,\n  svgPath: 'M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zM136 208c0-17.7 14.3-32 32-32s32 14.3 32 32-14.3 32-32 32-32-14.3-32-32zm187.3 183.3c-31.2-9.6-59.4-15.3-75.3-15.3s-44.1 5.7-75.3 15.3c-11.5 3.5-22.5-6.3-20.5-18.1 7-40 60.1-61.2 95.8-61.2s88.8 21.3 95.8 61.2c2 11.9-9.1 21.6-20.5 18.1zM328 240c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z',\n  yOffset: '',\n  xOffset: '',\n  transform: ''\n};\nexports.FrownOpenIconConfig = FrownOpenIconConfig;\n\nvar _default = (0, _createIcon[\"default\"])(FrownOpenIconConfig);\n\nexports[\"default\"] = _default;\n//# sourceMappingURL=frown-open-icon.js.map"],"sourceRoot":""}