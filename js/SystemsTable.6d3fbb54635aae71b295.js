"use strict";(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[993],{40444:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var s=r(15861),n=r(4942),a=r(29439),i=r(87757),o=r.n(i),l=r(59303),c=r(93264),u=r.n(c),m=r(27577),f=r(97109),p=r(82041),d=r(71094),y=r(33739),v=r(75662),g=r(46891),h=r(87516),b=r(93433),w=r(3968),O=r(74093),P=r(45697),Z=r.n(P),k=r(51634),x=r(39080),_=r(87119),j=r(75442),S=r(23992),E=r(71712),M=r(32412),U=r(30893);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=O.mM.create({bold:{fontWeight:S.default.value},link:{color:E.ZP.value},text:{marginTop:M.ZP.value},nameColumn:{width:"220px"},header:{fontSize:9,color:j.ZP.value,paddingLeft:x.ZP.value,paddingBottom:k.ZP.value,paddingTop:_.ZP.value}}),C=function(e){var t=e.page,r=e.systems,s=e.intl,n=[{value:s.formatMessage(U.Z.name),style:A.nameColumn},{value:s.formatMessage(U.Z.recommendations),style:{width:"100px",textAlign:"center"}},{value:s.formatMessage(U.Z.critical),style:{width:"70px",textAlign:"center"}},{value:s.formatMessage(U.Z.important),style:{width:"70px",textAlign:"center"}},{value:s.formatMessage(U.Z.moderate),style:{width:"60px",textAlign:"center"}},{value:s.formatMessage(U.Z.low),style:{width:"90px",textAlign:"center"}},{value:s.formatMessage(U.Z.lastSeen),style:{marginLeft:"20px"}}],i=["hits","critical_hits","important_hits","moderate_hits","low_hits"],o=(0,b.Z)(r.map((function(e){var t=new Date(e.last_seen).toUTCString().split(" "),r=(0,a.Z)(t,5),s=r[1],n=r[2],o=r[3],c=r[4],m="".concat(s," ").concat(n," ").concat(o,", ").concat(c.split(":").slice(0,2).join(":")," UTC");return[u().createElement(O.xv,{key:e.system_uuid,style:A.nameColumn},u().createElement(O.rU,{style:A.link,src:"".concat(l.eR,"/insights/advisor/systems/").concat(e.system_uuid,"/")},e.display_name))].concat((0,b.Z)(i.map((function(t){return s=(r={style:{width:"10px"},value:e[t]}).value,n=r.style,u().createElement(O.xv,{style:n},s);var r,s,n}))),[u().createElement(O.xv,{key:e.last_seen,style:{width:"100px"}},"".concat(m))])})));return u().createElement(u().Fragment,{key:t},u().createElement(w.sg,null,u().createElement(w.iA,{withHeader:!0,rows:[n.map((function(e){return r=(t=e).value,s=t.style,u().createElement(O.xv,{style:T(T(T({},s),A.header),A.bold)},r);var t,r,s}))].concat((0,b.Z)(o))})))};C.propTypes={systems:Z().object,page:Z().number,intl:Z().any};var N=function(e){var t=e.systemsTotal,r=e.systems,s=e.filters,n=e.tags,a=e.intl;return delete s.offset,delete s.limit,u().createElement(u().Fragment,{key:"".concat(a.formatMessage(U.Z.insightsHeader),": ").concat(a.formatMessage(U.Z.systems))},u().createElement(O.xv,{key:"sys-count",style:A.text},a.formatMessage(U.Z.sysTableCount,{systems:u().createElement(O.xv,{key:"sys-count-count",style:A.bold},a.formatMessage(U.Z.execReportHeaderSystems,{systems:t}),t>1e3&&a.formatMessage(U.Z.dueTo))})),u().createElement(O.xv,{key:"sys-filters",style:A.text},a.formatMessage(U.Z.filtersApplied)),u().createElement(O.xv,{key:"sys-filters-values",style:A.bold},Object.entries(s).map((function(e){return u().createElement(O.xv,{key:e},"".concat(e[0],": ").concat(e[1],"     "))}))),u().createElement(O.xv,{key:"sys-tags",style:A.text},a.formatMessage(U.Z.tagsApplied)),u().createElement(O.xv,{key:"sys-tags-values",style:A.bold},n?decodeURIComponent(n):a.formatMessage(U.Z.noTags)),u().createElement(w.$0,{key:"systems",title:"Systems"},C({systems:r,intl:a})))};N.propTypes={systems:Z().object,systemsTotal:Z().number,filters:Z().object,tags:Z().array,intl:Z().any};var F=r(86896);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var H=function(e){var t=e.filters,r=(0,F.Z)(),n=(0,c.useState)(!1),i=(0,a.Z)(n,2),m=i[0],y=i[1],v=(0,p.useSelector)((function(e){return e.AdvisorStore.selectedTags})),g=(0,p.useSelector)((function(e){return e.AdvisorStore.workloads})),h=(0,p.useSelector)((function(e){return e.AdvisorStore.SID})),O=function(){var e=(0,s.Z)(o().mark((function e(){var s,n,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),s=v.length&&{tags:v},g&&(s=L(L({},s),(0,f.s0)(g,h))),e.next=5,(0,d.dX)("".concat(l._n,"/export/systems/"),{},L(L({},t),s));case 5:return n=e.sent.data,a=N({systemsTotal:null==n?void 0:n.length,systems:n.slice(0,18),filters:t,tags:v,intl:r}),i=n.slice(18,982).reduce((function(e,t,r){var s=Math.floor(r/31);return!e[s]&&(e[s]=[]),e[s].push(t),e}),[]),y(!1),e.abrupt("return",[a].concat((0,b.Z)(i.map((function(e,t){return C({page:t,systems:e,intl:r})})))));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,c.useMemo)((function(){return u().createElement(w.o6,{groupName:r.formatMessage(U.Z.redHatInsights),allPagesHaveTitle:!1,label:m?r.formatMessage(U.Z.loading):r.formatMessage(U.Z.exportPdf),asyncFunction:O,buttonProps:L({variant:"",component:"button",className:"pf-c-dropdown__menu-item systemsPdfOverride"},m?{isDisabled:!0}:null),reportName:"".concat(r.formatMessage(U.Z.insightsHeader),":"),type:r.formatMessage(U.Z.systems),fileName:"Advisor_systems--".concat((new Date).toUTCString().replace(/ /g,"-"),".pdf"),size:[841.89,595.28]})}),[m])};H.propTypes={filters:Z().object,systemsCount:Z().number};const V=H;var R=r(58921),W=r(46655),Y=r(41131),z=r(28672),B=r(43707);function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const q=function(){var e,t=(0,F.Z)(),r=(0,p.useDispatch)(),i=(0,p.useStore)(),b=(0,v.useLocation)().search,w=(0,p.useSelector)((function(e){return e.filters.selectedTags})),O=(0,p.useSelector)((function(e){return e.filters.workloads})),P=(0,p.useSelector)((function(e){return e.filters.SID})),Z=(0,p.useSelector)((function(e){return e.filters.recState})),k=function(e){return r((0,z.pu)(e))},x=(0,B.T)("advisor",l.Gd.export).hasAccess,_=(0,c.useState)(!0),j=(0,a.Z)(_,2),S=j[0],E=j[1],M=[{title:t.formatMessage(U.Z.numberRuleHits),transforms:[m.sortable,m.wrappable],key:"hits"},{title:t.formatMessage(U.Z.critical),transforms:[m.sortable,m.wrappable],key:"critical_hits"},{title:t.formatMessage(U.Z.important),transforms:[m.sortable,m.wrappable],key:"important_hits"},{title:t.formatMessage(U.Z.moderate),transforms:[m.sortable,m.wrappable],key:"moderate_hits"},{title:t.formatMessage(U.Z.low),transforms:[m.sortable,m.wrappable],key:"low_hits"}],D=function(e){var t=X(X({},Z),{},{offset:0});delete t[e],"hits"===e&&void 0===t.hits&&(t.hits=["yes"]),k(t)},T=function(e,t){"hits"===e&&t.length>1&&t.includes("yes")&&t.shift(),t.length>0?k(X(X({},Z),{},{offset:0},(0,n.Z)({},e,t))):D(e)},A=[{label:l.Ut.hits.title.toLowerCase(),type:l.Ut.hits.type,id:l.Ut.hits.urlParam,value:"checkbox-".concat(l.Ut.hits.urlParam),filterValues:{key:"".concat(l.Ut.hits.urlParam,"-filter"),onChange:function(e,t){return T(l.Ut.hits.urlParam,t)},value:Z.hits,items:l.Ut.hits.values}},{label:l.Ut.incident.title.toLowerCase(),type:l.Ut.incident.type,id:l.Ut.incident.urlParam,value:"checkbox-".concat(l.Ut.incident.urlParam),filterValues:{key:"".concat(l.Ut.incident.urlParam,"-filter"),onChange:function(e,t){T(l.Ut.incident.urlParam,t)},value:Z.incident,items:l.Ut.incident.values}},{label:l.Ut.rhel_version.title.toLowerCase(),type:l.Ut.rhel_version.type,id:l.Ut.rhel_version.urlParam,value:"checkbox-".concat(l.Ut.rhel_version.urlParam),filterValues:{key:"".concat(l.Ut.rhel_version.urlParam,"-filter"),onChange:function(e,t){T(l.Ut.rhel_version.urlParam,t)},value:Z.rhel_version,items:l.Ut.rhel_version.values}}],C={deleteTitle:t.formatMessage(U.Z.resetFilters),filters:(e=X({},Z),e.hits&&e.hits.includes("yes")&&delete e.hits,delete e.sort,delete e.offset,delete e.limit,(0,f.yK)(e,l.Ut)),onDelete:function(e,t,r){r?k({sort:Z.sort,limit:Z.limit,offset:Z.offset,hits:["yes"]}):t.map((function(e){var t=(0,n.Z)({},e.urlParam,Array.isArray(Z[e.urlParam])?Z[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?k(X(X({},Z),t)):D(e.urlParam)}))}},N=function(e){var t=e.display_name,r=e.hits,s=X(X(X({},e),t&&{display_name:t}),r&&{hits:r});(0,f.Y4)(s,w)};return(0,c.useEffect)((function(){var e;if(b){var t=(0,f.yG)();delete t.tags,void 0!==t.sort&&(t.sort=t.sort[0]),void 0!==t.display_name&&(t.display_name=t.display_name[0]),void 0===t.hits&&(t.hits=["all"]),void 0===t.offset||isNaN(t.offset)?t.offset=0:t.offset=Number(t.offset[0]),void 0===t.limit||isNaN(t.limit)?t.limit=20:t.limit=Number(t.limit[0]),e=X(X({},Z),t),void 0!==t.incident&&!Array.isArray(t.incident)&&(t.incident=["".concat(t.incident)]),k(e)}else void 0!==Z.limit&&void 0!==Z.offset&&void 0!==Z.hits||(e=X(X({},Z),{},{offset:0,limit:20,hits:["all"]}),k(e));E(!1),(0,f.Y4)(e,w)}),[]),!S&&u().createElement(y.Z,{hideFilters:{all:!0,name:!1},initialLoading:!0,autoRefresh:!0,disableDefaultColumns:!0,customFilters:{advisorFilters:Z,selectedTags:w,workloads:O,SID:P},columns:function(e){return function(e){var t=e.filter((function(e){return"updated"===e.key})),r=e.filter((function(e){return"display_name"===e.key})),s=e.filter((function(e){return"system_profile"===e.key}));return r=X(X({},r[0]),{},{transforms:[m.sortable,m.wrappable],props:{isStatic:!0},renderFunc:function(e,t,r){return u().createElement(u().Fragment,null,u().createElement(v.Link,{key:t,to:"/systems/".concat(r.system_uuid)},"".concat(r.display_name," ")),r.incident_hits>0&&u().createElement(h.Z,{rule:{tags:"incident"}}))}}),t=X(X({},t[0]),{},{transforms:[m.sortable,m.wrappable],props:{width:20}}),[r,s=X(X({},s[0]),{},{transforms:[m.wrappable]})].concat(M,[t])}(e)},onLoad:function(e){var t=e.mergeWithEntities,r=e.INVENTORY_ACTION_TYPES,s=e.mergeWithDetail;i.replaceReducer((0,Y.U)(X(X({},t((0,W.V)([],r),{page:Number(Z.offset/Z.limit+1||1),perPage:Number(Z.limit||20)})),s())))},getEntities:function(){var e=(0,s.Z)(o().mark((function e(t,r,s,n){var a,i,c,u,m,p,y,v,g,h,b,w,O,P,Z,k;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m=r.per_page,p=r.page,y=r.orderBy,v=r.orderDirection,g=r.advisorFilters,h=r.selectedTags,b=r.workloads,w=r.SID,O="".concat("ASC"===v?"":"-").concat("updated"===y?"last_seen":y),P=X(X(X(X(X({},g),{},{limit:m,offset:p*m-m,sort:O},r.filters.hostnameOrId&&{display_name:null==r||null===(a=r.filters)||void 0===a?void 0:a.hostnameOrId}),Array.isArray(g.incident)&&{incident:null==g||null===(i=g.incident)||void 0===i?void 0:i.join(",")}),Array.isArray(g.rhel_version)&&{rhel_version:null===(c=g.rhel_version)||void 0===c?void 0:c.join(",")}),h.length&&{tags:h}),b&&(P=X(X({},P),(0,f.s0)(b,w))),e.next=6,(0,d.dX)(l.Vo,{},P);case 6:if(e.t1=u=e.sent,e.t0=null===e.t1,e.t0){e.next=10;break}e.t0=void 0===u;case 10:if(!e.t0){e.next=14;break}e.t2=void 0,e.next=15;break;case 14:e.t2=u.data;case 15:return Z=e.t2,N(P),e.next=19,n(Z.data.map((function(e){return e.system_uuid})),{page:p,per_page:m,hasItems:!0,fields:{system_profile:["operating_system"]}},s);case 19:return k=e.sent,e.abrupt("return",Promise.resolve({results:(0,f.E9)(Z.data,k.results),total:Z.meta.count}));case 21:case"end":return e.stop()}}),e)})));return function(t,r,s,n){return e.apply(this,arguments)}}(),tableProps:{isStickyHeader:!0,variant:m.TableVariant.compact},isFullView:!0,hasCheckbox:!1,filterConfig:{items:A},activeFiltersConfig:C,exportConfig:{onSelect:function(e,t){return(0,R.Z)("systems",t,Z,w,O,P)},extraItems:[u().createElement("li",{key:"download-pd",role:"menuitem"},u().createElement(V,{filters:X({},(0,f.qW)(Z))}))],isDisabled:!x,tooltipText:x?t.formatMessage(U.Z.exportData):t.formatMessage(U.Z.permsAction)},fallback:g.Z})}}}]);
//# sourceMappingURL=../sourcemaps/SystemsTable.fdc9da0505a253e8d9a6eb153e050fd4.js.map