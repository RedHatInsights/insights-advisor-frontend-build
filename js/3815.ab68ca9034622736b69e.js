(self.webpackChunkadvisor=self.webpackChunkadvisor||[]).push([[3815],{58921:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(4942),o=n(15861),a=n(87757),i=n.n(a),l=n(53446),c=n(35240),s=n(59303),u=n(71094),d=n(97109);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(e){var t={date:(new Date).toISOString().replace(/[T:]/g,"-").split(".")[0]+"-utc"};return"Insights-Advisor_".concat(e,"--").concat(t.date)};const g=function(){var e=(0,o.Z)(i().mark((function e(t,n,r,o,a,p,g,h){var v,y,b;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v=(null==o?void 0:o.length)&&{tags:o},a&&(v=f(f({},v),(0,d.s0)(a,p))),g((0,l.addNotification)(s.LH.pending)),e.next=6,(0,u.dX)("".concat(s._n,"/export/").concat(t,".").concat("json"===n?"json":"csv"),{},f(f(f({},r),v),h&&{display_name:h})).then((function(e){return g((0,l.addNotification)(s.LH.success)),e})).catch((function(){return g((0,l.addNotification)(s.LH.error))}));case 6:y=e.sent.data,b="json"===n?JSON.stringify(y):y,(0,c.Sv)(b,m(t),n),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),"".concat(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,r,o,a,i,l,c){return e.apply(this,arguments)}}()},87516:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(75824),o=n(69174),a=n(45697),i=n.n(a),l=n(93264),c=n.n(l),s=n(30893),u=n(86896),d=function(e){var t,n=e.rule,a=e.isCompact,i=e.noMargin,l=(0,u.Z)();return c().createElement(c().Fragment,null,-1!==(null==n||null===(t=n.tags)||void 0===t?void 0:t.search("incident"))&&c().createElement(r.u,{content:l.formatMessage(s.Z.incidentTooltip),position:r.D.right},c().createElement(o._,{color:"red",className:i?null:"adv-c-label-incident",isCompact:a},l.formatMessage(s.Z.incident))),"disabled"===(null==n?void 0:n.rule_status)&&c().createElement(r.u,{content:l.formatMessage(s.Z.ruleIsDisabledTooltip),position:r.D.right},c().createElement(o._,{color:"gray",isCompact:a},l.formatMessage(s.Z.disabled))),"rhdisabled"===(null==n?void 0:n.rule_status)&&c().createElement(r.u,{content:l.formatMessage(s.Z.ruleIsDisabledTooltip),position:r.D.right},c().createElement(o._,{color:"gray",isCompact:a},l.formatMessage(s.Z.redhatDisabled))))};d.propTypes={rule:i().object,isCompact:i().bool,noMargin:i().bool},d.defaultProps={isCompact:!0};const p=d},47197:(e,t,n)=>{"use strict";n.d(t,{Z:()=>se});var r=n(87462),o=n(15861),a=n(4942),i=n(42982),l=n(70885),c=n(87757),s=n.n(c),u=n(59303),d=n(32203),p=n(62394),f=n(86896),m=n(93264),g=n.n(m),h=n(48585),v=n(3351),y=n(22860),b=n(6934),k=n(75863),Z=n(28216),E=n(71094),_=n(24561),O=n(7887),w=n(45697),P=n.n(w),j=n(98132),C=n(71355),S=n(97109),x=n(30893),D=n(87135),M=n(27361),W=n.n(M),T=n(46818),I=n(7732),R=n(75824),A=n(16712),N=n(90693),L=n(62410),H=n(87516),F=n(27330),V=n(74761),B=n(98614),G=n(72781),q=n(52643),z=n(47173),K=n(66435),X=n(49739),J=n(83826),$=n(34702),Q=function(){return g().createElement(q.b,null,g().createElement($.Z,{title:"No matching recommendations found",text:"To continue, edit your filter settings and search again."}))},U=function(){return g().createElement(q.b,null,g().createElement($.Z,{icon:B.ZP,iconClass:"ins-c-insights__check",title:"No recommendations",text:"No known recommendations affect this system"}))},Y=function(){return g().createElement($.Z,{iconClass:"chartSpikeIconColor",icon:V.ZP,title:"Get started with Red Hat Insights",text:g().createElement(q.b,null,g().createElement(X.K,{hasGutter:!0},g().createElement(J.v,null,"1. Install the client on the RHEL system.",g().createElement(K.M5,null,"yum install insights-client")),g().createElement(J.v,null,"2. Register the system to Red Hat Insights.",g().createElement(K.M5,null,"insights-client --register"))))},g().createElement(z.zx,{component:"a",href:"https://access.redhat.com/products/red-hat-insights#getstarted",target:"_blank",variant:"primary"},"Getting started documentation"))},ee=function(e){var t=e.entity;return g().createElement(q.b,null,g().createElement($.Z,{icon:G.ZP,title:"Error getting recommendations",text:t?"There was an error fetching recommendations for this entity. Refresh your page to try again.":"This entity can not be found or might no longer be registered to Red Hat Insights."}))};ee.propTypes={entity:P().object};var te=n(62012);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=n(58921),ae=n(43707);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t,n=e.entity,r=e.inventoryId,c=(0,f.Z)(),w=(0,m.useRef)({rowCount:0}),P=(0,Z.I0)(),M=function(e){return P((0,C.addNotification)(e))},V=(0,te.useParams)().id,B=(0,m.useState)("pending"),G=(0,l.Z)(B,2),q=G[0],z=G[1],K=(0,m.useState)([]),X=(0,l.Z)(K,2),J=X[0],$=X[1],ne=(0,m.useState)([]),ie=(0,l.Z)(ne,2),ce=ie[0],se=ie[1],ue=(0,m.useState)([]),de=(0,l.Z)(ue,2),pe=de[0],fe=de[1],me=(0,m.useState)({}),ge=(0,l.Z)(me,2),he=ge[0],ve=ge[1],ye=(0,m.useState)({}),be=(0,l.Z)(ye,2),ke=be[0],Ze=be[1],Ee=(0,m.useState)(""),_e=(0,l.Z)(Ee,2),Oe=_e[0],we=_e[1],Pe=(0,m.useState)(!1),je=(0,l.Z)(Pe,2),Ce=je[0],Se=je[1],xe=(0,m.useState)(!1),De=(0,l.Z)(xe,2),Me=De[0],We=De[1],Te=(0,Z.v9)((function(e){var t=e.filters;return null==t?void 0:t.selectedTags})),Ie=(0,Z.v9)((function(e){var t=e.filters;return null==t?void 0:t.workloads})),Re=(0,Z.v9)((function(e){var t=e.filters;return null==t?void 0:t.SID})),Ae=(0,ae.TE)("advisor",u.Gd.export).hasAccess,Ne=function(e){return e.filter((function(e){return e.selected}))},Le=Ne(J).filter((function(e){var t;return null===(t=e.resolution)||void 0===t?void 0:t.has_playbook})),He=Ne(J).length,Fe=J.filter((function(e){var t;return null===(t=e.resolution)||void 0===t?void 0:t.has_playbook})).length,Ve=function(e){return[{title:e.formatMessage(x.Z.topicAddEditDescription),transforms:[I.p]},{title:e.formatMessage(x.Z.modified),transforms:[I.p,T.E0]},{title:e.formatMessage(x.Z.firstImpacted),transforms:[I.p,T.E0]},{title:e.formatMessage(x.Z.totalRisk),transforms:[I.p,T.E0]},{title:e.formatMessage(x.Z.remediation),transforms:[I.p,T.E0]}]}(c),Be=[g().createElement(j.Z,{key:"remediation-button",isDisabled:0===Le.length,dataProvider:function(){return Qe(Le)},onRemediationCreated:function(e){return function(e){ze(!1);try{e.remediation&&M(e.getNotification())}catch(e){M({variant:"danger",dismissable:!0,title:c.formatMessage(x.Z.error),description:"".concat(e)})}}(e)}},c.formatMessage(x.Z.remediate))],Ge=function(e){var t=(0,i.Z)(e),n=V?e.findIndex((function(e){return e.rule.rule_id===V})):-1,r=t.splice(n,1);return-1!==n?[r[0]].concat((0,i.Z)(t)):e},qe=function(e,t,n,r){var o,a=null===(o=(0,te.useLocation)().pathname)||void 0===o?void 0:o.split("/");return(0,m.useCallback)((function(o,i,l,c){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",d=arguments.length>5&&void 0!==arguments[5]&&arguments[5],p=arguments.length>6&&void 0!==arguments[6]&&arguments[6],f=o,m=window.location.href.indexOf("activeRule")>-1;if(m&&p){var h=a[2];f.sort((function(e,t){return e.rule.rule_id===h?-1:t.rule.rule_id===h?1:0}))}else p&&f.sort((function(e,t){return e.rule.total_risk>t.rule.total_risk?-1:t.rule.total_risk>e.rule.total_risk?1:0}));var v=f.flatMap((function(t,n){var r=t.rule,o=t.resolution,a=Object.keys(i).length?i.filter((function(e){return e.id===t.rule.node_id}))[0]:{},f=c.find((function(e){var t;return(null==e||null===(t=e.rule)||void 0===t?void 0:t.rule_id)===r.rule_id})),h=null==f?void 0:f.selected,v=(null==f?void 0:f.isOpen)||m&&p&&0===n,y=[{rule:r,resolution:o,isOpen:o?v:void 0,selected:h,disableSelection:!o||!o.has_playbook,cells:[{title:g().createElement("span",null,r.description," ",g().createElement(H.Z,{rule:r}))},{title:g().createElement("span",null,g().createElement(L.Z,{date:r.publish_date,type:"relative",tooltipProps:{position:R.D.bottom}}))},{title:g().createElement("div",{key:n},g().createElement(L.Z,{date:t.impacted_date,type:"relative",tooltipProps:{position:R.D.bottom}}))},{title:g().createElement("div",{key:n,style:{verticalAlign:"top"}},g().createElement(R.u,{key:n,position:R.D.bottom,content:g().createElement("span",null,"The ",g().createElement("strong",null,"likelihood")," that this will be a problem is ",u.FV[r.likelihood],". The"," ",g().createElement("strong",null,"impact")," of the problem would be Â ",u.dz[r.impact.impact]," if it occurred.")},g().createElement(N.Z,{value:r.total_risk,isCompact:!0})))},{title:g().createElement("div",{className:"ins-c-center-text",key:n},null===o?e.formatMessage(x.Z.notAvailable):null!=o&&o.has_playbook?g().createElement("span",null,g().createElement(A.ZP,{size:"sm"})," ",e.formatMessage(x.Z.playbook)):e.formatMessage(x.Z.manual))}]},o&&{parent:n,fullWidth:!0,cells:[{title:g().createElement(F.G,{key:"child-".concat(n),report:re(re({},t),{},{resolution:t.resolution.resolution}),kbaDetail:a,kbaLoading:d})}]}],b=0===s.length||r.description.toLowerCase().includes(s.toLowerCase()),k=0===Object.keys(l).length||Object.keys(l).map((function(e){var n,o=l[e],a={has_playbook:null===(n=t.resolution)||void 0===n?void 0:n.has_playbook,publish_date:r.publish_date,total_risk:r.total_risk,category:u.kT[r.category.name.toLowerCase()]};return o.find((function(t){return String(t)===String(a[e])}))})).every((function(e){return e}));return b&&k?y.filter((function(e){return null!==e})):[]}));if(v.forEach((function(e,t){return e.parent?e.parent=t-1:null})),t.current.rowCount=o.length,o.length<1||v.length<1){var y=0===v.length&&Q||(null==n?void 0:n.insights_id)&&U||Y;return[{heightAuto:!0,cells:[{props:{colSpan:5},title:g().createElement(y,null)}]}]}return"failed"===r?[{heightAuto:!0,cells:[{props:{colSpan:5},title:g().createElement(ee,{entity:n})}]}]:v}),[n,r])}(c,w,n,q),ze=function(e){Se(e),$(qe(ce,pe,ke,J.map((function(t,n){return n%2==0&&t.resolution.has_playbook?le(le({},t),{},{selected:e}):t})),Oe))},Ke={items:[{title:"Select none",onClick:function(){return ze(!1)}},{title:"Select all",onClick:function(){return ze(!0)}}],count:He,checked:He===w.current.rowCount?1:He>0||Fe!==w.current.rowCount?null:0,onSelect:function(){return ze(!Ce)}},Xe={deleteTitle:c.formatMessage(x.Z.resetFilters),filters:function(e){var t=Object.entries(e),n=e&&t.length>0?t.map((function(e){var t=u.W2[e[0]],n=e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}}));return{category:(0,S.kC)(t.title),chips:n,urlParam:t.urlParam}})):[];return Oe.length>0&&n.push({category:"Description",chips:[{name:Oe,value:Oe}]}),n}(ke),onDelete:function(e,t,n){n?($(qe(ce,pe,{},J,"")),Ze({}),we("")):t.map((function(e){"Description"===e.category?($(qe(ce,pe,ke,J,"")),we("")):$e(e.urlParam,ke[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}))}},Je=function(){var e=(0,o.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.rule.node_id})).filter((function(e){return e})),e.prev=1,e.next=4,(0,E.dX)("https://access.redhat.com/hydra/rest/search/kcs?q=id:(".concat(n.join(" OR "),")&fq=documentKind:(Solution%20or%20Article)&fl=view_uri,id,publishedTitle&redhat_client=$ADVISOR"),{},{credentials:"include"});case 4:r=e.sent.data.response.docs,fe(r),$(qe(t,r,ke,J,Oe,!1,!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0,"KBA fetch failed.");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),$e=function(e,t){var n=t.length>0?le(le({},ke),(0,a.Z)({},e,t)):function(e){var t=le({},ke);return delete t[e],t}(e);$(qe(ce,pe,n,J,Oe)),Ze(n)},Qe=function(e){return(0,m.useCallback)((function(t){var n=t.filter((function(e){var t;return null===(t=e.resolution)||void 0===t?void 0:t.has_playbook})).map((function(e){return{id:"advisor:".concat(e.rule.rule_id),description:e.rule.description}}));return!!n.length&&{issues:n,systems:[e]}}),[e])}(r),Ue=function(e,t,n,r){return[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return n(t)},value:t}},{label:u.W2.total_risk.title,type:u.W2.total_risk.type,id:u.W2.total_risk.urlParam,value:"checkbox-".concat(u.W2.total_risk.urlParam),filterValues:{key:"".concat(u.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return r(u.W2.total_risk.urlParam,t)},value:e.total_risk,items:u.W2.total_risk.values}},{label:u.W2.category.title,type:u.W2.category.type,id:u.W2.category.urlParam,value:"checkbox-".concat(u.W2.category.urlParam),filterValues:{key:"".concat(u.W2.category.urlParam,"-filter"),onChange:function(e,t){return r(u.W2.category.urlParam,t)},value:e.category,items:u.W2.category.values}},{label:u.W2.has_playbook.title,type:u.W2.has_playbook.type,id:u.W2.has_playbook.urlParam,value:"checkbox-".concat(u.W2.has_playbook.urlParam),filterValues:{key:"".concat(u.W2.has_playbook.urlParam,"-filter"),onChange:function(e,t){return r(u.W2.has_playbook.urlParam,t)},value:e.has_playbook,items:u.W2.has_playbook.values}}]}(ke,Oe,(function(e){var t=qe(ce,pe,ke,J,e);we(e),$(t)}),$e);(0,m.useEffect)((function(){var e=function(){var e=(0,o.Z)(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,E.dX)("".concat(u._n,"/system/").concat(r,"/reports/"),{credentials:"include"});case 3:t=e.sent,n=Ge(t.data),Je(n),$(qe(n,{},ke,J,Oe,!0)),z("fulfilled"),se(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),z("failed");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var Ye=null==n?void 0:n.display_name;return"fulfilled"===q&&null===(null==n?void 0:n.insights_id)?g().createElement(D.Z,{titleText:c.formatMessage(x.Z.notConnectedTitle),bodyText:c.formatMessage(x.Z.notConnectedBody),buttonText:c.formatMessage(x.Z.notConnectedButton)}):g().createElement("div",{className:"ins-c-inventory-insights__overrides"},"pending"===q||null===(null==n?void 0:n.insights_id)?g().createElement(m.Fragment,null):g().createElement(O.Z,{expandAll:{isAllExpanded:Me,onClick:function(e,t){We(t);var n=(0,i.Z)(J);n.map((function(e){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t)})),$(n)}},actionsConfig:{actions:Be},bulkSelect:Ke,filterConfig:{items:Ue},pagination:g().createElement(m.Fragment,null," ","".concat(w.current.rowCount," ").concat(1===w.current.rowCount?"Recommendation":"Recommendations")," "),activeFiltersConfig:Xe,exportConfig:(t={label:c.formatMessage(x.Z.exportCsv)},(0,a.Z)(t,"label",c.formatMessage(x.Z.exportJson)),(0,a.Z)(t,"onSelect",(function(e,t){return(0,oe.Z)("hits",t,le(le({},ke),{},{text:Oe}),Te,Ie,Re,P,Ye)})),(0,a.Z)(t,"isDisabled",!Ae),(0,a.Z)(t,"tooltipText",Ae?c.formatMessage(x.Z.exportData):c.formatMessage(x.Z.permsAction)),t)}),"pending"===q&&g().createElement(d.Z,null,g().createElement(p.e,null,g().createElement(_.aV,null))),"fulfilled"===q&&g().createElement(m.Fragment,null,g().createElement(v.i,{id:"system-advisor-report-table","aria-label":"report-table",onSelect:!(1===J.length&&J[0].heightAuto)&&function(e,t,n){return $(qe(ce,pe,ke,J.map((function(e,r){return r===n?le(le({},e),{},{selected:t}):e})),Oe))},onCollapse:function(e,t,n){var r=(0,i.Z)(J);r[t]=le(le({},r[t]),{},{isOpen:n}),$(r)},rows:J,cells:Ve,sortBy:he,canSelectAll:!1,onSort:function(e,t,n){var r={2:"rule.description",3:"rule.publish_date",4:"impacted_date",5:"rule.total_risk",6:"resolution.has_playbook"},o=n===h.B.asc?1:-1,a=ce.concat().sort((function(e,n){var a=W()(e,r[t]),i=W()(n,r[t]);return 3!==t&&4!==t||(a=new Date(a),i=new Date(i)),a>i?o:i>a?-o:0}));se(a),ve({index:t,direction:n}),$(qe(a,pe,ke,J,Oe))},variant:k.B.compact,isStickyHeader:!0},g().createElement(b.x,null),g().createElement(y.R,null))))};ce.propTypes={entity:P().shape({insights_id:P().string,id:P().string}),inventoryId:P().string.isRequired};const se=function(e){var t=(0,r.Z)({},e),n=(0,Z.v9)((function(e){return e.entityDetails.entity}));return g().createElement(ce,(0,r.Z)({},t,{entity:n}))}},45467:()=>{},11452:()=>{},34946:()=>{},80598:()=>{},32857:()=>{},37625:()=>{},28992:()=>{},30187:()=>{},90479:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{},53519:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/3815.68bb0d0273a004f32578cfe905ea8ca5.js.map