(self.webpackChunkadvisor_frontend=self.webpackChunkadvisor_frontend||[]).push([[384],{22080:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(94015),l=a.n(r),n=a(23645),o=a.n(n)()(l());o.push([e.id,".advisor .ansibleCheck{color:var(--pf-global--success-color--100)}@media screen and (min-width: 884px){.advisor .ins-c-conditional-filter .ins-c-conditional-filter__group .pf-c-dropdown__toggle-text{min-width:150px !important}}.advisor .ins-c-center-text{text-align:center}.advisor .pf-c-table tr>:last-child{--pf-c-table--cell--PaddingRight: 0px}\n","",{version:3,sources:["webpack://./src/PresentationalComponents/RulesTable/_RulesTable.scss"],names:[],mappings:"AAAA,uBACc,0CAA0C,CAAC,qCADzD,gGACqL,0BAA0B,CAAE,CADjN,4BACoO,iBAAiB,CADrP,oCACiR,qCAAiC",sourcesContent:[".advisor{\n.ansibleCheck{color:var(--pf-global--success-color--100)}@media screen and (min-width: 884px){.ins-c-conditional-filter .ins-c-conditional-filter__group .pf-c-dropdown__toggle-text{min-width:150px !important}}.ins-c-center-text{text-align:center}.pf-c-table tr>:last-child{--pf-c-table--cell--PaddingRight: 0px}\n\n}"],sourceRoot:""}]);const i=o},72134:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var r=a(80043),l=a(67301),n=a(94949),o=a(11102),i=a(87757),s=a.n(i),c=(a(55294),a(64169)),u=a(20999),E=a(13877),f=a(97522),d=a.n(f),m=a(88292),p=a(49772),T=a(76004),R=a(26042),_=a(37802),b=a(61829),I=a(84785),g=a(6202),C=a(35451),S=a(62410),k=a(31115),A=a(59900),h=a(78216),v=a(16530),y=a(82141),O=a(86350),F=a(75824),L=a(57277),Z=a(45697),P=a.n(Z),G=a(2692),x=a(83307),M=a(66010),w=a(85771),D=a(43476),B=a(40050),N=a(24405),j=a(18623),H=a(36873),V=a(28174),W=a(86896),Y=a(43707);function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?q(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var K=function(e){var t,a=e.rules,i=e.filters,c=e.rulesFetchStatus,Z=e.setFilters,P=e.fetchRules,w=e.addNotification,D=e.selectedTags,H=e.workloads,q=e.SID,K=(0,W.Z)(),U=(0,Y.T)("advisor",u.PERMS.export).hasAccess,J=(0,Y.T)("advisor",u.PERMS.disableRec).hasAccess,Q=(0,f.useState)([{title:K.formatMessage(j.Z.name),transforms:[p.sortable,(0,p.cellWidth)(45)]},{title:K.formatMessage(j.Z.added),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:K.formatMessage(j.Z.totalRisk),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:K.formatMessage(j.Z.riskofchange),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:K.formatMessage(j.Z.systems),transforms:[p.sortable,(0,p.cellWidth)(15)]},{title:d().createElement(d().Fragment,null,d().createElement(b.ZP,{size:"md"})," ",K.formatMessage(j.Z.ansible)),transforms:[p.sortable,(0,p.cellWidth)(15),p.fitContent],dataLabel:K.formatMessage(j.Z.ansible)}]),X=(0,o.Z)(Q,1)[0],$=(0,f.useState)([]),ee=(0,o.Z)($,2),te=ee[0],ae=ee[1],re=(0,f.useState)({}),le=(0,o.Z)(re,2),ne=le[0],oe=le[1],ie=(0,f.useState)(!0),se=(0,o.Z)(ie,2),ce=se[0],ue=se[1],Ee=(0,f.useState)(i.text||""),fe=(0,o.Z)(Ee,2),de=fe[0],me=fe[1],pe=(0,f.useState)(!1),Te=(0,o.Z)(pe,2),Re=Te[0],_e=Te[1],be=(0,f.useState)({}),Ie=(0,o.Z)(be,2),ge=Ie[0],Ce=Ie[1],Se=(0,f.useState)(!1),ke=(0,o.Z)(Se,2),Ae=ke[0],he=ke[1],ve=(0,f.useState)({}),ye=(0,o.Z)(ve,2),Oe=ye[0],Fe=ye[1],Le=(0,B.Z)(de,u.DEBOUNCE_DELAY),Ze=a.meta?a.meta.count:0,Pe={1:"description",2:"publish_date",3:"total_risk",4:"resolution_risk",5:"impacted_count",6:"playbook_count"},Ge=function(e){var t=e.resolution_set.find((function(e){return e.system_type===u.SYSTEM_TYPES.rhel||u.SYSTEM_TYPES.ocp}));return t?t.resolution_risk.risk:void 0},xe=(0,f.useCallback)((function(){(0,R.Y4)(i,D,H);var e=(null==D?void 0:D.length)&&{tags:D.map((function(e){return encodeURIComponent(e)}))};H&&(e=z(z({},e),(0,R.s0)(H,q))),P(e.tags?{}:z(z({},(0,R.qW)(i)),e),e.tags&&(0,R.gs)(z(z({},(0,R.qW)(i)),e)))}),[i,D,H,q,P]),Me=function(e){var t=e*i.limit-i.limit;Z(z(z({},i),{},{offset:t}))},we=function(e){Z(z(z({},i),{},{rule_status:e,offset:0},"enabled"!==e&&{impacting:!1}))},De=function(){var e=(0,r.Z)(s().mark((function e(t){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=te[t].rule,e.prev=1,"enabled"!==a.rule_status){e.next=7;break}Ce(a),_e(!0),e.next=17;break;case 7:return e.prev=7,e.next=10,_.Z.delete("".concat(u.BASE_URL,"/ack/").concat(a.rule_id,"/"));case 10:w({variant:"success",timeout:!0,dismissable:!0,title:K.formatMessage(j.Z.ruleSuccessfullyEnabled)}),xe(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),w({variant:"danger",dismissable:!0,title:K.formatMessage(j.Z.error),description:"".concat(e.t0)});case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(1),w({variant:"danger",dismissable:!0,title:"enabled"===a.rule_status?K.formatMessage(j.Z.rulesTableHideReportsErrorDisabled):K.formatMessage(j.Z.rulesTableHideReportsErrorEnabled),description:"".concat(e.t1)});case 22:case"end":return e.stop()}}),e,null,[[1,19],[7,14]])})));return function(t){return e.apply(this,arguments)}}(),Be=function(e){switch(e){case"enabled":return j.Z.rulesTableNoRuleHitsEnabledRulesBody;case"disabled":return j.Z.rulesTableNoRuleHitsDisabledRulesBody;case"rhdisabled":return j.Z.rulesTableNoRuleHitsRedHatDisabledRulesBody;default:return j.Z.rulesTableNoRuleHitsAnyRulesBody}};(0,f.useEffect)((function(){!ce&&null!==D&&xe()}),[xe,ce,i,D]),(0,f.useEffect)((function(){if(window.location.search&&ce){var e=(0,R.yG)();delete e.tags,delete e.sap_system,void 0===e.text?me(""):me(e.text),e.sort=void 0===e.sort?"-total_risk":e.sort[0],void 0!==e.has_playbook&&!Array.isArray(e.has_playbook)&&(e.has_playbook=["".concat(e.has_playbook)]),void 0!==e.incident&&!Array.isArray(e.incident)&&(e.incident=["".concat(e.incident)]),void 0===e.offset?e.offset=0:e.offset=Number(e.offset[0]),void 0===e.limit?e.limit=10:e.limit=Number(e.limit[0]),void 0!==e.reboot&&!Array.isArray(e.reboot)&&(e.reboot=["".concat(e.reboot)]),Z(z(z({},i),e))}ue(!1)}),[]),(0,f.useEffect)((function(){if(void 0!==i.sort){var e=Number(Object.entries(Pe).find((function(e){return e[1]===i.sort||"-".concat(e[1])===i.sort}))[0]),t="-"===i.sort[0]?"desc":"asc";oe({index:e,direction:t})}}),[i.sort]),(0,f.useEffect)((function(){if(a.data)if(0===a.data.length)ae([{cells:[{title:d().createElement(F.Z,{icon:C.default,iconClass:"ansibleCheck",title:K.formatMessage(j.Z.rulesTableNoRuleHitsTitle),text:K.formatMessage(Be(i.rule_status))},"enabled"===i.rule_status&&d().createElement(g.Button,{variant:"link",style:{paddingTop:24},onClick:function(){return we("all")}},K.formatMessage(j.Z.rulesTableNoRuleHitsAddDisabledButton))),props:{colSpan:6}}]}]);else{var e=a.data.flatMap((function(e,t){return[{isOpen:!1,rule:e,cells:[{title:d().createElement("span",{key:t},d().createElement(x.Z,{rule:e}),d().createElement(v.Link,{key:t,to:"/recommendations/".concat(e.rule_id)}," ",e.description," "))},{title:d().createElement(S.Z,{key:t,date:e.publish_date,variant:"relative"})},{title:d().createElement("div",{key:t},d().createElement(T.Tooltip,{key:t,position:T.TooltipPosition.bottom,content:K.formatMessage(j.Z.rulesDetailsTotalriskBody,{risk:u.TOTAL_RISK_LABEL_LOWER[e.total_risk]||K.formatMessage(j.Z.undefined),strong:function(e){return(0,V.f)(e)}})},d().createElement(h.Z,{value:e.total_risk})))},{title:d().createElement("div",{key:t},d().createElement(h.Z,{text:u.RISK_OF_CHANGE_LABEL[Ge(e)],value:Ge(e),hideIcon:!0}),d().createElement("div",null))},{title:d().createElement("div",{key:t},"".concat(e.impacted_systems_count.toLocaleString()))},{title:d().createElement("div",{className:"ins-c-center-text ",key:t},e.playbook_count?d().createElement(C.default,{className:"ansibleCheck"}):K.formatMessage(j.Z.no))}]},{parent:2*t,fullWidth:!0,cells:[{title:d().createElement(O.Z,{className:"pf-m-light"},d().createElement(m.Stack,{hasGutter:!0},e.hosts_acked_count?d().createElement(m.StackItem,null,d().createElement(I.ZP,{size:"sm"})," ",e.hosts_acked_count&&!e.impacted_systems_count?K.formatMessage(j.Z.ruleIsDisabledForAllSystems):K.formatMessage(j.Z.ruleIsDisabledForSystemsBody,{systems:e.hosts_acked_count}),"  ",d().createElement(g.Button,{isInline:!0,variant:"link",ouiaId:"viewSystem",onClick:function(){Fe(e),he(!0)}},K.formatMessage(j.Z.viewSystems))):d().createElement(d().Fragment,null),d().createElement(G.Z,{rule:e,resolutionRisk:Ge(e)})))}]}]}));ae(e.asMutable())}}),[a]),(0,f.useEffect)((function(){if(!ce&&"pending"!==c){var e=z({},i),t=de.length?{text:de}:{};delete e.text,Z(z(z(z({},e),t),{},{offset:0}))}}),[Le]);var Ne,je=function(e){var t=z(z({},i),{},{offset:0});"text"===e&&me(""),delete t[e],Z(t)},He=function(e,t){t.length>0?Z(z(z({},i),{},{offset:0},(0,n.Z)({},e,t))):je(e)},Ve=["",{label:K.formatMessage(i.impacting?j.Z.rulesTableActionShow:j.Z.rulesTableActionHide),onClick:function(){return e=!i.impacting,void Z(z(z({},i),{},{impacting:e,offset:0}));var e}}],We=[{label:K.formatMessage(j.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return me(t)},value:de,placeholder:K.formatMessage(j.Z.search)}},{label:u.FILTER_CATEGORIES.total_risk.title,type:u.FILTER_CATEGORIES.total_risk.type,id:u.FILTER_CATEGORIES.total_risk.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.total_risk.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.total_risk.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.total_risk.urlParam,t)},value:i.total_risk,items:u.FILTER_CATEGORIES.total_risk.values}},{label:u.FILTER_CATEGORIES.res_risk.title,type:u.FILTER_CATEGORIES.res_risk.type,id:u.FILTER_CATEGORIES.res_risk.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.res_risk.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.res_risk.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.res_risk.urlParam,t)},value:i.res_risk,items:u.FILTER_CATEGORIES.res_risk.values}},{label:u.FILTER_CATEGORIES.impact.title,type:u.FILTER_CATEGORIES.impact.type,id:u.FILTER_CATEGORIES.impact.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.impact.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.impact.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.impact.urlParam,t)},value:i.impact,items:u.FILTER_CATEGORIES.impact.values}},{label:u.FILTER_CATEGORIES.likelihood.title,type:u.FILTER_CATEGORIES.likelihood.type,id:u.FILTER_CATEGORIES.likelihood.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.likelihood.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.likelihood.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.likelihood.urlParam,t)},value:i.likelihood,items:u.FILTER_CATEGORIES.likelihood.values}},{label:u.FILTER_CATEGORIES.category.title,type:u.FILTER_CATEGORIES.category.type,id:u.FILTER_CATEGORIES.category.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.category.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.category.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.category.urlParam,t)},value:i.category,items:u.FILTER_CATEGORIES.category.values}},{label:u.FILTER_CATEGORIES.incident.title,type:u.FILTER_CATEGORIES.incident.type,id:u.FILTER_CATEGORIES.incident.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.incident.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.incident.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.incident.urlParam,t)},value:i.incident,items:u.FILTER_CATEGORIES.incident.values}},{label:u.FILTER_CATEGORIES.has_playbook.title,type:u.FILTER_CATEGORIES.has_playbook.type,id:u.FILTER_CATEGORIES.has_playbook.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.has_playbook.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.has_playbook.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.has_playbook.urlParam,t)},value:i.has_playbook,items:u.FILTER_CATEGORIES.has_playbook.values}},{label:u.FILTER_CATEGORIES.reboot.title,type:u.FILTER_CATEGORIES.reboot.type,id:u.FILTER_CATEGORIES.reboot.urlParam,value:"checkbox-".concat(u.FILTER_CATEGORIES.reboot.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.reboot.urlParam,"-filter"),onChange:function(e,t){return He(u.FILTER_CATEGORIES.reboot.urlParam,t)},value:i.reboot,items:u.FILTER_CATEGORIES.reboot.values}},{label:u.FILTER_CATEGORIES.rule_status.title,type:u.FILTER_CATEGORIES.rule_status.type,id:u.FILTER_CATEGORIES.rule_status.urlParam,value:"radio-".concat(u.FILTER_CATEGORIES.rule_status.urlParam),filterValues:{key:"".concat(u.FILTER_CATEGORIES.rule_status.urlParam,"-filter"),onChange:function(e,t){return we(t)},value:"".concat(i.rule_status),items:u.FILTER_CATEGORIES.rule_status.values}}],Ye={filters:(Ne=z({},i),delete Ne.impacting,delete Ne.topic,delete Ne.sort,delete Ne.offset,delete Ne.limit,(0,R.yK)(Ne,u.FILTER_CATEGORIES)),onDelete:function(e,t,a){a?(me(""),Z(z(z({},i.topic&&{topic:i.topic}),{},{impacting:!0,rule_status:"enabled",limit:i.limit,offset:i.offset}))):t.map((function(e){var t=(0,n.Z)({},e.urlParam,Array.isArray(i[e.urlParam])?i[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?Z(z(z({},i),t)):je(e.urlParam)}))}};return d().createElement(d().Fragment,null,Ae&&d().createElement(M.Z,{handleModalToggle:function(e){return he(e)},isModalOpen:Ae,afterFn:function(){xe()},rule:Oe}),Re&&d().createElement(k.Z,{handleModalToggle:_e,isModalOpen:Re,rule:ge,afterFn:xe}),d().createElement(L.Z,{pagination:{itemCount:Ze,page:i.offset/i.limit+1,perPage:Number(i.limit),onSetPage:function(e,t){Me(t)},onPerPageSelect:function(e,t){Z(z(z({},i),{},{limit:t,offset:0}))},isCompact:!0},exportConfig:(t={label:K.formatMessage(j.Z.exportCsv)},(0,n.Z)(t,"label",K.formatMessage(j.Z.exportJson)),(0,n.Z)(t,"onSelect",(function(e,t){return(0,N.Z)("hits",t,(0,R.Y4)(i,D))})),(0,n.Z)(t,"isDisabled",!U||!i.impacting),(0,n.Z)(t,"tooltipText",U?K.formatMessage(j.Z.exportData):K.formatMessage(j.Z.permsAction)),t),actionsConfig:{actions:Ve},filterConfig:{items:We},activeFiltersConfig:Ye}),"fulfilled"===c&&d().createElement(p.Table,{"aria-label":"rule-table",actionResolver:function(e,t){var a=t.rowIndex,r=te[a].rule?te[a].rule:null;return a%2==0&&r?r&&"enabled"===r.rule_status?[{title:K.formatMessage(j.Z.disableRule),onClick:function(e,t){return De(t)}}]:[{title:K.formatMessage(j.Z.enableRule),onClick:function(e,t){return De(t)}}]:null},onCollapse:function(e,t,a){var r=(0,l.Z)(te);r[t]=z(z({},r[t]),{},{isOpen:a}),ae(r)},sortBy:ne,onSort:function(e,t,a){var r="".concat("asc"===a?"":"-").concat(Pe[t]);oe({index:t,direction:a}),Z(z(z({},i),{},{sort:r,offset:0}))},cells:X,rows:te,areActionsDisabled:function(){return!J}},d().createElement(p.TableHeader,null),d().createElement(p.TableBody,null)),"pending"===c&&d().createElement(y.Z,null),"failed"===c&&d().createElement(A.Z,{message:K.formatMessage(j.Z.rulesTableFetchRulesError)}),d().createElement(E.tl,{ouiaId:"page",itemCount:Ze,page:i.offset/i.limit+1,perPage:Number(i.limit),onSetPage:function(e,t){Me(t)},onPerPageSelect:function(e,t){Z(z(z({},i),{},{limit:t,offset:0}))},widgetId:"pagination-options-menu-bottom",variant:E.aM.bottom}))};K.propTypes={fetchRules:P().func,rulesFetchStatus:P().string,rules:P().object,filters:P().object,addNotification:P().func,setFilters:P().func,selectedTags:P().array,workloads:P().object,SID:P().object};const U=(0,H.Z)((0,D.connect)((function(e){var t=e.AdvisorStore,a=e.ownProps;return z({rules:t.rules,rulesFetchStatus:t.rulesFetchStatus,filters:t.filters,selectedTags:t.selectedTags,workloads:t.workloads,SID:t.SID},a)}),(function(e){return{fetchRules:function(t,a){return e(c.j(t,a))},addNotification:function(t){return e((0,w.addNotification)(t))},setFilters:function(t){return e(c.rr(t))}}}))(K))},55294:(e,t,a)=>{"use strict";var r=a(93379),l=a.n(r),n=a(22080),o=l()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var i=n.default.locals;e.hot.accept(22080,(t=>{n=a(22080),function(e,t,a){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(i,n.default.locals)?(i=n.default.locals,o(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){o()})),n.default.locals}}]);
//# sourceMappingURL=RulesTable.e13f580cb7e01093ea5a.js.map